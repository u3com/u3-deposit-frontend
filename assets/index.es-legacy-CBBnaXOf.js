!function(){function e(e,n,r,i){var o=t(E(1&i?e.prototype:e),n,r);return 2&i&&"function"==typeof o?function(e){return o.apply(r,e)}:o}function t(){return t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},t.apply(null,arguments)}function n(e){var t="function"==typeof Map?new Map:void 0;return n=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(b())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&I(i,n.prototype),i}(e,arguments,E(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),I(n,e)},n(e)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(_(e)+" is not iterable")}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return p(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,h={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,s=0,c=e,h.n=n,a}};function d(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],d=h.p,p=o[2];n>3?(i=p===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=d&&((i=n<2&&d<o[1])?(s=0,h.v=r,h.n=o[1]):d<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,h.n=p,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,p),s=l,c=p;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(h.n=-1),d(s,c)):h.n=c:h.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=h.n<0)?c:n.call(r,h))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(p(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,p(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,p(f,"constructor",u),p(u,"constructor",c),c.displayName="GeneratorFunction",p(u,i,"GeneratorFunction"),p(f),p(f,i,"Generator"),p(f,r,function(){return this}),p(f,"toString",function(){return"[object Generator]"}),(d=function(){return{w:o,m:h}})()}function p(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}p=function(e,t,n,r){function o(t,n){p(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},p(e,t,n,r)}function v(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function g(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){v(o,r,i,a,s,"next",e)}function s(e){v(o,r,i,a,s,"throw",e)}a(void 0)})}}function y(e,t,n){return t=E(t),m(e,b()?Reflect.construct(t,n||[],E(e).constructor):t.apply(e,n))}function m(e,t){if(t&&("object"==_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b=function(){return!!e})()}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function P(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function x(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}System.register(["./index-legacy-CXPEV-Pz.js","./events-legacy-CXQjzqCV.js","./index-legacy-_k0KS9GP.js"],function(t,o){"use strict";var f,h,p,v,b,E,I,O,x,A,T;return{setters:[function(e){f=e.Q,h=e.ab,p=e.a0,v=e.$},function(e){b=e.r},function(e){E=e.c,I=e.a,O=e.k,x=e.d,A=e.s,T=e.g}],execute:function(){t({A:wt,D:Kf,E:mt,F:Wf,G:Df,J:So,K:Le,L:je,M:jf,P:Io,Q:mo,R:qf,S:Gf,T:Zf,U:Uf,a:Ty,b:Ny,c:function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},d:function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");_y(e.outputLen),_y(e.blockLen)},e:Ay,f:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(jy&&"function"==typeof jy.getRandomValues)return jy.getRandomValues(new Uint8Array(e));if(jy&&"function"==typeof jy.randomBytes)return jy.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")},g:function(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];Ay(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r},i:Fa,j:Ka,m:jo,n:Ko,p:gt,r:function(e,t){return e<<32-t|e>>>t},s:ko,t:My,v:Lf,w:Hy,y:yt});var N=t("o",b()),R=t("N",f(N)),B={},C=function(e,t){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},C(e,t)};var U=function(){return U=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},U.apply(this,arguments)};function j(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function D(e){return this instanceof D?(this.v=e,this):new D(e)}var q,M=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return U},__asyncDelegator:function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:D(e[r](t)),done:"return"===r}:i?i(t):t}:i}},__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof D?Promise.resolve(e.value.v).then(c,u):l(o[0][2],e)}(i[e](t))}catch(rO){l(o[0][3],rO)}}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=j(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}},__await:D,__awaiter:function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(rO){o(rO)}}function s(e){try{c(r.throw(e))}catch(rO){o(rO)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},__createBinding:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},__decorate:function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},__exportStar:function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])},__extends:function(e,t){function n(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__generator:function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(rO){o=[6,rO],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__metadata:function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param:function(e,t){return function(n,r){t(n,r,e)}},__read:L,__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(L(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},__values:j},Symbol.toStringTag,{value:"Module"})),z=h(M),H={},V={};var F,K={},W={},G={};var Z,Y,J,Q,X={};function $(){return Y||(Y=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=z;t.__exportStar((F||(F=1,Object.defineProperty(G,"__esModule",{value:!0}),G.ONE_THOUSAND=G.ONE_HUNDRED=void 0,G.ONE_HUNDRED=100,G.ONE_THOUSAND=1e3),G),e),t.__exportStar((Z||(Z=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=5*e.ONE_MINUTE,e.TEN_MINUTES=10*e.ONE_MINUTE,e.THIRTY_MINUTES=30*e.ONE_MINUTE,e.SIXTY_MINUTES=60*e.ONE_MINUTE,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=3*e.ONE_HOUR,e.SIX_HOURS=6*e.ONE_HOUR,e.TWELVE_HOURS=12*e.ONE_HOUR,e.TWENTY_FOUR_HOURS=24*e.ONE_HOUR,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=3*e.ONE_DAY,e.FIVE_DAYS=5*e.ONE_DAY,e.SEVEN_DAYS=7*e.ONE_DAY,e.THIRTY_DAYS=30*e.ONE_DAY,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=2*e.ONE_WEEK,e.THREE_WEEKS=3*e.ONE_WEEK,e.FOUR_WEEKS=4*e.ONE_WEEK,e.ONE_YEAR=365*e.ONE_DAY}(X)),X),e)}(W)),W}function ee(){return Q||(Q=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=z;t.__exportStar((q||(q=1,Object.defineProperty(V,"__esModule",{value:!0}),V.delay=void 0,V.delay=function(e){return new Promise(function(t){setTimeout(function(){t(!0)},e)})}),V),e),t.__exportStar(function(){if(J)return K;J=1,Object.defineProperty(K,"__esModule",{value:!0}),K.fromMiliseconds=K.toMiliseconds=void 0;var e=$();return K.toMiliseconds=function(t){return t*e.ONE_THOUSAND},K.fromMiliseconds=function(t){return Math.floor(t/e.ONE_THOUSAND)},K}(),e)}(H)),H}var te,ne={};var re,ie,oe,ae={},se={};function ce(){return ie||(ie=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),z.__exportStar(function(){if(re)return se;re=1,Object.defineProperty(se,"__esModule",{value:!0}),se.IWatch=void 0;var e=P(function e(){S(this,e)});return se.IWatch=e,se}(),e)}(ae)),ae}var ue=t("k",(oe||(oe=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=z;t.__exportStar(ee(),e),t.__exportStar(function(){if(te)return ne;te=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.Watch=void 0;var e=function(){return P(function e(){S(this,e),this.timestamps=new Map},[{key:"start",value:function(e){if(this.timestamps.has(e))throw new Error("Watch already started for label: ".concat(e));this.timestamps.set(e,{started:Date.now()})}},{key:"stop",value:function(e){var t=this.get(e);if(void 0!==t.elapsed)throw new Error("Watch already stopped for label: ".concat(e));var n=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:n})}},{key:"get",value:function(e){var t=this.timestamps.get(e);if(void 0===t)throw new Error("No timestamp found for label: ".concat(e));return t}},{key:"elapsed",value:function(e){var t=this.get(e);return t.elapsed||Date.now()-t.started}}])}();return ne.Watch=e,ne.default=e,ne}(),e),t.__exportStar(ce(),e),t.__exportStar($(),e)}(B)),B)),le=P(function e(){S(this,e)});t("I",le);var fe=function(e){function t(e){return S(this,t),y(this,t)}return k(t,e),P(t)}(le),he=ue.FIVE_SECONDS,de=t("x",{pulse:"heartbeat_pulse"}),pe=function(e){function t(e){var n;return S(this,t),(n=y(this,t,[e])).events=new N.EventEmitter,n.interval=he,n.interval=(null==e?void 0:e.interval)||he,n}return k(t,e),P(t,[{key:"init",value:(i=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:return e.a(2)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"stop",value:function(){clearInterval(this.intervalRef)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"initialize",value:(r=g(d().m(function e(){var t=this;return d().w(function(e){for(;;)switch(e.n){case 0:this.intervalRef=setInterval(function(){return t.pulse()},ue.toMiliseconds(this.interval));case 1:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"pulse",value:function(){this.events.emit(de.pulse)}}],[{key:"init",value:(n=g(d().m(function e(n){var r;return d().w(function(e){for(;;)switch(e.n){case 0:return r=new t(n),e.n=1,r.init();case 1:return e.a(2,r)}},e)})),function(e){return n.apply(this,arguments)})}]);var n,r,i}(fe);t("q",pe);var ve=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,ge=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,ye=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function me(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"===_(t)&&"prototype"in t))return t;!function(e){console.warn('[destr] Dropping "'.concat(e,'" key to prevent prototype pollution.'))}(e)}function we(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);var n=e.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!ye.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(ve.test(e)||ge.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,me)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}function be(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(i=e.apply(void 0,n))&&"function"==typeof i.then?i:Promise.resolve(i)}catch(o){return Promise.reject(o)}var i}function Ee(e){if(function(e){var t=_(e);return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){var t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return Ee(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}var ke="base64:";function Ie(e){return"string"==typeof e?e:ke+function(e){if(globalThis.Buffer)return Buffer.from(e).toString("base64");return globalThis.btoa(String.fromCodePoint.apply(String,l(e)))}(e)}function Se(e){return"string"!=typeof e?e:e.startsWith(ke)?function(e){if(globalThis.Buffer)return Buffer.from(e,"base64");return Uint8Array.from(globalThis.atob(e),function(e){return e.codePointAt(0)})}(e.slice(7)):e}function Oe(e){var t;return e&&(null===(t=e.split("?")[0])||void 0===t?void 0:t.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function Pe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Oe(t.join(":"))}function xe(e){return(e=Oe(e))?e+":":""}function _e(e,t){if(void 0===t)return!0;for(var n=0,r=e.indexOf(":");r>-1;)n++,r=e.indexOf(":",r+1);return n<=t}function Ae(e,t){return t?e.startsWith(t)&&"$"!==e[e.length-1]:"$"!==e[e.length-1]}var Te=function(){var e=new Map;return{name:"memory",getInstance:function(){return e},hasItem:function(t){return e.has(t)},getItem:function(t){var n;return null!==(n=e.get(t))&&void 0!==n?n:null},getItemRaw:function(t){var n;return null!==(n=e.get(t))&&void 0!==n?n:null},setItem:function(t,n){e.set(t,n)},setItemRaw:function(t,n){e.set(t,n)},removeItem:function(t){e.delete(t)},getKeys:function(){return l(e.keys())},clear:function(){e.clear()},dispose:function(){e.clear()}}};function Ne(e,t,n){return e.watch?e.watch(function(e,r){return t(e,n+r)}):function(){}}function Re(e){return Be.apply(this,arguments)}function Be(){return(Be=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:if("function"!=typeof t.dispose){e.n=1;break}return e.n=1,be(t.dispose);case 1:return e.a(2)}},e)}))).apply(this,arguments)}var Ce=function(e){return JSON.stringify(e,function(e,t){return"bigint"==typeof t?t.toString()+"n":t})},Ue=function(e){var t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,function(e,t){return"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t})};function je(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type ".concat(_(e)));try{return Ue(e)}catch(t){return e}}function Le(e){return"string"==typeof e?e:Ce(e)||""}var De=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.base&&t.base.length>0?"".concat(t.base,":"):"",r=function(e){return n+e};return t.dbName&&t.storeName&&(e=E(t.dbName,t.storeName)),{name:"idb-keyval",options:t,hasItem:function(t){return g(d().m(function n(){var i,o;return d().w(function(n){for(;;)switch(n.n){case 0:return i=_,n.n=1,T(r(t),e);case 1:return o=i(n.v),n.a(2,!(o>"u"))}},n)}))()},getItem:function(t){return g(d().m(function n(){var i,o,a,s;return d().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,T(r(t),e);case 1:if(a=i=n.v,!(o=null!==a)){n.n=2;break}o=void 0!==i;case 2:if(!o){n.n=3;break}s=i,n.n=4;break;case 3:s=null;case 4:return n.a(2,s)}},n)}))()},setItem:function(t,n){return A(r(t),n,e)},removeItem:function(t){return x(r(t),e)},getKeys:function(){return O(e)},clear:function(){return I(e)}}},qe=function(){return P(function e(){S(this,e),this.indexedDb=function(){var e={mounts:{"":(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).driver||Te()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=function(t){var n,r=u(e.mountpoints);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.startsWith(i))return{base:i,relativeKey:t.slice(i.length),driver:e.mounts[i]}}}catch(o){r.e(o)}finally{r.f()}return{base:"",relativeKey:t,driver:e.mounts[""]}},n=function(t,n){return e.mountpoints.filter(function(e){return e.startsWith(t)||n&&t.startsWith(e)}).map(function(n){return{relativeBase:t.length>n.length?t.slice(n.length):void 0,mountpoint:n,driver:e.mounts[n]}})},r=function(t,n){if(e.watching){n=Oe(n);var r,i=u(e.watchListeners);try{for(i.s();!(r=i.n()).done;)(0,r.value)(t,n)}catch(o){i.e(o)}finally{i.f()}}},o=function(){var t=g(d().m(function t(){var n,i,o;return d().w(function(t){for(;;)switch(t.n){case 0:if(!e.watching){t.n=1;break}return t.a(2);case 1:e.watching=!0,i=c(e.mounts);case 2:if((o=i()).done){t.n=4;break}return n=o.value,t.n=3,Ne(e.mounts[n],r,n);case 3:e.unwatch[n]=t.v,t.n=2;break;case 4:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),s=function(){var t=g(d().m(function t(){var n,r,i;return d().w(function(t){for(;;)switch(t.n){case 0:if(e.watching){t.n=1;break}return t.a(2);case 1:r=c(e.unwatch);case 2:if((i=r()).done){t.n=4;break}return n=i.value,t.n=3,e.unwatch[n]();case 3:t.n=2;break;case 4:e.unwatch={},e.watching=!1;case 5:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),f=function(e,n,r){var i,o=new Map,s=function(e){var t=o.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},o.set(e.base,t)),t},c=u(e);try{for(c.s();!(i=c.n()).done;){var f=i.value,h="string"==typeof f,d=Oe(h?f:f.key),p=h?void 0:f.value,v=h||!f.options?n:a(a({},n),f.options),g=t(d);s(g).items.push({key:d,value:p,relativeKey:g.relativeKey,options:v})}}catch(y){c.e(y)}finally{c.f()}return Promise.all(l(o.values()).map(function(e){return r(e)})).then(function(e){return e.flat()})},h={hasItem:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Oe(e);var r=t(e),i=r.relativeKey;return be(r.driver.hasItem,i,n)},getItem:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Oe(e);var r=t(e),i=r.relativeKey;return be(r.driver.getItem,i,n).then(function(e){return we(e)})},getItems:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f(e,t,function(e){return e.driver.getItems?be(e.driver.getItems,e.items.map(function(e){return{key:e.relativeKey,options:e.options}}),t).then(function(t){return t.map(function(t){return{key:Pe(e.base,t.key),value:we(t.value)}})}):Promise.all(e.items.map(function(t){return be(e.driver.getItem,t.relativeKey,t.options).then(function(e){return{key:t.key,value:we(e)}})}))})},getItemRaw:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Oe(e);var r=t(e),i=r.relativeKey,o=r.driver;return o.getItemRaw?be(o.getItemRaw,i,n):be(o.getItem,i,n).then(function(e){return Se(e)})},setItem:function(e,n){var i=arguments;return g(d().m(function o(){var a,s,c,u;return d().w(function(o){for(;;)switch(o.n){case 0:if(a=i.length>2&&void 0!==i[2]?i[2]:{},void 0!==n){o.n=1;break}return o.a(2,h.removeItem(e));case 1:if(e=Oe(e),s=t(e),c=s.relativeKey,(u=s.driver).setItem){o.n=2;break}return o.a(2);case 2:return o.n=3,be(u.setItem,c,Ee(n),a);case 3:u.watch||r("update",e);case 4:return o.a(2)}},o)}))()},setItems:function(e,t){return g(d().m(function n(){return d().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,f(e,t,function(){var e=g(d().m(function e(n){return d().w(function(e){for(;;)switch(e.n){case 0:if(!n.driver.setItems){e.n=1;break}return e.a(2,be(n.driver.setItems,n.items.map(function(e){return{key:e.relativeKey,value:Ee(e.value),options:e.options}}),t));case 1:if(n.driver.setItem){e.n=2;break}return e.a(2);case 2:return e.n=3,Promise.all(n.items.map(function(e){return be(n.driver.setItem,e.relativeKey,Ee(e.value),e.options)}));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return n.a(2)}},n)}))()},setItemRaw:function(e,n){var i=arguments;return g(d().m(function o(){var a,s,c,u;return d().w(function(o){for(;;)switch(o.n){case 0:if(a=i.length>2&&void 0!==i[2]?i[2]:{},void 0!==n){o.n=1;break}return o.a(2,h.removeItem(e,a));case 1:if(e=Oe(e),s=t(e),c=s.relativeKey,!(u=s.driver).setItemRaw){o.n=3;break}return o.n=2,be(u.setItemRaw,c,n,a);case 2:o.n=6;break;case 3:if(!u.setItem){o.n=5;break}return o.n=4,be(u.setItem,c,Ie(n),a);case 4:o.n=6;break;case 5:return o.a(2);case 6:u.watch||r("update",e);case 7:return o.a(2)}},o)}))()},removeItem:function(e){var n=arguments;return g(d().m(function i(){var o,a,s,c;return d().w(function(i){for(;;)switch(i.n){case 0:if("boolean"==typeof(o=n.length>1&&void 0!==n[1]?n[1]:{})&&(o={removeMeta:o}),e=Oe(e),a=t(e),s=a.relativeKey,(c=a.driver).removeItem){i.n=1;break}return i.a(2);case 1:return i.n=2,be(c.removeItem,s,o);case 2:if(!o.removeMeta&&!o.removeMata){i.n=3;break}return i.n=3,be(c.removeItem,s+"$",o);case 3:c.watch||r("remove",e);case 4:return i.a(2)}},i)}))()},getMeta:function(e){var n=arguments;return g(d().m(function r(){var i,o,a,s,c,u,l,f;return d().w(function(r){for(;;)switch(r.n){case 0:if("boolean"==typeof(i=n.length>1&&void 0!==n[1]?n[1]:{})&&(i={nativeOnly:i}),e=Oe(e),o=t(e),a=o.relativeKey,s=o.driver,c=Object.create(null),!s.getMeta){r.n=2;break}return l=Object,f=c,r.n=1,be(s.getMeta,a,i);case 1:l.assign.call(l,f,r.v);case 2:if(i.nativeOnly){r.n=4;break}return r.n=3,be(s.getItem,a+"$",i).then(function(e){return we(e)});case 3:(u=r.v)&&"object"===_(u)&&("string"==typeof u.atime&&(u.atime=new Date(u.atime)),"string"==typeof u.mtime&&(u.mtime=new Date(u.mtime)),Object.assign(c,u));case 4:return r.a(2,c)}},r)}))()},setMeta:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setItem(e+"$",t,n)},removeMeta:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removeItem(e+"$",t)},getKeys:function(e){var t=arguments;return g(d().m(function r(){var o,a,s,c,f,h,p,v,g,y;return d().w(function(r){for(;;)switch(r.p=r.n){case 0:o=t.length>1&&void 0!==t[1]?t[1]:{},e=xe(e),a=n(e,!0),s=[],c=[],f=!0,h=u(a),r.p=1,v=d().m(function e(){var t,n,r,a,h,v,g;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=p.value,null!==(t=n.driver.flags)&&void 0!==t&&t.maxDepth||(f=!1),e.n=1,be(n.driver.getKeys,n.relativeBase,o);case 1:r=e.v,a=u(r),e.p=2,v=d().m(function e(){var t,r;return d().w(function(e){for(;;)switch(e.n){case 0:t=h.value,r=n.mountpoint+Oe(t),s.some(function(e){return r.startsWith(e)})||c.push(r);case 1:return e.a(2)}},e)}),a.s();case 3:if((h=a.n()).done){e.n=5;break}return e.d(i(v()),4);case 4:e.n=3;break;case 5:e.n=7;break;case 6:e.p=6,g=e.v,a.e(g);case 7:return e.p=7,a.f(),e.f(7);case 8:s=[n.mountpoint].concat(l(s.filter(function(e){return!e.startsWith(n.mountpoint)})));case 9:return e.a(2)}},e,null,[[2,6,7,8]])}),h.s();case 2:if((p=h.n()).done){r.n=4;break}return r.d(i(v()),3);case 3:r.n=2;break;case 4:r.n=6;break;case 5:r.p=5,y=r.v,h.e(y);case 6:return r.p=6,h.f(),r.f(6);case 7:return g=void 0!==o.maxDepth&&!f,r.a(2,c.filter(function(t){return(!g||_e(t,o.maxDepth))&&Ae(t,e)}))}},r,null,[[1,5,6,7]])}))()},clear:function(e){var t=arguments;return g(d().m(function r(){var i;return d().w(function(r){for(;;)switch(r.n){case 0:return i=t.length>1&&void 0!==t[1]?t[1]:{},e=xe(e),r.n=1,Promise.all(n(e,!1).map(function(){var e=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:if(!t.driver.clear){e.n=1;break}return e.a(2,be(t.driver.clear,t.relativeBase,i));case 1:if(!t.driver.removeItem){e.n=3;break}return e.n=2,t.driver.getKeys(t.relativeBase||"",i);case 2:return n=e.v,e.a(2,Promise.all(n.map(function(e){return t.driver.removeItem(e,i)})));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:return r.a(2)}},r)}))()},dispose:function(){return g(d().m(function t(){return d().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Promise.all(Object.values(e.mounts).map(function(e){return Re(e)}));case 1:return t.a(2)}},t)}))()},watch:function(t){return g(d().m(function n(){return d().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,o();case 1:return e.watchListeners.push(t),n.a(2,g(d().m(function n(){return d().w(function(n){for(;;)switch(n.n){case 0:if(e.watchListeners=e.watchListeners.filter(function(e){return e!==t}),0!==e.watchListeners.length){n.n=1;break}return n.n=1,s();case 1:return n.a(2)}},n)})))}},n)}))()},unwatch:function(){return g(d().m(function t(){return d().w(function(t){for(;;)switch(t.n){case 0:return e.watchListeners=[],t.n=1,s();case 1:return t.a(2)}},t)}))()},mount:function(t,n){if((t=xe(t))&&e.mounts[t])throw new Error("already mounted at ".concat(t));return t&&(e.mountpoints.push(t),e.mountpoints.sort(function(e,t){return t.length-e.length})),e.mounts[t]=n,e.watching&&Promise.resolve(Ne(n,r,t)).then(function(n){e.unwatch[t]=n}).catch(console.error),h},unmount:function(t){var n=arguments;return g(d().m(function r(){var i,o,a;return d().w(function(r){for(;;)switch(r.n){case 0:if(i=!(n.length>1&&void 0!==n[1])||n[1],(t=xe(t))&&e.mounts[t]){r.n=1;break}return r.a(2);case 1:if(e.watching&&t in e.unwatch&&(null===(o=(a=e.unwatch)[t])||void 0===o||o.call(a),delete e.unwatch[t]),!i){r.n=2;break}return r.n=2,Re(e.mounts[t]);case 2:e.mountpoints=e.mountpoints.filter(function(e){return e!==t}),delete e.mounts[t];case 3:return r.a(2)}},r)}))()},getMount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e=Oe(e)+":";var n=t(e);return{driver:n.driver,base:n.base}},getMounts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=Oe(e),n(e,t.parents).map(function(e){return{driver:e.driver,base:e.mountpoint}})},keys:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.getKeys(e,t)},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.getItem(e,t)},set:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return h.setItem(e,t,n)},has:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.hasItem(e,t)},del:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.removeItem(e,t)},remove:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.removeItem(e,t)}};return h}({driver:De({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})},[{key:"getKeys",value:(o=g(d().m(function e(){return d().w(function(e){for(;;)if(0===e.n)return e.a(2,this.indexedDb.getKeys())},e,this)})),function(){return o.apply(this,arguments)})},{key:"getEntries",value:(r=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:return t=this.indexedDb,e.n=1,this.indexedDb.getKeys();case 1:return e.n=2,t.getItems.call(t,e.v);case 2:return e.a(2,e.v.map(function(e){return[e.key,e.value]}))}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getItem",value:(n=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.indexedDb.getItem(t);case 1:if(null===(n=e.v)){e.n=2;break}return e.a(2,n);case 2:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"setItem",value:(t=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.indexedDb.setItem(t,Le(n));case 1:return e.a(2)}},e,this)})),function(e,n){return t.apply(this,arguments)})},{key:"removeItem",value:(e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.indexedDb.removeItem(t);case 1:return e.a(2)}},e,this)})),function(t){return e.apply(this,arguments)})}]);var e,t,n,r,o}(),Me=("undefined"==typeof globalThis?"undefined":_(globalThis))<"u"?globalThis:("undefined"==typeof window?"undefined":_(window))<"u"?window:("undefined"==typeof global?"undefined":_(global))<"u"?global:("undefined"==typeof self?"undefined":_(self))<"u"?self:{},ze={exports:{}};function He(e){var t;return[e[0],je(null!=(t=e[1])?t:"")]}!function(){var e;function t(){}(e=t).prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){var e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),_(Me)<"u"&&Me.localStorage?ze.exports=Me.localStorage:("undefined"==typeof window?"undefined":_(window))<"u"&&window.localStorage?ze.exports=window.localStorage:ze.exports=new t}();var Ve,Fe,Ke,We,Ge=function(){return P(function e(){S(this,e),this.localStorage=ze.exports},[{key:"getKeys",value:(i=g(d().m(function e(){return d().w(function(e){for(;;)if(0===e.n)return e.a(2,Object.keys(this.localStorage))},e,this)})),function(){return i.apply(this,arguments)})},{key:"getEntries",value:(r=g(d().m(function e(){return d().w(function(e){for(;;)if(0===e.n)return e.a(2,Object.entries(this.localStorage).map(He))},e,this)})),function(){return r.apply(this,arguments)})},{key:"getItem",value:(n=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:if(null===(n=this.localStorage.getItem(t))){e.n=1;break}return e.a(2,je(n));case 1:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"setItem",value:(t=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:this.localStorage.setItem(t,Le(n));case 1:return e.a(2)}},e,this)})),function(e,n){return t.apply(this,arguments)})},{key:"removeItem",value:(e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:this.localStorage.removeItem(t);case 1:return e.a(2)}},e,this)})),function(t){return e.apply(this,arguments)})}]);var e,t,n,r,i}(),Ze=function(){var e=g(d().m(function e(t,n,r){var i,o,a,s,c,u,l;return d().w(function(e){for(;;)switch(e.n){case 0:return i="wc_storage_version",e.n=1,n.getItem(i);case 1:if(!((o=e.v)&&o>=1)){e.n=2;break}return r(n),e.a(2);case 2:return e.n=3,t.getKeys();case 3:if((a=e.v).length){e.n=4;break}return r(n),e.a(2);case 4:s=[];case 5:if(!a.length){e.n=10;break}if(c=a.shift()){e.n=6;break}return e.a(3,9);case 6:if(!((u=c.toLowerCase()).includes("wc@")||u.includes("walletconnect")||u.includes("wc_")||u.includes("wallet_connect"))){e.n=9;break}return e.n=7,t.getItem(c);case 7:return l=e.v,e.n=8,n.setItem(c,l);case 8:s.push(c);case 9:e.n=5;break;case 10:return e.n=11,n.setItem(i,1);case 11:r(n),Ye(t,s);case 12:return e.a(2)}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),Ye=function(){var e=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:n.length&&n.forEach(function(){var e=g(d().m(function e(n){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.removeItem(n);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Je=function(){return P(function e(){var t=this;S(this,e),this.initialized=!1,this.setInitialized=function(e){t.storage=e,t.initialized=!0};var n=new Ge;this.storage=n;try{var r=new qe;Ze(n,r,this.setInitialized)}catch(i){this.initialized=!0}},[{key:"getKeys",value:(o=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:return e.a(2,this.storage.getKeys())}},e,this)})),function(){return o.apply(this,arguments)})},{key:"getEntries",value:(i=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:return e.a(2,this.storage.getEntries())}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getItem",value:(r=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:return e.a(2,this.storage.getItem(t))}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"setItem",value:(n=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:return e.a(2,this.storage.setItem(t,n))}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"removeItem",value:(t=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:return e.a(2,this.storage.removeItem(t))}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"initialize",value:(e=g(d().m(function e(){var t=this;return d().w(function(e){for(;;)switch(e.n){case 0:if(this.initialized){e.n=1;break}return e.n=1,new Promise(function(e){var n=setInterval(function(){t.initialized&&(clearInterval(n),e())},20)});case 1:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})}]);var e,t,n,r,i,o}();t("u",Je);var Qe=function(){if(We)return Ke;We=1;var e=function(){if(Fe)return Ve;function e(e){try{return JSON.stringify(e)}catch(rO){return'"[Circular]"'}}return Fe=1,Ve=function(t,n,r){var i=r&&r.stringify||e;if("object"===_(t)&&null!==t){var o=n.length+1;if(1===o)return t;var a=new Array(o);a[0]=i(t);for(var s=1;s<o;s++)a[s]=i(n[s]);return a.join(" ")}if("string"!=typeof t)return t;var c=n.length;if(0===c)return t;for(var u="",l=0,f=-1,h=t&&t.length||0,d=0;d<h;){if(37===t.charCodeAt(d)&&d+1<h){switch(f=f>-1?f:0,t.charCodeAt(d+1)){case 100:case 102:if(l>=c)break;if(null==n[l])break;f<d&&(u+=t.slice(f,d)),u+=Number(n[l]),f=d+2,d++;break;case 105:if(l>=c)break;if(null==n[l])break;f<d&&(u+=t.slice(f,d)),u+=Math.floor(Number(n[l])),f=d+2,d++;break;case 79:case 111:case 106:if(l>=c)break;if(void 0===n[l])break;f<d&&(u+=t.slice(f,d));var p=_(n[l]);if("string"===p){u+="'"+n[l]+"'",f=d+2,d++;break}if("function"===p){u+=n[l].name||"<anonymous>",f=d+2,d++;break}u+=i(n[l]),f=d+2,d++;break;case 115:if(l>=c)break;f<d&&(u+=t.slice(f,d)),u+=String(n[l]),f=d+2,d++;break;case 37:f<d&&(u+=t.slice(f,d)),u+="%",f=d+2,d++,l--}++l}++d}return-1===f?t:(f<h&&(u+=t.slice(f)),u)},Ve}();Ke=r;var t=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(rO){return e(self)||e(window)||e(this)||{}}}().console||{},n={mapHttpRequest:u,mapHttpResponse:u,wrapRequestSerializer:l,wrapResponseSerializer:l,wrapErrorSerializer:l,req:u,res:u,err:function(e){var t={type:e.constructor.name,msg:e.message,stack:e.stack};for(var n in e)void 0===t[n]&&(t[n]=e[n]);return t}};function r(e){(e=e||{}).browser=e.browser||{};var n=e.browser.transmit;if(n&&"function"!=typeof n.send)throw Error("pino: transmit option must have a send function");var u=e.browser.write||t;e.browser.write&&(e.browser.asObject=!0);var l=e.serializers||{},h=function(e,t){if(Array.isArray(e)){var n=e.filter(function(e){return"!stdSerializers.err"!==e});return n}return!0===e&&Object.keys(t)}(e.browser.serialize,l),d=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(d=!1);"function"==typeof u&&(u.error=u.fatal=u.warn=u.info=u.debug=u.trace=u),!1===e.enabled&&(e.level="silent");var p=e.level||"info",v=Object.create(u);v.log||(v.log=f),Object.defineProperty(v,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(v,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,i(g,v,"error","log"),i(g,v,"fatal","error"),i(g,v,"warn","error"),i(g,v,"info","log"),i(g,v,"debug","log"),i(g,v,"trace","log")}});var g={transmit:n,serialize:h,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:c(e)};return v.levels=r.levels,v.level=p,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=f,v.serializers=l,v._serialize=h,v._stdErrSerialize=d,v.child=function(t,r){if(!t)throw new Error("missing bindings for child Pino");r=r||{},h&&t.serializers&&(r.serializers=t.serializers);var i=r.serializers;if(h&&i){var c=Object.assign({},l,i),u=!0===e.browser.serialize?Object.keys(c):h;delete t.serializers,o([t],u,c,this._stdErrSerialize)}function f(e){this._childLevel=1+(0|e._childLevel),this.error=a(e,t,"error"),this.fatal=a(e,t,"fatal"),this.warn=a(e,t,"warn"),this.info=a(e,t,"info"),this.debug=a(e,t,"debug"),this.trace=a(e,t,"trace"),c&&(this.serializers=c,this._serialize=u),n&&(this._logEvent=s([].concat(e._logEvent.bindings,t)))}return f.prototype=this,new f(this)},n&&(v._logEvent=s()),v}function i(n,i,a,c){var u=Object.getPrototypeOf(i);i[a]=i.levelVal>i.levels.values[a]?f:u[a]?u[a]:t[a]||t[c]||f,function(n,i,a){if(!n.transmit&&i[a]===f)return;i[a]=(c=i[a],function(){for(var u=n.timestamp(),l=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this,h=0;h<l.length;h++)l[h]=arguments[h];if(n.serialize&&!n.asObject&&o(l,this._serialize,this.serializers,this._stdErrSerialize),n.asObject?c.call(f,function(t,n,i,a){t._serialize&&o(i,t._serialize,t.serializers,t._stdErrSerialize);var s=i.slice(),c=s[0],u={};a&&(u.time=a),u.level=r.levels.values[n];var l=1+(0|t._childLevel);if(l<1&&(l=1),null!==c&&"object"===_(c)){for(;l--&&"object"===_(s[0]);)Object.assign(u,s.shift());c=s.length?e(s.shift(),s):void 0}else"string"==typeof c&&(c=e(s.shift(),s));return void 0!==c&&(u.msg=c),u}(this,a,l,u)):c.apply(f,l),n.transmit){var d=n.transmit.level||i.level,p=r.levels.values[d],v=r.levels.values[a];if(v<p)return;!function(e,t,n){var r=t.send,i=t.ts,a=t.methodLevel,c=t.methodValue,u=t.val,l=e._logEvent.bindings;o(n,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=n.filter(function(e){return-1===l.indexOf(e)}),e._logEvent.level.label=a,e._logEvent.level.value=c,r(a,e._logEvent,u),e._logEvent=s(l)}(this,{ts:u,methodLevel:a,methodValue:v,transmitValue:r.levels.values[n.transmit.level||i.level],send:n.transmit.send,val:i.levelVal},l)}});var c}(n,i,a)}function o(e,t,n,i){for(var o in e)if(i&&e[o]instanceof Error)e[o]=r.stdSerializers.err(e[o]);else if("object"===_(e[o])&&!Array.isArray(e[o]))for(var a in e[o])t&&t.indexOf(a)>-1&&a in n&&(e[o][a]=n[a](e[o][a]))}function a(e,t,n){return function(){var r=new Array(1+arguments.length);r[0]=t;for(var i=1;i<r.length;i++)r[i]=arguments[i-1];return e[n].apply(this,r)}}function s(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function c(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?h:d}function u(){return{}}function l(e){return e}function f(){}function h(){return!1}function d(){return Date.now()}return r.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},r.stdSerializers=n,r.stdTimeFunctions=Object.assign({},{nullTime:h,epochTime:d,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),Ke}(),Xe=t("O",f(Qe)),$e={level:"info"},et="custom_context",tt=1024e3,nt=function(){return P(function e(t){S(this,e),this.nodeValue=t,this.sizeInBytes=(new TextEncoder).encode(this.nodeValue).length,this.next=null},[{key:"value",get:function(){return this.nodeValue}},{key:"size",get:function(){return this.sizeInBytes}}])}(),rt=function(){return P(function e(t){S(this,e),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0},[{key:"append",value:function(e){var t=new nt(e);if(t.size>this.maxSizeInBytes)throw new Error("[LinkedList] Value too big to insert into list: ".concat(e," with size ").concat(t.size));for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}},{key:"shift",value:function(){if(this.head){var e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}}},{key:"toArray",value:function(){for(var e=[],t=this.head;null!==t;)e.push(t.value),t=t.next;return e}},{key:"length",get:function(){return this.lengthInNodes}},{key:"size",get:function(){return this.sizeInBytes}},{key:"toOrderedArray",value:function(){return Array.from(this)}},{key:Symbol.iterator,value:function(){var e=this.head;return{next:function(){if(!e)return{done:!0,value:null};var t=e.value;return e=e.next,{done:!1,value:t}}}}}])}(),it=function(){return P(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt;S(this,e),this.level=null!=t?t:"error",this.levelValue=Qe.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new rt(this.MAX_LOG_SIZE_IN_BYTES)},[{key:"forwardToConsole",value:function(e,t){t===Qe.levels.values.error?console.error(e):t===Qe.levels.values.warn?console.warn(e):t===Qe.levels.values.debug?console.debug(e):t===Qe.levels.values.trace?console.trace(e):console.log(e)}},{key:"appendToLogs",value:function(e){this.logs.append(Le({timestamp:(new Date).toISOString(),log:e}));var t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}},{key:"getLogs",value:function(){return this.logs}},{key:"clearLogs",value:function(){this.logs=new rt(this.MAX_LOG_SIZE_IN_BYTES)}},{key:"getLogArray",value:function(){return Array.from(this.logs)}},{key:"logsToBlob",value:function(e){var t=this.getLogArray();return t.push(Le({extraMetadata:e})),new Blob(t,{type:"application/json"})}}])}(),ot=function(){return P(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt;S(this,e),this.baseChunkLogger=new it(t,n)},[{key:"write",value:function(e){this.baseChunkLogger.appendToLogs(e)}},{key:"getLogs",value:function(){return this.baseChunkLogger.getLogs()}},{key:"clearLogs",value:function(){this.baseChunkLogger.clearLogs()}},{key:"getLogArray",value:function(){return this.baseChunkLogger.getLogArray()}},{key:"logsToBlob",value:function(e){return this.baseChunkLogger.logsToBlob(e)}},{key:"downloadLogsBlobInBrowser",value:function(e){var t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download="walletconnect-logs-".concat((new Date).toISOString(),".txt"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}}])}(),at=function(){return P(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt;S(this,e),this.baseChunkLogger=new it(t,n)},[{key:"write",value:function(e){this.baseChunkLogger.appendToLogs(e)}},{key:"getLogs",value:function(){return this.baseChunkLogger.getLogs()}},{key:"clearLogs",value:function(){this.baseChunkLogger.clearLogs()}},{key:"getLogArray",value:function(){return this.baseChunkLogger.getLogArray()}},{key:"logsToBlob",value:function(e){return this.baseChunkLogger.logsToBlob(e)}}])}(),st=Object.defineProperty,ct=Object.defineProperties,ut=Object.getOwnPropertyDescriptors,lt=Object.getOwnPropertySymbols,ft=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable,dt=function(e,t,n){return t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},pt=function(e,t){for(var n in t||(t={}))ft.call(t,n)&&dt(e,n,t[n]);if(lt){var r,i=u(lt(t));try{for(i.s();!(r=i.n()).done;){n=r.value;ht.call(t,n)&&dt(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},vt=function(e,t){return ct(e,ut(t))};function gt(e){return vt(pt({},e),{level:(null==e?void 0:e.level)||$e.level})}function yt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:et,n="";return n=_(e.bindings)>"u"?function(e){return e[arguments.length>1&&void 0!==arguments[1]?arguments[1]:et]||""}(e,t):e.bindings().context||"",n}function mt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:et,r=function(e,t){var n=yt(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:et);return n.trim()?"".concat(n,"/").concat(t):t}(e,t,n);return function(e,t){return e[arguments.length>2&&void 0!==arguments[2]?arguments[2]:et]=t,e}(e.child({context:r}),r,n)}function wt(e){return _(e.loggerOverride)<"u"&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:("undefined"==typeof window?"undefined":_(window))<"u"?function(e){var t,n,r=new ot(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:Xe(vt(pt({},e.opts),{level:"trace",browser:vt(pt({},null==(n=e.opts)?void 0:n.browser),{write:function(e){return r.write(e)}})})),chunkLoggerController:r}}(e):function(e){var t,n=new at(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:Xe(vt(pt({},e.opts),{level:"trace"}),n),chunkLoggerController:n}}(e)}var bt=Object.defineProperty,Et=function(e,t,n){return function(e,t,n){return t in e?bt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},kt=function(e){function t(e){var n;return S(this,t),(n=y(this,t)).opts=e,Et(w(n),"protocol","wc"),Et(w(n),"version",2),n}return k(t,e),P(t)}(le),It=Object.defineProperty,St=function(e,t,n){return function(e,t,n){return t in e?It(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,t+"",n)},Ot=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t)).core=e,r.logger=n,St(w(r),"records",new Map),r}return k(t,e),P(t)}(le),Pt=P(function e(t,n){S(this,e),this.logger=t,this.core=n}),xt=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t)).relayer=e,r.logger=n,r}return k(t,e),P(t)}(le),_t=function(e){function t(e){return S(this,t),y(this,t)}return k(t,e),P(t)}(le),At=P(function e(t,n,r,i){S(this,e),this.core=t,this.logger=n,this.name=r}),Tt=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t)).relayer=e,r.logger=n,r}return k(t,e),P(t)}(le),Nt=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t)).core=e,r.logger=n,r}return k(t,e),P(t)}(le),Rt=P(function e(t,n,r){S(this,e),this.core=t,this.logger=n,this.store=r}),Bt=P(function e(t,n){S(this,e),this.projectId=t,this.logger=n}),Ct=P(function e(t,n,r){S(this,e),this.core=t,this.logger=n,this.telemetryEnabled=r}),Ut=Object.defineProperty,jt=function(e,t,n){return function(e,t,n){return t in e?Ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},Lt=P(function e(t){S(this,e),this.opts=t,jt(this,"protocol","wc"),jt(this,"version",2)}),Dt=P(function e(t){S(this,e),this.client=t});function qt(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function Mt(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}var zt="object"==("undefined"==typeof globalThis?"undefined":_(globalThis))&&"crypto"in globalThis?globalThis.crypto:void 0,Vt=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ft(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+_(e));return new Uint8Array((new TextEncoder).encode(e))}(e)),qt(e),e}var Kt=function(){return P(function e(){S(this,e)},[{key:"clone",value:function(){return this._cloneInto()}}])}();function Wt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(zt&&"function"==typeof zt.getRandomValues)return zt.getRandomValues(new Uint8Array(e));if(zt&&"function"==typeof zt.randomBytes)return zt.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}var Gt=function(e){function t(e,n,r,i){var o;return S(this,t),(o=y(this,t)).blockLen=e,o.outputLen=n,o.padOffset=r,o.isLE=i,o.finished=!1,o.length=0,o.pos=0,o.destroyed=!1,o.buffer=new Uint8Array(e),o.view=Vt(o.buffer),o}return k(t,e),P(t,[{key:"update",value:function(e){Mt(this);for(var t=this.view,n=this.buffer,r=this.blockLen,i=(e=Ft(e)).length,o=0;o<i;){var a=Math.min(r-this.pos,i-o);if(a!==r)n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===r&&(this.process(t,0),this.pos=0);else for(var s=Vt(e);r<=i-o;o+=r)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){Mt(this),function(e,t){qt(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;var t=this.buffer,n=this.view,r=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(var a=o;a<r;a++)t[a]=0;(function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),s=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+u,s,r)})(n,r-8,BigInt(8*this.length),i),this.process(n,0);var s=Vt(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(var f=0;f<u;f++)s.setUint32(4*f,l[f],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var n=e.slice(0,t);return this.destroy(),n}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,l(this.get()));var n=this.blockLen,r=this.buffer,i=this.length,o=this.finished,a=this.destroyed,s=this.pos;return e.length=i,e.pos=s,e.finished=o,e.destroyed=a,i%n&&e.buffer.set(r),e}}])}(Kt),Zt=BigInt(Math.pow(2,32)-1),Yt=BigInt(32);function Jt(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&Zt),l:Number(e>>Yt&Zt)}:{h:0|Number(e>>Yt&Zt),l:0|Number(e&Zt)}}var Qt={fromBig:Jt,split:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length),i=0;i<e.length;i++){var o=Jt(e[i],t),a=[o.h,o.l];n[i]=a[0],r[i]=a[1]}return[n,r]},toBig:function(e,t){return BigInt(e>>>0)<<Yt|BigInt(t>>>0)},shrSH:function(e,t,n){return e>>>n},shrSL:function(e,t,n){return e<<32-n|t>>>n},rotrSH:function(e,t,n){return e>>>n|t<<32-n},rotrSL:function(e,t,n){return e<<32-n|t>>>n},rotrBH:function(e,t,n){return e<<64-n|t>>>n-32},rotrBL:function(e,t,n){return e>>>n-32|t<<64-n},rotr32H:function(e,t){return t},rotr32L:function(e,t){return e},rotlSH:function(e,t,n){return e<<n|t>>>32-n},rotlSL:function(e,t,n){return t<<n|e>>>32-n},rotlBH:function(e,t,n){return t<<n-32|e>>>64-n},rotlBL:function(e,t,n){return e<<n-32|t>>>64-n},add:function(e,t,n,r){var i=(t>>>0)+(r>>>0);return{h:e+n+(i/Math.pow(2,32)|0)|0,l:0|i}},add3L:function(e,t,n){return(e>>>0)+(t>>>0)+(n>>>0)},add3H:function(e,t,n,r){return t+n+r+(e/Math.pow(2,32)|0)|0},add4L:function(e,t,n,r){return(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)},add4H:function(e,t,n,r,i){return t+n+r+i+(e/Math.pow(2,32)|0)|0},add5H:function(e,t,n,r,i,o){return t+n+r+i+o+(e/Math.pow(2,32)|0)|0},add5L:function(e,t,n,r,i){return(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0)}},Xt=Qt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(function(e){return BigInt(e)})),$t=r(Xt,2),en=$t[0],tn=$t[1],nn=new Uint32Array(80),rn=new Uint32Array(80),on=function(e){function t(){var e;return S(this,t),(e=y(this,t,[128,64,16,!1])).Ah=1779033703,e.Al=-205731576,e.Bh=-1150833019,e.Bl=-2067093701,e.Ch=1013904242,e.Cl=-23791573,e.Dh=-1521486534,e.Dl=1595750129,e.Eh=1359893119,e.El=-1377402159,e.Fh=-1694144372,e.Fl=725511199,e.Gh=528734635,e.Gl=-79577749,e.Hh=1541459225,e.Hl=327033209,e}return k(t,e),P(t,[{key:"get",value:function(){return[this.Ah,this.Al,this.Bh,this.Bl,this.Ch,this.Cl,this.Dh,this.Dl,this.Eh,this.El,this.Fh,this.Fl,this.Gh,this.Gl,this.Hh,this.Hl]}},{key:"set",value:function(e,t,n,r,i,o,a,s,c,u,l,f,h,d,p,v){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|a,this.Dl=0|s,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|f,this.Gh=0|h,this.Gl=0|d,this.Hh=0|p,this.Hl=0|v}},{key:"process",value:function(e,t){for(var n,r,i,o,a,s,c,u,l=0;l<16;l++,t+=4)nn[l]=e.getUint32(t),rn[l]=e.getUint32(t+=4);for(var f=16;f<80;f++){var h=0|nn[f-15],d=0|rn[f-15],p=Qt.rotrSH(h,d,1)^Qt.rotrSH(h,d,8)^Qt.shrSH(h,d,7),v=Qt.rotrSL(h,d,1)^Qt.rotrSL(h,d,8)^Qt.shrSL(h,d,7),g=0|nn[f-2],y=0|rn[f-2],m=Qt.rotrSH(g,y,19)^Qt.rotrBH(g,y,61)^Qt.shrSH(g,y,6),w=Qt.rotrSL(g,y,19)^Qt.rotrBL(g,y,61)^Qt.shrSL(g,y,6),b=Qt.add4L(v,w,rn[f-7],rn[f-16]),E=Qt.add4H(b,p,m,nn[f-7],nn[f-16]);nn[f]=0|E,rn[f]=0|b}for(var k=this.Ah,I=this.Al,S=this.Bh,O=this.Bl,P=this.Ch,x=this.Cl,_=this.Dh,A=this.Dl,T=this.Eh,N=this.El,R=this.Fh,B=this.Fl,C=this.Gh,U=this.Gl,j=this.Hh,L=this.Hl,D=0;D<80;D++){var q,M=Qt.rotrSH(T,N,14)^Qt.rotrSH(T,N,18)^Qt.rotrBH(T,N,41),z=Qt.rotrSL(T,N,14)^Qt.rotrSL(T,N,18)^Qt.rotrBL(T,N,41),H=T&R^~T&C,V=N&B^~N&U,F=Qt.add5L(L,z,V,tn[D],rn[D]),K=Qt.add5H(F,j,M,H,en[D],nn[D]),W=0|F,G=Qt.rotrSH(k,I,28)^Qt.rotrBH(k,I,34)^Qt.rotrBH(k,I,39),Z=Qt.rotrSL(k,I,28)^Qt.rotrBL(k,I,34)^Qt.rotrBL(k,I,39),Y=k&S^k&P^S&P,J=I&O^I&x^O&x;j=0|C,L=0|U,C=0|R,U=0|B,R=0|T,B=0|N,T=(q=Qt.add(0|_,0|A,0|K,0|W)).h,N=q.l,_=0|P,A=0|x,P=0|S,x=0|O,S=0|k,O=0|I;var Q=Qt.add3L(W,Z,J);k=Qt.add3H(Q,K,G,Y),I=0|Q}k=(n=Qt.add(0|this.Ah,0|this.Al,0|k,0|I)).h,I=n.l,S=(r=Qt.add(0|this.Bh,0|this.Bl,0|S,0|O)).h,O=r.l,P=(i=Qt.add(0|this.Ch,0|this.Cl,0|P,0|x)).h,x=i.l,_=(o=Qt.add(0|this.Dh,0|this.Dl,0|_,0|A)).h,A=o.l,T=(a=Qt.add(0|this.Eh,0|this.El,0|T,0|N)).h,N=a.l,R=(s=Qt.add(0|this.Fh,0|this.Fl,0|R,0|B)).h,B=s.l,C=(c=Qt.add(0|this.Gh,0|this.Gl,0|C,0|U)).h,U=c.l,j=(u=Qt.add(0|this.Hh,0|this.Hl,0|j,0|L)).h,L=u.l,this.set(k,I,S,O,P,x,_,A,T,N,R,B,C,U,j,L)}},{key:"roundClean",value:function(){nn.fill(0),rn.fill(0)}},{key:"destroy",value:function(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}])}(Gt),sn=function(e){var t=function(t){return e().update(Ft(t)).digest()},n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(){return e()},t}(function(){return new on}),cn=BigInt(0),un=BigInt(1),ln=BigInt(2);function fn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function hn(e){if(!fn(e))throw new Error("Uint8Array expected")}function dn(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}var pn=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function vn(e){hn(e);for(var t="",n=0;n<e.length;n++)t+=pn[e[n]];return t}function gn(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));return""===e?cn:BigInt("0x"+e)}var yn=48,mn=57,wn=65,bn=70,En=97,kn=102;function In(e){return e>=yn&&e<=mn?e-yn:e>=wn&&e<=bn?e-(wn-10):e>=En&&e<=kn?e-(En-10):void 0}function Sn(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));var t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var r=new Uint8Array(n),i=0,o=0;i<n;i++,o+=2){var a=In(e.charCodeAt(o)),s=In(e.charCodeAt(o+1));if(void 0===a||void 0===s){var c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}r[i]=16*a+s}return r}function On(e){return hn(e),gn(vn(Uint8Array.from(e).reverse()))}function Pn(e,t){return Sn(e.toString(16).padStart(2*t,"0"))}function xn(e,t){return Pn(e,t).reverse()}function _n(e,t,n){var r;if("string"==typeof t)try{r=Sn(t)}catch(he){throw new Error(e+" must be hex string or Uint8Array, cause: "+he)}else{if(!fn(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}var i=r.length;if("number"==typeof n&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function An(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];hn(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r}var Tn=function(e){return"bigint"==typeof e&&cn<=e};function Nn(e,t,n,r){if(!function(e,t,n){return Tn(e)&&Tn(t)&&Tn(n)&&t<=e&&e<n}(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}var Rn=function(e){return(ln<<BigInt(e-1))-un},Bn={bigint:function(e){return"bigint"==typeof e},function:function(e){return"function"==typeof e},boolean:function(e){return"boolean"==typeof e},string:function(e){return"string"==typeof e},stringOrUint8Array:function(e){return"string"==typeof e||fn(e)},isSafeInteger:function(e){return Number.isSafeInteger(e)},array:function(e){return Array.isArray(e)},field:function(e,t){return t.Fp.isValid(e)},hash:function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)}};function Cn(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=function(t,n,r){var i=Bn[n];if("function"!=typeof i)throw new Error("invalid validator function");var o=e[t];if(!(r&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)},o=0,a=Object.entries(t);o<a.length;o++){var s=r(a[o],2);i(s[0],s[1],!1)}for(var c=0,u=Object.entries(n);c<u.length;c++){var l=r(u[c],2);i(l[0],l[1],!0)}return e}function Un(e){var t=new WeakMap;return function(n){var r=t.get(n);if(void 0!==r)return r;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.apply(void 0,[n].concat(o));return t.set(n,s),s}}var jn=BigInt(0),Ln=BigInt(1),Dn=BigInt(2),qn=BigInt(3),Mn=BigInt(4),zn=BigInt(5),Hn=BigInt(8);function Vn(e,t){var n=e%t;return n>=jn?n:t+n}function Fn(e,t,n){if(t<jn)throw new Error("invalid exponent, negatives unsupported");if(n<=jn)throw new Error("invalid modulus");if(n===Ln)return jn;for(var r=Ln;t>jn;)t&Ln&&(r=r*e%n),e=e*e%n,t>>=Ln;return r}function Kn(e,t,n){for(var r=e;t-- >jn;)r*=r,r%=n;return r}function Wn(e,t){if(e===jn)throw new Error("invert: expected non-zero number");if(t<=jn)throw new Error("invert: expected positive modulus, got "+t);for(var n=Vn(e,t),r=t,i=jn,o=Ln;n!==jn;){var a=r%n,s=i-o*(r/n);r=n,n=a,i=o,o=s}if(r!==Ln)throw new Error("invert: does not exist");return Vn(i,t)}function Gn(e){if(e%Mn===qn){var t=(e+Ln)/Mn;return function(e,n){var r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%Hn===zn){var n=(e-zn)/Hn;return function(e,t){var r=e.mul(t,Dn),i=e.pow(r,n),o=e.mul(t,i),a=e.mul(e.mul(o,Dn),i),s=e.mul(o,e.sub(a,e.ONE));if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}}return function(e){var t,n,r,i=(e-Ln)/Dn;for(t=e-Ln,n=0;t%Dn===jn;t/=Dn,n++);for(r=Dn;r<e&&Fn(r,i,e)!==e-Ln;r++)if(r>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){var o=(e+Ln)/Mn;return function(e,t){var n=e.pow(t,o);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}}var a=(t+Ln)/Dn;return function(e,o){if(e.pow(o,i)===e.neg(e.ONE))throw new Error("Cannot find square root");for(var s=n,c=e.pow(e.mul(e.ONE,r),t),u=e.pow(o,a),l=e.pow(o,t);!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;for(var f=1,h=e.sqr(l);f<s&&!e.eql(h,e.ONE);f++)h=e.sqr(h);var d=e.pow(c,Ln<<BigInt(s-f-1));c=e.sqr(d),u=e.mul(u,d),l=e.mul(l,c),s=f}return u}}(e)}var Zn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Yn(e,t){var n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Jn(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=jn)throw new Error("invalid field: expected ORDER > 0, got "+e);var i,o=Yn(e,t),a=o.nBitLength,s=o.nByteLength;if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var c=Object.freeze({ORDER:e,isLE:n,BITS:a,BYTES:s,MASK:Rn(a),ZERO:jn,ONE:Ln,create:function(t){return Vn(t,e)},isValid:function(t){if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+_(t));return jn<=t&&t<e},is0:function(e){return e===jn},isOdd:function(e){return(e&Ln)===Ln},neg:function(t){return Vn(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return Vn(t*t,e)},add:function(t,n){return Vn(t+n,e)},sub:function(t,n){return Vn(t-n,e)},mul:function(t,n){return Vn(t*n,e)},pow:function(e,t){return function(e,t,n){if(n<jn)throw new Error("invalid exponent, negatives unsupported");if(n===jn)return e.ONE;if(n===Ln)return t;for(var r=e.ONE,i=t;n>jn;)n&Ln&&(r=e.mul(r,i)),i=e.sqr(i),n>>=Ln;return r}(c,e,t)},div:function(t,n){return Vn(t*Wn(n,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return Wn(t,e)},sqrt:r.sqrt||function(t){return i||(i=Gn(e)),i(c,t)},invertBatch:function(e){return function(e,t){var n=new Array(t.length),r=t.reduce(function(t,r,i){return e.is0(r)?t:(n[i]=t,e.mul(t,r))},e.ONE),i=e.inv(r);return t.reduceRight(function(t,r,i){return e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))},i),n}(c,e)},cmov:function(e,t,n){return n?t:e},toBytes:function(e){return n?xn(e,s):Pn(e,s)},fromBytes:function(e){if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return n?On(e):function(e){return gn(vn(e))}(e)}});return Object.freeze(c)}var Qn=BigInt(0),Xn=BigInt(1);function $n(e,t){var n=t.negate();return e?n:t}function er(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function tr(e,t){return er(e,t),{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1)}}var nr=new WeakMap,rr=new WeakMap;function ir(e){return rr.get(e)||1}function or(e,t,n,r){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(function(e,n){if(!(e instanceof t))throw new Error("invalid point at index "+n)})}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(function(e,n){if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");for(var i=e.ZERO,o=function(e){var t;for(t=0;e>cn;e>>=un,t+=1);return t}(BigInt(n.length)),a=o>12?o-3:o>4?o-2:o?2:1,s=(1<<a)-1,c=new Array(s+1).fill(i),u=i,l=Math.floor((t.BITS-1)/a)*a;l>=0;l-=a){c.fill(i);for(var f=0;f<r.length;f++){var h=r[f],d=Number(h>>BigInt(l)&BigInt(s));c[d]=c[d].add(n[f])}for(var p=i,v=c.length-1,g=i;v>0;v--)g=g.add(c[v]),p=p.add(g);if(u=u.add(p),0!==l)for(var y=0;y<a;y++)u=u.double()}return u}function ar(e){return function(e){var t=Zn.reduce(function(e,t){return e[t]="function",e},{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});Cn(e,t)}(e.Fp),Cn(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(a(a(a({},Yn(e.n,e.nBitLength)),e),{},{p:e.Fp.ORDER}))}var sr=BigInt(0),cr=BigInt(1),ur=BigInt(2),lr=BigInt(8),fr={zip215:!0};function hr(e){var t=function(e){var t=ar(e);return Cn(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze(a({},t))}(e),n=t.Fp,r=t.n,i=t.prehash,o=t.hash,s=t.randomBytes,c=t.nByteLength,u=t.h,l=ur<<BigInt(8*c)-cr,f=n.create,h=Jn(t.n,t.nBitLength),d=t.uvRatio||function(e,t){try{return{isValid:!0,value:n.sqrt(e*n.inv(t))}}catch(r){return{isValid:!1,value:sr}}},p=t.adjustScalarBytes||function(e){return e},v=t.domain||function(e,t,n){if(dn("phflag",n),t.length||n)throw new Error("Contexts/pre-hash are not supported");return e};function g(e,t){Nn("coordinate "+e,t,sr,l)}function y(e){if(!(e instanceof b))throw new Error("ExtendedPoint expected")}var m=Un(function(e,t){var r=e.ex,i=e.ey,o=e.ez,a=e.is0();null==t&&(t=a?lr:n.inv(o));var s=f(r*t),c=f(i*t),u=f(o*t);if(a)return{x:sr,y:cr};if(u!==cr)throw new Error("invZ was invalid");return{x:s,y:c}}),w=Un(function(e){var n=t.a,r=t.d;if(e.is0())throw new Error("bad point: ZERO");var i=e.ex,o=e.ey,a=e.ez,s=e.et,c=f(i*i),u=f(o*o),l=f(a*a),h=f(l*l),d=f(c*n);if(f(l*f(d+u))!==f(h+f(r*f(c*u))))throw new Error("bad point: equation left != right (1)");if(f(i*o)!==f(a*s))throw new Error("bad point: equation left != right (2)");return!0}),b=function(){function e(t,n,r,i){S(this,e),this.ex=t,this.ey=n,this.ez=r,this.et=i,g("x",t),g("y",n),g("z",r),g("t",i),Object.freeze(this)}return P(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){I.setWindowSize(this,e)}},{key:"assertValidity",value:function(){w(this)}},{key:"equals",value:function(e){y(e);var t=this.ex,n=this.ey,r=this.ez,i=e.ex,o=e.ey,a=e.ez,s=f(t*a),c=f(i*r),u=f(n*a),l=f(o*r);return s===c&&u===l}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"negate",value:function(){return new e(f(-this.ex),this.ey,this.ez,f(-this.et))}},{key:"double",value:function(){var n=t.a,r=this.ex,i=this.ey,o=this.ez,a=f(r*r),s=f(i*i),c=f(ur*f(o*o)),u=f(n*a),l=r+i,h=f(f(l*l)-a-s),d=u+s,p=d-c,v=u-s,g=f(h*p),y=f(d*v),m=f(h*v);return new e(g,y,f(p*d),m)}},{key:"add",value:function(n){y(n);var r=t.a,i=t.d,o=this.ex,a=this.ey,s=this.ez,c=this.et,u=n.ex,l=n.ey,h=n.ez,d=n.et;if(r===BigInt(-1)){var p=f((a-o)*(l+u)),v=f((a+o)*(l-u)),g=f(v-p);if(g===sr)return this.double();var m=f(s*ur*d),w=f(c*ur*h),b=w+m,E=v+p,k=w-m,I=f(b*g),S=f(E*k),O=f(b*k);return new e(I,S,f(g*E),O)}var P=f(o*u),x=f(a*l),_=f(c*i*d),A=f(s*h),T=f((o+a)*(u+l)-P-x),N=A-_,R=A+_,B=f(x-r*P),C=f(T*N),U=f(R*B),j=f(T*B);return new e(C,U,f(N*R),j)}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"wNAF",value:function(t){return I.wNAFCached(this,t,e.normalizeZ)}},{key:"multiply",value:function(t){var n=t;Nn("scalar",n,cr,r);var i=this.wNAF(n),o=i.p,a=i.f;return e.normalizeZ([o,a])[0]}},{key:"multiplyUnsafe",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ZERO,i=t;return Nn("scalar",i,sr,r),i===sr?k:this.is0()||i===cr?this:I.wNAFCachedUnsafe(this,i,e.normalizeZ,n)}},{key:"isSmallOrder",value:function(){return this.multiplyUnsafe(u).is0()}},{key:"isTorsionFree",value:function(){return I.unsafeLadder(this,r).is0()}},{key:"toAffine",value:function(e){return m(this,e)}},{key:"clearCofactor",value:function(){var e=t.h;return e===cr?this:this.multiplyUnsafe(e)}},{key:"toRawBytes",value:function(){var e=this.toAffine(),t=e.x,r=xn(e.y,n.BYTES);return r[r.length-1]|=t&cr?128:0,r}},{key:"toHex",value:function(){return vn(this.toRawBytes())}}],[{key:"fromAffine",value:function(t){if(t instanceof e)throw new Error("extended point not allowed");var n=t||{},r=n.x,i=n.y;return g("x",r),g("y",i),new e(r,i,cr,f(r*i))}},{key:"normalizeZ",value:function(t){var r=n.invertBatch(t.map(function(e){return e.ez}));return t.map(function(e,t){return e.toAffine(r[t])}).map(e.fromAffine)}},{key:"msm",value:function(t,n){return or(e,h,t,n)}},{key:"fromHex",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=t.d,a=t.a,s=n.BYTES;r=_n("pointHex",r,s),dn("zip215",i);var c=r.slice(),u=r[s-1];c[s-1]=-129&u;var h=On(c),p=i?l:n.ORDER;Nn("pointHex.y",h,sr,p);var v=f(h*h),g=f(v-cr),y=f(o*v-a),m=d(g,y),w=m.isValid,b=m.value;if(!w)throw new Error("Point.fromHex: invalid y coordinate");var E=(b&cr)===cr,k=!!(128&u);if(!i&&b===sr&&k)throw new Error("Point.fromHex: x=0 and x_0=1");return k!==E&&(b=f(-b)),e.fromAffine({x:b,y:h})}},{key:"fromPrivateKey",value:function(e){return _(e).point}}])}();b.BASE=new b(t.Gx,t.Gy,cr,f(t.Gx*t.Gy)),b.ZERO=new b(sr,cr,cr,sr);var E=b.BASE,k=b.ZERO,I=function(e,t){return{constTimeNegate:$n,hasPrecomputes:function(e){return 1!==ir(e)},unsafeLadder:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,i=t;n>Qn;)n&Xn&&(r=r.add(i)),i=i.double(),n>>=Xn;return r},precomputeWindow:function(e,n){for(var r=tr(n,t),i=r.windows,o=r.windowSize,a=[],s=e,c=s,u=0;u<i;u++){c=s,a.push(c);for(var l=1;l<o;l++)c=c.add(s),a.push(c);s=c.double()}return a},wNAF:function(n,r,i){for(var o=tr(n,t),a=o.windows,s=o.windowSize,c=e.ZERO,u=e.BASE,l=BigInt(Math.pow(2,n)-1),f=Math.pow(2,n),h=BigInt(n),d=0;d<a;d++){var p=d*s,v=Number(i&l);i>>=h,v>s&&(v-=f,i+=Xn);var g=p,y=p+Math.abs(v)-1,m=d%2!=0,w=v<0;0===v?u=u.add($n(m,r[g])):c=c.add($n(w,r[y]))}return{p:c,f:u}},wNAFUnsafe:function(n,r,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO,a=tr(n,t),s=a.windows,c=a.windowSize,u=BigInt(Math.pow(2,n)-1),l=Math.pow(2,n),f=BigInt(n),h=0;h<s;h++){var d=h*c;if(i===Qn)break;var p=Number(i&u);if(i>>=f,p>c&&(p-=l,i+=Xn),0!==p){var v=r[d+Math.abs(p)-1];p<0&&(v=v.negate()),o=o.add(v)}}return o},getPrecomputes:function(e,t,n){var r=nr.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&nr.set(t,n(r))),r},wNAFCached:function(e,t,n){var r=ir(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe:function(e,t,n,r){var i=ir(e);return 1===i?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize:function(e,n){er(n,t),rr.set(e,n),nr.delete(e)}}}(b,8*c);function O(e){return Vn(e,r)}function x(e){return O(On(e))}function _(e){var t=n.BYTES;e=_n("private key",e,t);var r=_n("hashed private key",o(e),2*t),i=p(r.slice(0,t)),a=r.slice(t,2*t),s=x(i),c=E.multiply(s),u=c.toRawBytes();return{head:i,prefix:a,scalar:s,point:c,pointBytes:u}}function A(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array,t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=An.apply(void 0,n);return x(o(v(a,_n("context",e),!!i)))}var T=fr;return E._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return _(e).pointBytes},sign:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=_n("message",e),i&&(e=i(e));var a=_(t),s=a.prefix,c=a.scalar,u=a.pointBytes,l=A(o.context,s,e),f=E.multiply(l).toRawBytes(),h=O(l+A(o.context,f,u,e)*c);return Nn("signature.s",h,sr,r),_n("result",An(f,xn(h,n.BYTES)),2*n.BYTES)},verify:function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T,a=o.context,s=o.zip215,c=n.BYTES;e=_n("signature",e,2*c),t=_n("message",t),r=_n("publicKey",r,c),void 0!==s&&dn("zip215",s),i&&(t=i(t));var u,l,f,h=On(e.slice(c,2*c));try{u=b.fromHex(r,s),l=b.fromHex(e.slice(0,c),s),f=E.multiplyUnsafe(h)}catch(p){return!1}if(!s&&u.isSmallOrder())return!1;var d=A(a,l.toRawBytes(),u.toRawBytes(),t);return l.add(u.multiplyUnsafe(d)).subtract(f).clearCofactor().equals(b.ZERO)},ExtendedPoint:b,utils:{getExtendedPublicKey:_,randomPrivateKey:function(){return s(n.BYTES)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}}}}BigInt(0),BigInt(1);var dr=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),pr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);var vr=BigInt(1),gr=BigInt(2);BigInt(3);var yr=BigInt(5),mr=BigInt(8);function wr(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function br(e,t){var n=dr,r=Vn(t*t*t,n),i=function(e){var t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),o=dr,a=e*e%o*e%o,s=Kn(a,gr,o)*a%o,c=Kn(s,vr,o)*e%o,u=Kn(c,yr,o)*c%o,l=Kn(u,t,o)*u%o,f=Kn(l,n,o)*l%o,h=Kn(f,r,o)*f%o,d=Kn(h,i,o)*h%o,p=Kn(d,i,o)*h%o,v=Kn(p,t,o)*u%o;return{pow_p_5_8:Kn(v,gr,o)*e%o,b2:a}}(e*Vn(r*r*t,n)).pow_p_5_8,o=Vn(e*r*i,n),a=Vn(t*o*o,n),s=o,c=Vn(o*pr,n),u=a===e,l=a===Vn(-e,n),f=a===Vn(-e*pr,n);return u&&(o=s),(l||f)&&(o=c),function(e,t){return(Vn(e,t)&Ln)===Ln}(o,n)&&(o=Vn(-o,n)),{isValid:u||l,value:o}}var Er=Jn(dr,void 0,!0),kr=hr({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Er,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:mr,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:sn,randomBytes:Wt,adjustScalarBytes:wr,uvRatio:br}),Ir=".",Sr="base64url",Or="utf8",Pr="utf8",xr=":",_r="did",Ar="key",Tr="base58btc",Nr="z",Rr="K36",Br=32;function Cr(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ur(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Cr(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function jr(e,t){t||(t=e.reduce(function(e,t){return e+t.length},0));var n,r=Ur(t),i=0,o=u(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.set(a,i),i+=a.length}}catch(s){o.e(s)}finally{o.f()}return Cr(r)}var Lr=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),a=o.charCodeAt(0);if(255!==n[a])throw new TypeError(o+" is ambiguous");n[a]=i}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*u+1>>>0,a=new Uint8Array(o);e[t];){var l=n[e.charCodeAt(t)];if(255===l)return;for(var f=0,h=o-1;(0!==l||f<i)&&-1!==h;h--,f++)l+=s*a[h]>>>0,a[h]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===a[d];)d++;for(var p=new Uint8Array(r+(o-d)),v=r;d!==o;)p[v++]=a[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var a=(o-i)*l+1>>>0,u=new Uint8Array(a);i!==o;){for(var f=t[i],h=0,d=a-1;(0!==f||h<r)&&-1!==d;d--,h++)f+=256*u[d]>>>0,u[d]=f%s>>>0,f=f/s>>>0;if(0!==f)throw new Error("Non-zero carry");r=h,i++}for(var p=a-r;p!==a&&0===u[p];)p++;for(var v=c.repeat(n);p<a;++p)v+=e.charAt(u[p]);return v},decodeUnsafe:f,decode:function(e){var n=f(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}},Dr=Lr,qr=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Mr=function(){return P(function e(t,n,r){S(this,e),this.name=t,this.prefix=n,this.baseEncode=r},[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}])}(),zr=function(){return P(function e(t,n,r){if(S(this,e),this.name=t,this.prefix=n,void 0===n.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r},[{key:"decode",value:function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return Vr(this,e)}}])}(),Hr=function(){return P(function e(t){S(this,e),this.decoders=t},[{key:"or",value:function(e){return Vr(this,e)}},{key:"decode",value:function(e){var t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}])}(),Vr=function(e,t){return new Hr(a(a({},e.decoders||s({},e.prefix,e)),t.decoders||s({},t.prefix,t)))},Fr=function(){return P(function e(t,n,r,i){S(this,e),this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new Mr(t,n,r),this.decoder=new zr(t,n,i)},[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}])}(),Kr=function(e){var t=e.name,n=e.prefix,r=e.encode,i=e.decode;return new Fr(t,n,r,i)},Wr=function(e){var t=e.prefix,n=e.name,r=e.alphabet,i=Dr(r,n),o=i.encode,a=i.decode;return Kr({prefix:t,name:n,encode:o,decode:function(e){return qr(a(e))}})},Gr=function(e){var t=e.name,n=e.prefix,r=e.bitsPerChar,i=e.alphabet;return Kr({prefix:n,name:t,encode:function(e){return function(e,t,n){for(var r="="===t[t.length-1],i=(1<<n)-1,o="",a=0,s=0,c=0;c<e.length;++c)for(s=s<<8|e[c],a+=8;a>n;)o+=t[i&s>>(a-=n)];if(a&&(o+=t[i&s<<n-a]),r)for(;o.length*n&7;)o+="=";return o}(e,i,r)},decode:function(e){return function(e,t,n,r){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var a=e.length;"="===e[a-1];)--a;for(var s=new Uint8Array(a*n/8|0),c=0,u=0,l=0,f=0;f<a;++f){var h=i[e[f]];if(void 0===h)throw new SyntaxError("Non-".concat(r," character"));u=u<<n|h,(c+=n)>=8&&(c-=8,s[l++]=255&u>>c)}if(c>=n||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s}(e,i,r,t)}})},Zr=Kr({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),Yr=Object.freeze({__proto__:null,identity:Zr}),Jr=Gr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Qr=Object.freeze({__proto__:null,base2:Jr}),Xr=Gr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),$r=Object.freeze({__proto__:null,base8:Xr}),ei=Wr({prefix:"9",name:"base10",alphabet:"0123456789"}),ti=Object.freeze({__proto__:null,base10:ei}),ni=Gr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ri=Gr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ii=Object.freeze({__proto__:null,base16:ni,base16upper:ri}),oi=Gr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ai=Gr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),si=Gr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ci=Gr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ui=Gr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),li=Gr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),fi=Gr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),hi=Gr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),di=Gr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),pi=Object.freeze({__proto__:null,base32:oi,base32upper:ai,base32pad:si,base32padupper:ci,base32hex:ui,base32hexupper:li,base32hexpad:fi,base32hexpadupper:hi,base32z:di}),vi=Wr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),gi=Wr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),yi=Object.freeze({__proto__:null,base36:vi,base36upper:gi}),mi=Wr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wi=Wr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),bi=Object.freeze({__proto__:null,base58btc:mi,base58flickr:wi}),Ei=Gr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ki=Gr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ii=Gr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Si=Gr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Oi=Object.freeze({__proto__:null,base64:Ei,base64pad:ki,base64url:Ii,base64urlpad:Si}),Pi=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),xi=Pi.reduce(function(e,t,n){return e[n]=t,e},[]),_i=Pi.reduce(function(e,t,n){return e[t.codePointAt(0)]=n,e},[]);var Ai=Kr({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(function(e,t){return e+=xi[t]},"")},decode:function(e){var t,n=[],r=u(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=_i[i.codePointAt(0)];if(void 0===o)throw new Error("Non-base256emoji character: ".concat(i));n.push(o)}}catch(a){r.e(a)}finally{r.f()}return new Uint8Array(n)}}),Ti=Object.freeze({__proto__:null,base256emoji:Ai}),Ni=function e(t,n,r){n=n||[];for(var i=r=r||0;t>=Ci;)n[r++]=255&t|Ri,t/=128;for(;t&Bi;)n[r++]=255&t|Ri,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},Ri=128,Bi=-128,Ci=Math.pow(2,31);var Ui=function e(t,n){var r,i=0,o=(n=n||0,0),a=n,s=t.length;do{if(a>=s)throw e.bytes=0,new RangeError("Could not decode varint");r=t[a++],i+=o<28?(r&Li)<<o:(r&Li)*Math.pow(2,o),o+=7}while(r>=ji);return e.bytes=a-n,i},ji=128,Li=127;var Di=Math.pow(2,7),qi=Math.pow(2,14),Mi=Math.pow(2,21),zi=Math.pow(2,28),Hi=Math.pow(2,35),Vi=Math.pow(2,42),Fi=Math.pow(2,49),Ki=Math.pow(2,56),Wi=Math.pow(2,63),Gi={encode:Ni,decode:Ui,encodingLength:function(e){return e<Di?1:e<qi?2:e<Mi?3:e<zi?4:e<Hi?5:e<Vi?6:e<Fi?7:e<Ki?8:e<Wi?9:10}},Zi=Gi,Yi=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Zi.encode(e,t,n),t},Ji=function(e){return Zi.encodingLength(e)},Qi=function(e,t){var n=t.byteLength,r=Ji(e),i=r+Ji(n),o=new Uint8Array(i+n);return Yi(e,o,0),Yi(n,o,r),o.set(t,i),new Xi(e,n,t,o)},Xi=P(function e(t,n,r,i){S(this,e),this.code=t,this.size=n,this.digest=r,this.bytes=i}),$i=function(e){var t=e.name,n=e.code,r=e.encode;return new eo(t,n,r)},eo=function(){return P(function e(t,n,r){S(this,e),this.name=t,this.code=n,this.encode=r},[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var n=this.encode(e);return n instanceof Uint8Array?Qi(this.code,n):n.then(function(e){return Qi(t.code,e)})}throw Error("Unknown type, must be binary type")}}])}(),to=function(e){return function(){var t=g(d().m(function t(n){var r,i;return d().w(function(t){for(;;)switch(t.n){case 0:return r=Uint8Array,t.n=1,crypto.subtle.digest(e,n);case 1:return i=t.v,t.a(2,new r(i))}},t)}));return function(e){return t.apply(this,arguments)}}()},no=$i({name:"sha2-256",code:18,encode:to("SHA-256")}),ro=$i({name:"sha2-512",code:19,encode:to("SHA-512")}),io=Object.freeze({__proto__:null,sha256:no,sha512:ro}),oo=qr,ao={code:0,name:"identity",encode:oo,digest:function(e){return Qi(0,oo(e))}},so=Object.freeze({__proto__:null,identity:ao});new TextEncoder,new TextDecoder;var co=a(a(a(a(a(a(a(a(a(a({},Yr),Qr),$r),ti),ii),pi),yi),bi),Oi),Ti);function uo(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}a(a({},io),so);var lo=uo("utf8","u",function(e){return"u"+new TextDecoder("utf8").decode(e)},function(e){return(new TextEncoder).encode(e.substring(1))}),fo=uo("ascii","a",function(e){for(var t="a",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},function(e){for(var t=Ur((e=e.substring(1)).length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),ho=a({utf8:lo,"utf-8":lo,hex:co.base16,latin1:fo,ascii:fo,binary:fo},co);function po(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=ho[t];if(!n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function vo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=ho[t];if(!n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode("".concat(n.prefix).concat(e)):Cr(globalThis.Buffer.from(e,"utf-8"))}function go(e){return je(po(vo(e,Sr),Or))}function yo(e){return po(vo(Le(e),Or),Sr)}function mo(e){var t=vo(Rr,Tr),n=Nr+po(jr([t,e]),Tr);return[_r,Ar,n].join(xr)}function wo(e){return po(e,Sr)}function bo(e){return vo([yo(e.header),yo(e.payload)].join(Ir),Pr)}function Eo(e){return[yo(e.header),yo(e.payload),wo(e.signature)].join(Ir)}function ko(e){var t=e.split(Ir),n=go(t[0]),r=go(t[1]),i=function(e){return vo(e,Sr)}(t[2]);return{header:n,payload:r,signature:i,data:vo(t.slice(0,2).join(Ir),Pr)}}function Io(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt(Br),t=kr.getPublicKey(e);return{secretKey:jr([e,t]),publicKey:t}}function So(e,t,n,r){return Oo.apply(this,arguments)}function Oo(){return Oo=g(d().m(function e(t,n,r,i){var o,a,s,c,u,l,f=arguments;return d().w(function(e){for(;;)if(0===e.n)return o=f.length>4&&void 0!==f[4]?f[4]:ue.fromMiliseconds(Date.now()),a={alg:"EdDSA",typ:"JWT"},s=mo(i.publicKey),u=bo({header:a,payload:c={iss:s,sub:t,aud:n,iat:o,exp:o+r}}),l=kr.sign(u,i.secretKey.slice(0,32)),e.a(2,Eo({header:a,payload:c,signature:l}))},e)})),Oo.apply(this,arguments)}var Po=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},xo=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},_o=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},Ao=function(e,t,n,r){this.name=e,this.version=t,this.os=n,this.bot=r,this.type="bot-device"},To=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},No=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},Ro=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Bo=3,Co=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Uo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function jo(e){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new No:"undefined"!=typeof navigator?function(e){var t=function(e){return""!==e&&Co.reduce(function(t,n){var r=n[0],i=n[1];if(t)return t;var o=i.exec(e);return!!o&&[r,o]},!1)}(e);if(!t)return null;var n=t[0],r=t[1];if("searchbot"===n)return new To;var i=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);i?i.length<Bo&&(i=Po(Po([],i,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(Bo-i.length),!0)):i=[];var o=i.join("."),a=function(e){for(var t=0,n=Uo.length;t<n;t++){var r=Uo[t],i=r[0];if(r[1].exec(e))return i}return null}(e),s=Ro.exec(e);if(s&&s[1])return new Ao(n,o,a,s[1]);return new xo(n,o,a)}(navigator.userAgent):"undefined"!=typeof process&&process.version?new _o(process.version.slice(1)):null}var Lo,Do={};function qo(){if(Lo)return Do;function e(e){var t=void 0;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function t(t){var n=e(t);if(!n)throw new Error("".concat(t," is not defined in Window"));return n}return Lo=1,Object.defineProperty(Do,"__esModule",{value:!0}),Do.getLocalStorage=Do.getLocalStorageOrThrow=Do.getCrypto=Do.getCryptoOrThrow=Do.getLocation=Do.getLocationOrThrow=Do.getNavigator=Do.getNavigatorOrThrow=Do.getDocument=Do.getDocumentOrThrow=Do.getFromWindowOrThrow=Do.getFromWindow=void 0,Do.getFromWindow=e,Do.getFromWindowOrThrow=t,Do.getDocumentOrThrow=function(){return t("document")},Do.getDocument=function(){return e("document")},Do.getNavigatorOrThrow=function(){return t("navigator")},Do.getNavigator=function(){return e("navigator")},Do.getLocationOrThrow=function(){return t("location")},Do.getLocation=function(){return e("location")},Do.getCryptoOrThrow=function(){return t("crypto")},Do.getCrypto=function(){return e("crypto")},Do.getLocalStorageOrThrow=function(){return t("localStorage")},Do.getLocalStorage=function(){return e("localStorage")},Do}var Mo,zo=t("l",qo()),Ho={};var Vo=t("h",function(){if(Mo)return Ho;Mo=1,Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.getWindowMetadata=void 0;var e=qo();return Ho.getWindowMetadata=function(){var t,n;try{t=e.getDocumentOrThrow(),n=e.getLocationOrThrow()}catch(rO){return null}function r(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i,o=t.getElementsByTagName("meta"),a=function(){var e=o[s],t=["itemprop","property","name"].map(function(t){return e.getAttribute(t)}).filter(function(e){return!!e&&n.includes(e)});if(t.length&&t){var r=e.getAttribute("content");if(r)return{v:r}}},s=0;s<o.length;s++)if(i=a())return i.v;return""}var i=function(){var e=r("name","og:site_name","og:title","twitter:title");return e||(e=t.title),e}();return{description:r("description","og:description","twitter:description","keywords"),url:n.origin,icons:function(){for(var e=t.getElementsByTagName("link"),r=[],i=0;i<e.length;i++){var o=e[i],a=o.getAttribute("rel");if(a&&a.toLowerCase().indexOf("icon")>-1){var s=o.getAttribute("href");if(s)if(-1===s.toLowerCase().indexOf("https:")&&-1===s.toLowerCase().indexOf("http:")&&0!==s.indexOf("//")){var c=n.protocol+"//"+n.host;if(0===s.indexOf("/"))c+=s;else{var u=n.pathname.split("/");u.pop(),c+=u.join("/")+"/"+s}r.push(c)}else if(0===s.indexOf("//")){var l=n.protocol+s;r.push(l)}else r.push(s)}}return r}(),name:i}},Ho}());function Fo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Ko(e,t){t||(t=e.reduce(function(e,t){return e+t.length},0));var n,r=Fo(t),i=0,o=u(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.set(a,i),i+=a.length}}catch(s){o.e(s)}finally{o.f()}return r}!function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=r}var a=e.length,s=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var n=0,r=0,i=0;e[n]===s;)0;for(var o=(e.length-n)*c+1>>>0,u=new Uint8Array(o);n<e.length;){var l=e.charCodeAt(n);if(l>255)return;var f=t[l];if(255===f)return;for(var h=0,d=o-1;(0!==f||h<i)&&-1!==d;h++)a*u[d]>>>0,u[d]=f%256>>>0;if(0!==f)throw new Error("Non-zero carry");0}for(var p=o-i;p!==o&&0===u[p];)0;for(var v=new Uint8Array(r+(o-p)),g=r;p!==o;)v[g++]=u[p++];return v}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");var Wo=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),a=o.charCodeAt(0);if(255!==n[a])throw new TypeError(o+" is ambiguous");n[a]=i}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*u+1>>>0,a=new Uint8Array(o);e[t];){var l=n[e.charCodeAt(t)];if(255===l)return;for(var f=0,h=o-1;(0!==l||f<i)&&-1!==h;h--,f++)l+=s*a[h]>>>0,a[h]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===a[d];)d++;for(var p=new Uint8Array(r+(o-d)),v=r;d!==o;)p[v++]=a[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var a=(o-i)*l+1>>>0,u=new Uint8Array(a);i!==o;){for(var f=t[i],h=0,d=a-1;(0!==f||h<r)&&-1!==d;d--,h++)f+=256*u[d]>>>0,u[d]=f%s>>>0,f=f/s>>>0;if(0!==f)throw new Error("Non-zero carry");r=h,i++}for(var p=a-r;p!==a&&0===u[p];)p++;for(var v=c.repeat(n);p<a;++p)v+=e.charAt(u[p]);return v},decodeUnsafe:f,decode:function(e){var n=f(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}},Go=Wo,Zo=function(){return P(function e(t,n,r){S(this,e),this.name=t,this.prefix=n,this.baseEncode=r},[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}])}(),Yo=function(){return P(function e(t,n,r){if(S(this,e),this.name=t,this.prefix=n,void 0===n.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r},[{key:"decode",value:function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return Qo(this,e)}}])}(),Jo=function(){return P(function e(t){S(this,e),this.decoders=t},[{key:"or",value:function(e){return Qo(this,e)}},{key:"decode",value:function(e){var t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}])}(),Qo=function(e,t){return new Jo(a(a({},e.decoders||s({},e.prefix,e)),t.decoders||s({},t.prefix,t)))},Xo=function(){return P(function e(t,n,r,i){S(this,e),this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new Zo(t,n,r),this.decoder=new Yo(t,n,i)},[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}])}(),$o=function(e){var t=e.name,n=e.prefix,r=e.encode,i=e.decode;return new Xo(t,n,r,i)},ea=function(e){var t=e.prefix,n=e.name,r=e.alphabet,i=Go(r,n),o=i.encode,a=i.decode;return $o({prefix:t,name:n,encode:o,decode:function(e){return function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}(a(e))}})},ta=function(e){var t=e.name,n=e.prefix,r=e.bitsPerChar,i=e.alphabet;return $o({prefix:n,name:t,encode:function(e){return function(e,t,n){for(var r="="===t[t.length-1],i=(1<<n)-1,o="",a=0,s=0,c=0;c<e.length;++c)for(s=s<<8|e[c],a+=8;a>n;)o+=t[i&s>>(a-=n)];if(a&&(o+=t[i&s<<n-a]),r)for(;o.length*n&7;)o+="=";return o}(e,i,r)},decode:function(e){return function(e,t,n,r){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var a=e.length;"="===e[a-1];)--a;for(var s=new Uint8Array(a*n/8|0),c=0,u=0,l=0,f=0;f<a;++f){var h=i[e[f]];if(void 0===h)throw new SyntaxError("Non-".concat(r," character"));u=u<<n|h,(c+=n)>=8&&(c-=8,s[l++]=255&u>>c)}if(c>=n||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s}(e,i,r,t)}})},na=$o({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),ra=Object.freeze(Object.defineProperty({__proto__:null,identity:na},Symbol.toStringTag,{value:"Module"})),ia=ta({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),oa=Object.freeze(Object.defineProperty({__proto__:null,base2:ia},Symbol.toStringTag,{value:"Module"})),aa=ta({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),sa=Object.freeze(Object.defineProperty({__proto__:null,base8:aa},Symbol.toStringTag,{value:"Module"})),ca=ea({prefix:"9",name:"base10",alphabet:"0123456789"}),ua=Object.freeze(Object.defineProperty({__proto__:null,base10:ca},Symbol.toStringTag,{value:"Module"})),la=ta({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),fa=ta({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ha=Object.freeze(Object.defineProperty({__proto__:null,base16:la,base16upper:fa},Symbol.toStringTag,{value:"Module"})),da=ta({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),pa=ta({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),va=ta({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ga=ta({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ya=ta({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ma=ta({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wa=ta({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ba=ta({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ea=ta({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ka=Object.freeze(Object.defineProperty({__proto__:null,base32:da,base32hex:ya,base32hexpad:wa,base32hexpadupper:ba,base32hexupper:ma,base32pad:va,base32padupper:ga,base32upper:pa,base32z:Ea},Symbol.toStringTag,{value:"Module"})),Ia=ea({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Sa=ea({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Oa=Object.freeze(Object.defineProperty({__proto__:null,base36:Ia,base36upper:Sa},Symbol.toStringTag,{value:"Module"})),Pa=ea({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),xa=ea({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),_a=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Pa,base58flickr:xa},Symbol.toStringTag,{value:"Module"})),Aa=ta({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ta=ta({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Na=ta({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ra=ta({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ba=Object.freeze(Object.defineProperty({__proto__:null,base64:Aa,base64pad:Ta,base64url:Na,base64urlpad:Ra},Symbol.toStringTag,{value:"Module"})),Ca=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Ua=Ca.reduce(function(e,t,n){return e[n]=t,e},[]),ja=Ca.reduce(function(e,t,n){return e[t.codePointAt(0)]=n,e},[]);var La=$o({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(function(e,t){return e+=Ua[t]},"")},decode:function(e){var t,n=[],r=u(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=ja[i.codePointAt(0)];if(void 0===o)throw new Error("Non-base256emoji character: ".concat(i));n.push(o)}}catch(a){r.e(a)}finally{r.f()}return new Uint8Array(n)}}),Da=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:La},Symbol.toStringTag,{value:"Module"}));new TextEncoder,new TextDecoder;var qa=a(a(a(a(a(a(a(a(a(a({},ra),oa),sa),ua),ha),ka),Oa),_a),Ba),Da);function Ma(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}var za=Ma("utf8","u",function(e){return"u"+new TextDecoder("utf8").decode(e)},function(e){return(new TextEncoder).encode(e.substring(1))}),Ha=Ma("ascii","a",function(e){for(var t="a",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},function(e){for(var t=Fo((e=e.substring(1)).length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),Va=a({utf8:za,"utf-8":za,hex:qa.base16,latin1:Ha,ascii:Ha,binary:Ha},qa);function Fa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=Va[t];if(!n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode("".concat(n.prefix).concat(e)):globalThis.Buffer.from(e,"utf8")}function Ka(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=Va[t];if(!n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var Wa=t("C",{waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}}),Ga={},Za="react-native",Ya="node",Ja="browser",Qa="unknown",Xa="js";function $a(){return("undefined"==typeof process?"undefined":_(process))<"u"&&_(process.versions)<"u"&&_(process.versions.node)<"u"}function es(){return!zo.getDocument()&&!!zo.getNavigator()&&"ReactNative"===navigator.product}function ts(){return!$a()&&!!zo.getNavigator()&&!!zo.getDocument()}function ns(){return es()?Za:$a()?Ya:ts()?Ja:Qa}function rs(){var e;try{return es()&&("undefined"==typeof global?"undefined":_(global))<"u"&&_(null==global?void 0:global.Application)<"u"?null==(e=global.Application)?void 0:e.applicationId:void 0}catch(t){return}}function is(e,t,n){var r=function(){if(ns()===Za&&("undefined"==typeof global?"undefined":_(global))<"u"&&_(null==global?void 0:global.Platform)<"u"){var e=global.Platform;return[e.OS,e.Version].join("-")}var t=jo();if(null===t)return"unknown";var n=t.os?t.os.replace(" ","").toLowerCase():"unknown";return"browser"===t.type?[n,t.name,t.version].join("-"):[n,t.version].join("-")}(),i=function(){var e,t=ns();return t===Ja?[t,(null==(e=zo.getLocation())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[Xa,n].join("-"),r,i].join("/")}function os(e){var t=e.protocol,n=e.version,r=e.relayUrl,i=e.sdkVersion,o=e.auth,a=e.projectId,s=e.useOnCloseEvent,c=e.bundleId,l=e.packageName,f=r.split("?"),h={auth:o,ua:is(t,n,i),projectId:a,useOnCloseEvent:s,packageName:l||void 0,bundleId:c||void 0},d=function(e,t){var n,r=new URLSearchParams(e),i=u(Object.keys(t).sort());try{for(i.s();!(n=i.n()).done;){var o=n.value;if(t.hasOwnProperty(o)){var a=t[o];void 0!==a&&r.set(o,a)}}}catch(s){i.e(s)}finally{i.f()}return r.toString()}(f[1]||"",h);return f[0]+"?"+d}function as(e){return Object.fromEntries(e.entries())}function ss(e){return new Map(Object.entries(e))}function cs(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue.FIVE_MINUTES,o=arguments.length>1?arguments[1]:void 0,a=ue.toMiliseconds(i||ue.FIVE_MINUTES);return{resolve:function(t){n&&e&&(clearTimeout(n),e(t),r=Promise.resolve(t))},reject:function(e){n&&t&&(clearTimeout(n),t(e))},done:function(){return new Promise(function(i,s){if(r)return i(r);n=setTimeout(function(){var e=new Error(o);r=Promise.reject(e),s(e)},a),e=i,t=s})}}}function us(e,t,n){return new Promise(function(){var r=g(d().m(function r(i,o){var a,s,c;return d().w(function(r){for(;;)switch(r.p=r.n){case 0:return a=setTimeout(function(){return o(new Error(n))},t),r.p=1,r.n=2,e;case 2:s=r.v,i(s),r.n=4;break;case 3:r.p=3,c=r.v,o(c);case 4:clearTimeout(a);case 5:return r.a(2)}},r,null,[[1,3]])}));return function(e,t){return r.apply(this,arguments)}}())}function ls(e,t){if("string"==typeof t&&t.startsWith("".concat(e,":")))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return"topic:".concat(t)}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return"id:".concat(t)}throw new Error("Unknown expirer target type: ".concat(e))}function fs(e){var t=r(e.split(":"),2),n=t[0],i=t[1],o={id:void 0,topic:void 0};if("topic"===n&&"string"==typeof i)o.topic=i;else{if("id"!==n||!Number.isInteger(Number(i)))throw new Error("Invalid target, expected id:number or topic:string, got ".concat(n,":").concat(i));o.id=Number(i)}return o}function hs(e,t){return ue.fromMiliseconds(Date.now()+ue.toMiliseconds(e))}function ds(e){return Date.now()>=ue.toMiliseconds(e)}function ps(e,t){return"".concat(e).concat(t?":".concat(t):"")}function vs(){return("undefined"==typeof crypto?"undefined":_(crypto))<"u"&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function gs(){return("undefined"==typeof process?"undefined":_(process))<"u"&&"true"===Ga.IS_VITEST}function ys(e){return Buffer.from(e,"base64").toString("utf-8")}function ms(e){return new Promise(function(t){return setTimeout(t,e)})}function ws(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function bs(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function Es(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");ws(e.outputLen),ws(e.blockLen)}function ks(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Is(e,t){bs(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var Ss=BigInt(Math.pow(2,32)-1),Os=BigInt(32);function Ps(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&Ss),l:Number(e>>Os&Ss)}:{h:0|Number(e>>Os&Ss),l:0|Number(e&Ss)}}var xs="object"==("undefined"==typeof globalThis?"undefined":_(globalThis))&&"crypto"in globalThis?globalThis.crypto:void 0;function _s(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function As(e,t){return e<<32-t|e>>>t}var Ts=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Ns(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Rs(e){for(var t=0;t<e.length;t++)e[t]=Ns(e[t])}function Bs(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+_(e));return new Uint8Array((new TextEncoder).encode(e))}(e)),bs(e),e}function Cs(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];bs(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r}var Us=function(){return P(function e(){S(this,e)},[{key:"clone",value:function(){return this._cloneInto()}}])}();function js(e){var t=function(t){return e().update(Bs(t)).digest()},n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(){return e()},t}function Ls(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(xs&&"function"==typeof xs.getRandomValues)return xs.getRandomValues(new Uint8Array(e));if(xs&&"function"==typeof xs.randomBytes)return xs.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}for(var Ds=[],qs=[],Ms=[],zs=BigInt(0),Hs=BigInt(1),Vs=BigInt(2),Fs=BigInt(7),Ks=BigInt(256),Ws=BigInt(113),Gs=0,Zs=Hs,Ys=1,Js=0;Gs<24;Gs++){var Qs;Ys=(Qs=[Js,(2*Ys+3*Js)%5])[0],Js=Qs[1],Ds.push(2*(5*Js+Ys)),qs.push((Gs+1)*(Gs+2)/2%64);for(var Xs=zs,$s=0;$s<7;$s++)(Zs=(Zs<<Hs^(Zs>>Fs)*Ws)%Ks)&Vs&&(Xs^=Hs<<(Hs<<BigInt($s))-Hs);Ms.push(Xs)}var ec=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length),i=0;i<e.length;i++){var o=Ps(e[i],t),a=[o.h,o.l];n[i]=a[0],r[i]=a[1]}return[n,r]}(Ms,!0),tc=r(ec,2),nc=tc[0],rc=tc[1],ic=function(e,t,n){return n>32?function(e,t,n){return t<<n-32|e>>>64-n}(e,t,n):function(e,t,n){return e<<n|t>>>32-n}(e,t,n)},oc=function(e,t,n){return n>32?function(e,t,n){return e<<n-32|t>>>64-n}(e,t,n):function(e,t,n){return t<<n|e>>>32-n}(e,t,n)};var ac=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(S(this,t),(i=y(this,t)).blockLen=e,i.suffix=n,i.outputLen=r,i.enableXOF=o,i.rounds=a,i.pos=0,i.posOut=0,i.finished=!1,i.destroyed=!1,ws(r),0>=i.blockLen||i.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");return i.state=new Uint8Array(200),i.state32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}(i.state),i}return k(t,e),P(t,[{key:"keccak",value:function(){Ts||Rs(this.state32),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,n=new Uint32Array(10),r=24-t;r<24;r++){for(var i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(var o=0;o<10;o+=2)for(var a=(o+8)%10,s=(o+2)%10,c=n[s],u=n[s+1],l=ic(c,u,1)^n[a],f=oc(c,u,1)^n[a+1],h=0;h<50;h+=10)e[o+h]^=l,e[o+h+1]^=f;for(var d=e[2],p=e[3],v=0;v<24;v++){var g=qs[v],y=ic(d,p,g),m=oc(d,p,g),w=Ds[v];d=e[w],p=e[w+1],e[w]=y,e[w+1]=m}for(var b=0;b<50;b+=10){for(var E=0;E<10;E++)n[E]=e[b+E];for(var k=0;k<10;k++)e[b+k]^=~n[(k+2)%10]&n[(k+4)%10]}e[0]^=nc[r],e[1]^=rc[r]}n.fill(0)}(this.state32,this.rounds),Ts||Rs(this.state32),this.posOut=0,this.pos=0}},{key:"update",value:function(e){ks(this);for(var t=this.blockLen,n=this.state,r=(e=Bs(e)).length,i=0;i<r;){for(var o=Math.min(t-this.pos,r-i),a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}},{key:"finish",value:function(){if(!this.finished){this.finished=!0;var e=this.state,t=this.suffix,n=this.pos,r=this.blockLen;e[n]^=t,!!(128&t)&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}}},{key:"writeInto",value:function(e){ks(this,!1),bs(e),this.finish();for(var t=this.state,n=this.blockLen,r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();var o=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}},{key:"xofInto",value:function(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}},{key:"xof",value:function(e){return ws(e),this.xofInto(new Uint8Array(e))}},{key:"digestInto",value:function(e){if(Is(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}},{key:"digest",value:function(){return this.digestInto(new Uint8Array(this.outputLen))}},{key:"destroy",value:function(){this.destroyed=!0,this.state.fill(0)}},{key:"_cloneInto",value:function(e){var n=this.blockLen,r=this.suffix,i=this.outputLen,o=this.rounds,a=this.enableXOF;return e||(e=new t(n,r,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}])}(Us);function sc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function cc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function uc(e){if(!cc(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function lc(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function fc(e){if("boolean"!=typeof e)throw new Error("boolean expected, not ".concat(e))}!function(e,t,n){js(function(){return new ac(t,e,n)})}(1,136,32);var hc=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function dc(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!cc(e))throw new Error("Uint8Array expected, got "+_(e));e=gc(e)}return e}function pc(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function vc(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),s=Number(n&o);e.setUint32(t+4,a,r),e.setUint32(t+0,s,r)}function gc(e){return Uint8Array.from(e)}function yc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)t[r].fill(0)}var mc=function(e){return Uint8Array.from(e.split("").map(function(e){return e.charCodeAt(0)}))},wc=mc("expand 16-byte k"),bc=mc("expand 32-byte k"),Ec=hc(wc),kc=hc(bc);function Ic(e,t){return e<<t|e>>>32-t}function Sc(e){return e.byteOffset%4==0}var Oc=Math.pow(2,32)-1,Pc=new Uint32Array;var xc=function(e,t){return 255&e[t++]|(255&e[t++])<<8},_c=function(){return P(function e(t){S(this,e),this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,uc(t=dc(t),32);var n=xc(t,0),r=xc(t,2),i=xc(t,4),o=xc(t,6),a=xc(t,8),s=xc(t,10),c=xc(t,12),u=xc(t,14);this.r[0]=8191&n,this.r[1]=8191&(n>>>13|r<<3),this.r[2]=7939&(r>>>10|i<<6),this.r[3]=8191&(i>>>7|o<<9),this.r[4]=255&(o>>>4|a<<12),this.r[5]=a>>>1&8190,this.r[6]=8191&(a>>>14|s<<2),this.r[7]=8065&(s>>>11|c<<5),this.r[8]=8191&(c>>>8|u<<8),this.r[9]=u>>>5&127;for(var l=0;l<8;l++)this.pad[l]=xc(t,16+2*l)},[{key:"process",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,r=this.h,i=this.r,o=i[0],a=i[1],s=i[2],c=i[3],u=i[4],l=i[5],f=i[6],h=i[7],d=i[8],p=i[9],v=xc(e,t+0),g=xc(e,t+2),y=xc(e,t+4),m=xc(e,t+6),w=xc(e,t+8),b=xc(e,t+10),E=xc(e,t+12),k=xc(e,t+14),I=r[0]+(8191&v),S=r[1]+(8191&(v>>>13|g<<3)),O=r[2]+(8191&(g>>>10|y<<6)),P=r[3]+(8191&(y>>>7|m<<9)),x=r[4]+(8191&(m>>>4|w<<12)),_=r[5]+(w>>>1&8191),A=r[6]+(8191&(w>>>14|b<<2)),T=r[7]+(8191&(b>>>11|E<<5)),N=r[8]+(8191&(E>>>8|k<<8)),R=r[9]+(k>>>5|n),B=0,C=B+I*o+S*(5*p)+O*(5*d)+P*(5*h)+x*(5*f);B=C>>>13,C&=8191;var U=(B+=(C+=_*(5*l)+A*(5*u)+T*(5*c)+N*(5*s)+R*(5*a))>>>13)+I*a+S*o+O*(5*p)+P*(5*d)+x*(5*h);B=U>>>13,U&=8191,B+=(U+=_*(5*f)+A*(5*l)+T*(5*u)+N*(5*c)+R*(5*s))>>>13,U&=8191;var j=B+I*s+S*a+O*o+P*(5*p)+x*(5*d);B=j>>>13,j&=8191,B+=(j+=_*(5*h)+A*(5*f)+T*(5*l)+N*(5*u)+R*(5*c))>>>13,j&=8191;var L=B+I*c+S*s+O*a+P*o+x*(5*p);B=L>>>13,L&=8191,B+=(L+=_*(5*d)+A*(5*h)+T*(5*f)+N*(5*l)+R*(5*u))>>>13,L&=8191;var D=B+I*u+S*c+O*s+P*a+x*o;B=D>>>13,D&=8191,B+=(D+=_*(5*p)+A*(5*d)+T*(5*h)+N*(5*f)+R*(5*l))>>>13,D&=8191;var q=B+I*l+S*u+O*c+P*s+x*a;B=q>>>13,q&=8191,B+=(q+=_*o+A*(5*p)+T*(5*d)+N*(5*h)+R*(5*f))>>>13,q&=8191;var M=B+I*f+S*l+O*u+P*c+x*s;B=M>>>13,M&=8191,B+=(M+=_*a+A*o+T*(5*p)+N*(5*d)+R*(5*h))>>>13,M&=8191;var z=B+I*h+S*f+O*l+P*u+x*c;B=z>>>13,z&=8191,B+=(z+=_*s+A*a+T*o+N*(5*p)+R*(5*d))>>>13,z&=8191;var H=B+I*d+S*h+O*f+P*l+x*u;B=H>>>13,H&=8191,B+=(H+=_*c+A*s+T*a+N*o+R*(5*p))>>>13,H&=8191;var V=B+I*p+S*d+O*h+P*f+x*l;B=V>>>13,V&=8191,B+=(V+=_*u+A*c+T*s+N*a+R*o)>>>13,V&=8191,C=8191&(B=(B=(B<<2)+B|0)+(C&=8191)|0),U+=B>>>=13,r[0]=C,r[1]=U,r[2]=j,r[3]=L,r[4]=D,r[5]=q,r[6]=M,r[7]=z,r[8]=H,r[9]=V}},{key:"finalize",value:function(){var e=this.h,t=this.pad,n=new Uint16Array(10),r=e[1]>>>13;e[1]&=8191;for(var i=2;i<10;i++)e[i]+=r,r=e[i]>>>13,e[i]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,n[0]=e[0]+5,r=n[0]>>>13,n[0]&=8191;for(var o=1;o<10;o++)n[o]=e[o]+r,r=n[o]>>>13,n[o]&=8191;n[9]-=8192;for(var a=(1^r)-1,s=0;s<10;s++)n[s]&=a;a=~a;for(var c=0;c<10;c++)e[c]=e[c]&a|n[c];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);var u=e[0]+t[0];e[0]=65535&u;for(var l=1;l<8;l++)u=(e[l]+t[l]|0)+(u>>>16)|0,e[l]=65535&u;yc(n)}},{key:"update",value:function(e){lc(this);for(var t=this.buffer,n=this.blockLen,r=(e=dc(e)).length,i=0;i<r;){var o=Math.min(n-this.pos,r-i);if(o!==n)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=r-i;i+=n)this.process(e,i)}return this}},{key:"destroy",value:function(){yc(this.h,this.r,this.buffer,this.pad)}},{key:"digestInto",value:function(e){lc(this),function(e,t){uc(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;var t=this.buffer,n=this.h,r=this.pos;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();for(var i=0,o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var n=e.slice(0,t);return this.destroy(),n}}])}();var Ac=function(e){var t=function(t,n){return e(n).update(dc(t)).digest()},n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(t){return e(t)},t}(function(e){return new _c(e)});var Tc=function(e,t){var n=function(e,t){if(null==t||"object"!=_(t))throw new Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t),r=n.allowShortKeys,i=n.extendNonceFn,o=n.counterLength,a=n.counterRight,s=n.rounds;if("function"!=typeof e)throw new Error("core must be a function");return sc(o),sc(s),fc(a),fc(r),function(t,n,c,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;uc(t),uc(n),uc(c);var f=c.length;if(void 0===u&&(u=new Uint8Array(f)),uc(u),sc(l),l<0||l>=Oc)throw new Error("arx: counter overflow");if(u.length<f)throw new Error("arx: output (".concat(u.length,") is shorter than data (").concat(f,")"));var h,d,p=[],v=t.length;if(32===v)p.push(h=gc(t)),d=kc;else{if(16!==v||!r)throw new Error("arx: invalid 32-byte key, got length=".concat(v));(h=new Uint8Array(32)).set(t),h.set(t,16),d=Ec,p.push(h)}Sc(n)||p.push(n=gc(n));var g=hc(h);if(i){if(24!==n.length)throw new Error("arx: extended nonce must be 24 bytes");i(d,g,hc(n.subarray(0,16)),g),n=n.subarray(16)}var y=16-o;if(y!==n.length)throw new Error("arx: nonce must be ".concat(y," or 16 bytes"));if(12!==y){var m=new Uint8Array(12);m.set(n,a?0:12-n.length),n=m,p.push(n)}var w=hc(n);return function(e,t,n,r,i,o,a,s){for(var c=i.length,u=new Uint8Array(64),l=hc(u),f=Sc(i)&&Sc(o),h=f?hc(i):Pc,d=f?hc(o):Pc,p=0;p<c;a++){if(e(t,n,r,l,a,s),a>=Oc)throw new Error("arx: counter overflow");var v=Math.min(64,c-p);if(f&&64===v){var g=p/4;if(p%4!=0)throw new Error("arx: invalid block position");for(var y,m=0;m<16;m++)d[y=g+m]=h[y]^l[m];p+=64}else{for(var w,b=0;b<v;b++)o[w=p+b]=i[w]^u[b];p+=v}}}(e,d,g,w,c,u,l,s),yc.apply(void 0,p),u}}(function(e,t,n,r,i){for(var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,a=e[0],s=e[1],c=e[2],u=e[3],l=t[0],f=t[1],h=t[2],d=t[3],p=t[4],v=t[5],g=t[6],y=t[7],m=i,w=n[0],b=n[1],E=n[2],k=a,I=s,S=c,O=u,P=l,x=f,_=h,A=d,T=p,N=v,R=g,B=y,C=m,U=w,j=b,L=E,D=0;D<o;D+=2)C=Ic(C^(k=k+P|0),16),P=Ic(P^(T=T+C|0),12),C=Ic(C^(k=k+P|0),8),P=Ic(P^(T=T+C|0),7),U=Ic(U^(I=I+x|0),16),x=Ic(x^(N=N+U|0),12),U=Ic(U^(I=I+x|0),8),x=Ic(x^(N=N+U|0),7),j=Ic(j^(S=S+_|0),16),_=Ic(_^(R=R+j|0),12),j=Ic(j^(S=S+_|0),8),_=Ic(_^(R=R+j|0),7),L=Ic(L^(O=O+A|0),16),A=Ic(A^(B=B+L|0),12),L=Ic(L^(O=O+A|0),8),A=Ic(A^(B=B+L|0),7),L=Ic(L^(k=k+x|0),16),x=Ic(x^(R=R+L|0),12),L=Ic(L^(k=k+x|0),8),x=Ic(x^(R=R+L|0),7),C=Ic(C^(I=I+_|0),16),_=Ic(_^(B=B+C|0),12),C=Ic(C^(I=I+_|0),8),_=Ic(_^(B=B+C|0),7),U=Ic(U^(S=S+A|0),16),A=Ic(A^(T=T+U|0),12),U=Ic(U^(S=S+A|0),8),A=Ic(A^(T=T+U|0),7),j=Ic(j^(O=O+P|0),16),P=Ic(P^(N=N+j|0),12),j=Ic(j^(O=O+P|0),8),P=Ic(P^(N=N+j|0),7);var q=0;r[q++]=a+k|0,r[q++]=s+I|0,r[q++]=c+S|0,r[q++]=u+O|0,r[q++]=l+P|0,r[q++]=f+x|0,r[q++]=h+_|0,r[q++]=d+A|0,r[q++]=p+T|0,r[q++]=v+N|0,r[q++]=g+R|0,r[q++]=y+B|0,r[q++]=m+C|0,r[q++]=w+U|0,r[q++]=b+j|0,r[q++]=E+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),Nc=new Uint8Array(16),Rc=function(e,t){e.update(t);var n=t.length%16;n&&e.update(Nc.subarray(n))},Bc=new Uint8Array(32);function Cc(e,t,n,r,i){var o=e(t,n,Bc),a=Ac.create(o);i&&Rc(a,i),Rc(a,r);var s=new Uint8Array(16),c=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}(s);vc(c,0,BigInt(i?i.length:0),!0),vc(c,8,BigInt(r.length),!0),a.update(s);var u=a.digest();return yc(o,s),u}var Uc=function(e,t){function n(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(uc(n),void 0!==e.nonceLength){var a=i[0];if(!a)throw new Error("nonce / iv required");e.varSizeNonce?uc(a):uc(a,e.nonceLength)}var s=e.tagLength;s&&void 0!==i[1]&&uc(i[1]);var c=t.apply(void 0,[n].concat(i)),u=function(e,t){if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");uc(t)}},l=!1;return{encrypt:function(e,t){if(l)throw new Error("cannot encrypt() twice with same key + nonce");return l=!0,uc(e),u(c.encrypt.length,t),c.encrypt(e,t)},decrypt:function(e,t){if(uc(e),s&&e.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return u(c.decrypt.length,t),c.decrypt(e,t)}}}return Object.assign(n,e),n}({blockSize:64,nonceLength:12,tagLength:16},function(e){return function(t,n,r){return{encrypt:function(i,o){var a=i.length;(o=pc(a+16,o,!1)).set(i);var s=o.subarray(0,-16);e(t,n,s,s,1);var c=Cc(e,t,n,s,r);return o.set(c,a),yc(c),o},decrypt:function(i,o){o=pc(i.length-16,o,!1);var a=i.subarray(0,-16),s=i.subarray(-16),c=Cc(e,t,n,a,r);if(!function(e,t){if(e.length!==t.length)return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}(s,c))throw new Error("invalid tag");return o.set(i.subarray(0,-16)),e(t,n,o,o,1),yc(c),o}}}}(Tc)),jc=function(e){function t(e,n){var r;S(this,t),(r=y(this,t)).finished=!1,r.destroyed=!1,Es(e);var i=Bs(n);if(r.iHash=e.create(),"function"!=typeof r.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");r.blockLen=r.iHash.blockLen,r.outputLen=r.iHash.outputLen;var o=r.blockLen,a=new Uint8Array(o);a.set(i.length>o?e.create().update(i).digest():i);for(var s=0;s<a.length;s++)a[s]^=54;r.iHash.update(a),r.oHash=e.create();for(var c=0;c<a.length;c++)a[c]^=106;return r.oHash.update(a),a.fill(0),r}return k(t,e),P(t,[{key:"update",value:function(e){return ks(this),this.iHash.update(e),this}},{key:"digestInto",value:function(e){ks(this),bs(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}},{key:"digest",value:function(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}},{key:"_cloneInto",value:function(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,n=this.iHash,r=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}])}(Us),Lc=function(e,t,n){return new jc(e,t).update(n).digest()};Lc.create=function(e,t){return new jc(e,t)};var Dc=new Uint8Array([0]),qc=new Uint8Array;var Mc=function(e,t,n,r,i){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;if(Es(e),ws(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");var i=Math.ceil(r/e.outputLen);void 0===n&&(n=qc);for(var o=new Uint8Array(i*e.outputLen),a=Lc.create(e,t),s=a._cloneInto(),c=new Uint8Array(a.outputLen),u=0;u<i;u++)Dc[0]=u+1,s.update(0===u?qc:c).update(n).update(Dc).digestInto(c),o.set(c,e.outputLen*u),a._cloneInto(s);return a.destroy(),s.destroy(),c.fill(0),Dc.fill(0),o.slice(0,r)}(e,function(e,t,n){return Es(e),void 0===n&&(n=new Uint8Array(e.outputLen)),Lc(e,Bs(n),Bs(t))}(e,t,n),r,i)};function zc(e,t,n){return e&t^~e&n}function Hc(e,t,n){return e&t^e&n^t&n}var Vc=function(e){function t(e,n,r,i){var o;return S(this,t),(o=y(this,t)).blockLen=e,o.outputLen=n,o.padOffset=r,o.isLE=i,o.finished=!1,o.length=0,o.pos=0,o.destroyed=!1,o.buffer=new Uint8Array(e),o.view=_s(o.buffer),o}return k(t,e),P(t,[{key:"update",value:function(e){ks(this);for(var t=this.view,n=this.buffer,r=this.blockLen,i=(e=Bs(e)).length,o=0;o<i;){var a=Math.min(r-this.pos,i-o);if(a!==r)n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===r&&(this.process(t,0),this.pos=0);else for(var s=_s(e);r<=i-o;o+=r)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){ks(this),Is(e,this),this.finished=!0;var t=this.buffer,n=this.view,r=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(var a=o;a<r;a++)t[a]=0;(function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),s=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+u,s,r)})(n,r-8,BigInt(8*this.length),i),this.process(n,0);var s=_s(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(var f=0;f<u;f++)s.setUint32(4*f,l[f],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var n=e.slice(0,t);return this.destroy(),n}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,l(this.get()));var n=this.blockLen,r=this.buffer,i=this.length,o=this.finished,a=this.destroyed,s=this.pos;return e.length=i,e.pos=s,e.finished=o,e.destroyed=a,i%n&&e.buffer.set(r),e}}])}(Us),Fc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Kc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Wc=new Uint32Array(64),Gc=function(e){function t(){var e;return S(this,t),(e=y(this,t,[64,32,8,!1])).A=0|Kc[0],e.B=0|Kc[1],e.C=0|Kc[2],e.D=0|Kc[3],e.E=0|Kc[4],e.F=0|Kc[5],e.G=0|Kc[6],e.H=0|Kc[7],e}return k(t,e),P(t,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(e,t,n,r,i,o,a,s){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|s}},{key:"process",value:function(e,t){for(var n=0;n<16;n++,t+=4)Wc[n]=e.getUint32(t,!1);for(var r=16;r<64;r++){var i=Wc[r-15],o=Wc[r-2],a=As(i,7)^As(i,18)^i>>>3,s=As(o,17)^As(o,19)^o>>>10;Wc[r]=s+Wc[r-7]+a+Wc[r-16]|0}for(var c=this.A,u=this.B,l=this.C,f=this.D,h=this.E,d=this.F,p=this.G,v=this.H,g=0;g<64;g++){var y=v+(As(h,6)^As(h,11)^As(h,25))+zc(h,d,p)+Fc[g]+Wc[g]|0,m=(As(c,2)^As(c,13)^As(c,22))+Hc(c,u,l)|0;v=p,p=d,d=h,h=f+y|0,f=l,l=u,u=c,c=y+m|0}c=c+this.A|0,u=u+this.B|0,l=l+this.C|0,f=f+this.D|0,h=h+this.E|0,d=d+this.F|0,p=p+this.G|0,v=v+this.H|0,this.set(c,u,l,f,h,d,p,v)}},{key:"roundClean",value:function(){Wc.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}])}(Vc),Zc=js(function(){return new Gc}),Yc=BigInt(0),Jc=BigInt(1),Qc=BigInt(2);function Xc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function $c(e){if(!Xc(e))throw new Error("Uint8Array expected")}function eu(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}var tu=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function nu(e){$c(e);for(var t="",n=0;n<e.length;n++)t+=tu[e[n]];return t}function ru(e){var t=e.toString(16);return 1&t.length?"0"+t:t}function iu(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));return""===e?Yc:BigInt("0x"+e)}var ou=48,au=57,su=65,cu=70,uu=97,lu=102;function fu(e){return e>=ou&&e<=au?e-ou:e>=su&&e<=cu?e-(su-10):e>=uu&&e<=lu?e-(uu-10):void 0}function hu(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));var t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var r=new Uint8Array(n),i=0,o=0;i<n;i++,o+=2){var a=fu(e.charCodeAt(o)),s=fu(e.charCodeAt(o+1));if(void 0===a||void 0===s){var c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}r[i]=16*a+s}return r}function du(e){return iu(nu(e))}function pu(e){return $c(e),iu(nu(Uint8Array.from(e).reverse()))}function vu(e,t){return hu(e.toString(16).padStart(2*t,"0"))}function gu(e,t){return vu(e,t).reverse()}function yu(e,t,n){var r;if("string"==typeof t)try{r=hu(t)}catch(jt){throw new Error(e+" must be hex string or Uint8Array, cause: "+jt)}else{if(!Xc(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}var i=r.length;if("number"==typeof n&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function mu(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];$c(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r}var wu=function(e){return"bigint"==typeof e&&Yc<=e};function bu(e,t,n){return wu(e)&&wu(t)&&wu(n)&&t<=e&&e<n}function Eu(e,t,n,r){if(!bu(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function ku(e){var t;for(t=0;e>Yc;e>>=Jc,t+=1);return t}var Iu=function(e){return(Qc<<BigInt(e-1))-Jc},Su=function(e){return new Uint8Array(e)},Ou=function(e){return Uint8Array.from(e)};function Pu(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");var r=Su(e),i=Su(e),o=0,a=function(){r.fill(1),i.fill(0),o=0},s=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.apply(void 0,[i,r].concat(t))},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Su();i=s(Ou([0]),e),r=s(),0!==e.length&&(i=s(Ou([1]),e),r=s())},u=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var e=0,n=[];e<t;){var i=(r=s()).slice();n.push(i),e+=r.length}return mu.apply(void 0,n)};return function(e,t){var n;for(a(),c(e);!(n=t(u()));)c();return a(),n}}var xu={bigint:function(e){return"bigint"==typeof e},function:function(e){return"function"==typeof e},boolean:function(e){return"boolean"==typeof e},string:function(e){return"string"==typeof e},stringOrUint8Array:function(e){return"string"==typeof e||Xc(e)},isSafeInteger:function(e){return Number.isSafeInteger(e)},array:function(e){return Array.isArray(e)},field:function(e,t){return t.Fp.isValid(e)},hash:function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)}};function _u(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=function(t,n,r){var i=xu[n];if("function"!=typeof i)throw new Error("invalid validator function");var o=e[t];if(!(r&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)},o=0,a=Object.entries(t);o<a.length;o++){var s=r(a[o],2);i(s[0],s[1],!1)}for(var c=0,u=Object.entries(n);c<u.length;c++){var l=r(u[c],2);i(l[0],l[1],!0)}return e}function Au(e){var t=new WeakMap;return function(n){var r=t.get(n);if(void 0!==r)return r;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.apply(void 0,[n].concat(o));return t.set(n,s),s}}var Tu=Object.freeze({__proto__:null,isBytes:Xc,abytes:$c,abool:eu,bytesToHex:nu,numberToHexUnpadded:ru,hexToNumber:iu,hexToBytes:hu,bytesToNumberBE:du,bytesToNumberLE:pu,numberToBytesBE:vu,numberToBytesLE:gu,numberToVarBytesBE:function(e){return hu(ru(e))},ensureBytes:yu,concatBytes:mu,equalBytes:function(e,t){if(e.length!==t.length)return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))},inRange:bu,aInRange:Eu,bitLen:ku,bitGet:function(e,t){return e>>BigInt(t)&Jc},bitSet:function(e,t,n){return e|(n?Jc:Yc)<<BigInt(t)},bitMask:Iu,createHmacDrbg:Pu,validateObject:_u,notImplemented:function(){throw new Error("not implemented")},memoized:Au}),Nu=BigInt(0),Ru=BigInt(1),Bu=BigInt(2),Cu=BigInt(3),Uu=BigInt(4),ju=BigInt(5),Lu=BigInt(8);function Du(e,t){var n=e%t;return n>=Nu?n:t+n}function qu(e,t,n){if(t<Nu)throw new Error("invalid exponent, negatives unsupported");if(n<=Nu)throw new Error("invalid modulus");if(n===Ru)return Nu;for(var r=Ru;t>Nu;)t&Ru&&(r=r*e%n),e=e*e%n,t>>=Ru;return r}function Mu(e,t,n){for(var r=e;t-- >Nu;)r*=r,r%=n;return r}function zu(e,t){if(e===Nu)throw new Error("invert: expected non-zero number");if(t<=Nu)throw new Error("invert: expected positive modulus, got "+t);for(var n=Du(e,t),r=t,i=Nu,o=Ru;n!==Nu;){var a=r%n,s=i-o*(r/n);r=n,n=a,i=o,o=s}if(r!==Ru)throw new Error("invert: does not exist");return Du(i,t)}function Hu(e){if(e%Uu===Cu){var t=(e+Ru)/Uu;return function(e,n){var r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%Lu===ju){var n=(e-ju)/Lu;return function(e,t){var r=e.mul(t,Bu),i=e.pow(r,n),o=e.mul(t,i),a=e.mul(e.mul(o,Bu),i),s=e.mul(o,e.sub(a,e.ONE));if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}}return function(e){var t,n,r,i=(e-Ru)/Bu;for(t=e-Ru,n=0;t%Bu===Nu;t/=Bu,n++);for(r=Bu;r<e&&qu(r,i,e)!==e-Ru;r++)if(r>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){var o=(e+Ru)/Uu;return function(e,t){var n=e.pow(t,o);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}}var a=(t+Ru)/Bu;return function(e,o){if(e.pow(o,i)===e.neg(e.ONE))throw new Error("Cannot find square root");for(var s=n,c=e.pow(e.mul(e.ONE,r),t),u=e.pow(o,a),l=e.pow(o,t);!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;for(var f=1,h=e.sqr(l);f<s&&!e.eql(h,e.ONE);f++)h=e.sqr(h);var d=e.pow(c,Ru<<BigInt(s-f-1));c=e.sqr(d),u=e.mul(u,d),l=e.mul(l,c),s=f}return u}}(e)}var Vu=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Fu(e,t){var n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Ku(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=Nu)throw new Error("invalid field: expected ORDER > 0, got "+e);var i,o=Fu(e,t),a=o.nBitLength,s=o.nByteLength;if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var c=Object.freeze({ORDER:e,isLE:n,BITS:a,BYTES:s,MASK:Iu(a),ZERO:Nu,ONE:Ru,create:function(t){return Du(t,e)},isValid:function(t){if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+_(t));return Nu<=t&&t<e},is0:function(e){return e===Nu},isOdd:function(e){return(e&Ru)===Ru},neg:function(t){return Du(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return Du(t*t,e)},add:function(t,n){return Du(t+n,e)},sub:function(t,n){return Du(t-n,e)},mul:function(t,n){return Du(t*n,e)},pow:function(e,t){return function(e,t,n){if(n<Nu)throw new Error("invalid exponent, negatives unsupported");if(n===Nu)return e.ONE;if(n===Ru)return t;for(var r=e.ONE,i=t;n>Nu;)n&Ru&&(r=e.mul(r,i)),i=e.sqr(i),n>>=Ru;return r}(c,e,t)},div:function(t,n){return Du(t*zu(n,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return zu(t,e)},sqrt:r.sqrt||function(t){return i||(i=Hu(e)),i(c,t)},invertBatch:function(e){return function(e,t){var n=new Array(t.length),r=t.reduce(function(t,r,i){return e.is0(r)?t:(n[i]=t,e.mul(t,r))},e.ONE),i=e.inv(r);return t.reduceRight(function(t,r,i){return e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))},i),n}(c,e)},cmov:function(e,t,n){return n?t:e},toBytes:function(e){return n?gu(e,s):vu(e,s)},fromBytes:function(e){if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return n?pu(e):du(e)}});return Object.freeze(c)}function Wu(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");var t=e.toString(2).length;return Math.ceil(t/8)}function Gu(e){var t=Wu(e);return t+Math.ceil(t/2)}var Zu=BigInt(0),Yu=BigInt(1);function Ju(e,t){var n=t.negate();return e?n:t}function Qu(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Xu(e,t){return Qu(e,t),{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1)}}var $u=new WeakMap,el=new WeakMap;function tl(e){return el.get(e)||1}function nl(e,t,n,r){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(function(e,n){if(!(e instanceof t))throw new Error("invalid point at index "+n)})}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(function(e,n){if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");for(var i=e.ZERO,o=ku(BigInt(n.length)),a=o>12?o-3:o>4?o-2:o?2:1,s=(1<<a)-1,c=new Array(s+1).fill(i),u=i,l=Math.floor((t.BITS-1)/a)*a;l>=0;l-=a){c.fill(i);for(var f=0;f<r.length;f++){var h=r[f],d=Number(h>>BigInt(l)&BigInt(s));c[d]=c[d].add(n[f])}for(var p=i,v=c.length-1,g=i;v>0;v--)g=g.add(c[v]),p=p.add(g);if(u=u.add(p),0!==l)for(var y=0;y<a;y++)u=u.double()}return u}function rl(e){return function(e){var t=Vu.reduce(function(e,t){return e[t]="function",e},{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});_u(e,t)}(e.Fp),_u(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(a(a(a({},Fu(e.n,e.nBitLength)),e),{},{p:e.Fp.ORDER}))}BigInt(0),BigInt(1),BigInt(2),BigInt(8);var il=BigInt(0),ol=BigInt(1);var al=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);var sl=BigInt(1),cl=BigInt(2),ul=BigInt(3),ll=BigInt(5);BigInt(8);var fl=function(e){var t=function(e){return _u(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(a({},e))}(e),n=t.P,r=function(e){return Du(e,n)},i=t.montgomeryBits,o=Math.ceil(i/8),s=t.nByteLength,c=t.adjustScalarBytes||function(e){return e},u=t.powPminus2||function(e){return qu(e,n-BigInt(2),n)};function l(e,t,n){var i=r(e*(t-n));return[t=r(t-i),n=r(n+i)]}var f=(t.a-BigInt(2))/BigInt(4);function h(e){return gu(r(e),o)}function d(e,t){var a=function(e){var t=yu("u coordinate",e,o);return 32===s&&(t[31]&=127),pu(t)}(t),d=function(e){var t=yu("scalar",e),n=t.length;if(n!==o&&n!==s)throw new Error("invalid scalar, expected "+o+" or "+s+" bytes, got "+n);return pu(c(t))}(e),p=function(e,t){Eu("u",e,il,n),Eu("scalar",t,il,n);for(var o,a=t,s=e,c=ol,h=il,d=e,p=ol,v=il,g=BigInt(i-1);g>=il;g--){var y=a>>g&ol;c=(o=l(v^=y,c,d))[0],d=o[1],h=(o=l(v,h,p))[0],p=o[1],v=y;var m=c+h,w=r(m*m),b=c-h,E=r(b*b),k=w-E,I=d+p,S=r((d-p)*m),O=r(I*b),P=S+O,x=S-O;d=r(P*P),p=r(s*r(x*x)),c=r(w*E),h=r(k*(w+r(f*k)))}c=(o=l(v,c,d))[0],d=o[1],h=(o=l(v,h,p))[0],p=o[1];var _=u(h);return r(c*_)}(a,d);if(p===il)throw new Error("invalid private or public key received");return h(p)}var p=h(t.Gu);function v(e){return d(e,p)}return{scalarMult:d,scalarMultBase:v,getSharedSecret:function(e,t){return d(e,t)},getPublicKey:function(e){return v(e)},utils:{randomPrivateKey:function(){return t.randomBytes(t.nByteLength)}},GuBytes:p}}({P:al,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:function(e){var t=al,n=function(e){var t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),o=al,a=e*e%o*e%o,s=Mu(a,cl,o)*a%o,c=Mu(s,sl,o)*e%o,u=Mu(c,ll,o)*c%o,l=Mu(u,t,o)*u%o,f=Mu(l,n,o)*l%o,h=Mu(f,r,o)*f%o,d=Mu(h,i,o)*h%o,p=Mu(d,i,o)*h%o,v=Mu(p,t,o)*u%o;return{pow_p_5_8:Mu(v,cl,o)*e%o,b2:a}}(e),r=n.pow_p_5_8,i=n.b2;return Du(Mu(r,ul,t)*i,t)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:Ls});function hl(e){void 0!==e.lowS&&eu("lowS",e.lowS),void 0!==e.prehash&&eu("prehash",e.prehash)}var dl=Tu.bytesToNumberBE,pl=Tu.hexToBytes,vl=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return S(this,t),y(this,t,[e])}return k(t,e),P(t)}(n(Error)),gl={Err:vl,_tlv:{encode:function(e,t){var n=gl.Err;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");var r=t.length/2,i=ru(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");var o=r>127?ru(i.length/2|128):"";return ru(e)+o+i+t},decode:function(e,t){var n=gl.Err,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");var i=t[r++],o=0;if(!!(128&i)){var a=127&i;if(!a)throw new n("tlv.decode(long): indefinite length not supported");if(a>4)throw new n("tlv.decode(long): byte length is too big");var s=t.subarray(r,r+a);if(s.length!==a)throw new n("tlv.decode: length bytes not complete");if(0===s[0])throw new n("tlv.decode(long): zero leftmost byte");var c,l=u(s);try{for(l.s();!(c=l.n()).done;){o=o<<8|c.value}}catch(h){l.e(h)}finally{l.f()}if(r+=a,o<128)throw new n("tlv.decode(long): not minimal encoding")}else o=i;var f=t.subarray(r,r+o);if(f.length!==o)throw new n("tlv.decode: wrong value length");return{v:f,l:t.subarray(r+o)}}},_int:{encode:function(e){var t=gl.Err;if(e<yl)throw new t("integer: negative integers are not allowed");var n=ru(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode:function(e){var t=gl.Err;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return dl(e)}},toSig:function(e){var t=gl.Err,n=gl._int,r=gl._tlv,i="string"==typeof e?pl(e):e;$c(i);var o=r.decode(48,i),a=o.v;if(o.l.length)throw new t("invalid signature: left bytes after parsing");var s=r.decode(2,a),c=s.v,u=s.l,l=r.decode(2,u),f=l.v;if(l.l.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(f)}},hexFromSig:function(e){var t=gl._tlv,n=gl._int,r=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,r)}},yl=BigInt(0),ml=BigInt(1);BigInt(2);var wl=BigInt(3);function bl(e){var t=function(e){var t=rl(e);_u(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var n=t.endo,r=t.Fp,i=t.a;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=_(n)||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze(a({},t))}(e),n=t.Fp,r=Ku(t.n,t.nBitLength),i=t.toBytes||function(e,t,r){var i=t.toAffine();return mu(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))},o=t.fromBytes||function(e){var t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}};function s(e){var r=t.a,i=t.b,o=n.sqr(e),a=n.mul(o,e);return n.add(n.add(a,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function c(e){var n,r=t.allowedPrivateKeyLengths,i=t.nByteLength,o=t.wrapPrivateKey,a=t.n;if(r&&"bigint"!=typeof e){if(Xc(e)&&(e=nu(e)),"string"!=typeof e||!r.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*i,"0")}try{n="bigint"==typeof e?e:du(yu("private key",e,i))}catch(s){throw new Error("invalid private key, expected hex or "+i+" bytes, got "+_(e))}return o&&(n=Du(n,a)),Eu("private key",n,ml,a),n}function u(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}var l=Au(function(e,t){var r=e.px,i=e.py,o=e.pz;if(n.eql(o,n.ONE))return{x:r,y:i};var a=e.is0();null==t&&(t=a?n.ONE:n.inv(o));var s=n.mul(r,t),c=n.mul(i,t),u=n.mul(o,t);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:s,y:c}}),f=Au(function(e){if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}var r=e.toAffine(),i=r.x,o=r.y;if(!n.isValid(i)||!n.isValid(o))throw new Error("bad point: x or y not FE");var a=n.sqr(o),c=s(i);if(!n.eql(a,c))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}),h=function(){function e(t,r,i){if(S(this,e),this.px=t,this.py=r,this.pz=i,null==t||!n.isValid(t))throw new Error("x required");if(null==r||!n.isValid(r))throw new Error("y required");if(null==i||!n.isValid(i))throw new Error("z required");Object.freeze(this)}return P(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){p.setWindowSize(this,e)}},{key:"assertValidity",value:function(){f(this)}},{key:"hasEvenY",value:function(){var e=this.toAffine().y;if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(e){u(e);var t=this.px,r=this.py,i=this.pz,o=e.px,a=e.py,s=e.pz,c=n.eql(n.mul(t,s),n.mul(o,i)),l=n.eql(n.mul(r,s),n.mul(a,i));return c&&l}},{key:"negate",value:function(){return new e(this.px,n.neg(this.py),this.pz)}},{key:"double",value:function(){var r=t.a,i=t.b,o=n.mul(i,wl),a=this.px,s=this.py,c=this.pz,u=n.ZERO,l=n.ZERO,f=n.ZERO,h=n.mul(a,a),d=n.mul(s,s),p=n.mul(c,c),v=n.mul(a,s);return v=n.add(v,v),f=n.mul(a,c),f=n.add(f,f),u=n.mul(r,f),l=n.mul(o,p),l=n.add(u,l),u=n.sub(d,l),l=n.add(d,l),l=n.mul(u,l),u=n.mul(v,u),f=n.mul(o,f),p=n.mul(r,p),v=n.sub(h,p),v=n.mul(r,v),v=n.add(v,f),f=n.add(h,h),h=n.add(f,h),h=n.add(h,p),h=n.mul(h,v),l=n.add(l,h),p=n.mul(s,c),p=n.add(p,p),h=n.mul(p,v),u=n.sub(u,h),f=n.mul(p,d),f=n.add(f,f),new e(u,l,f=n.add(f,f))}},{key:"add",value:function(r){u(r);var i=this.px,o=this.py,a=this.pz,s=r.px,c=r.py,l=r.pz,f=n.ZERO,h=n.ZERO,d=n.ZERO,p=t.a,v=n.mul(t.b,wl),g=n.mul(i,s),y=n.mul(o,c),m=n.mul(a,l),w=n.add(i,o),b=n.add(s,c);w=n.mul(w,b),b=n.add(g,y),w=n.sub(w,b),b=n.add(i,a);var E=n.add(s,l);return b=n.mul(b,E),E=n.add(g,m),b=n.sub(b,E),E=n.add(o,a),f=n.add(c,l),E=n.mul(E,f),f=n.add(y,m),E=n.sub(E,f),d=n.mul(p,b),f=n.mul(v,m),d=n.add(f,d),f=n.sub(y,d),d=n.add(y,d),h=n.mul(f,d),y=n.add(g,g),y=n.add(y,g),m=n.mul(p,m),b=n.mul(v,b),y=n.add(y,m),m=n.sub(g,m),m=n.mul(p,m),b=n.add(b,m),g=n.mul(y,b),h=n.add(h,g),g=n.mul(E,b),f=n.mul(w,f),f=n.sub(f,g),g=n.mul(w,y),d=n.mul(E,d),new e(f,h,d=n.add(d,g))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"wNAF",value:function(t){return p.wNAFCached(this,t,e.normalizeZ)}},{key:"multiplyUnsafe",value:function(r){var i=t.endo,o=t.n;Eu("scalar",r,yl,o);var a=e.ZERO;if(r===yl)return a;if(this.is0()||r===ml)return this;if(!i||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,r,e.normalizeZ);for(var s=i.splitScalar(r),c=s.k1neg,u=s.k1,l=s.k2neg,f=s.k2,h=a,d=a,v=this;u>yl||f>yl;)u&ml&&(h=h.add(v)),f&ml&&(d=d.add(v)),v=v.double(),u>>=ml,f>>=ml;return c&&(h=h.negate()),l&&(d=d.negate()),d=new e(n.mul(d.px,i.beta),d.py,d.pz),h.add(d)}},{key:"multiply",value:function(r){var i,o,a=t.endo,s=t.n;if(Eu("scalar",r,ml,s),a){var c=a.splitScalar(r),u=c.k1neg,l=c.k1,f=c.k2neg,h=c.k2,d=this.wNAF(l),v=d.p,g=d.f,y=this.wNAF(h),m=y.p,w=y.f;v=p.constTimeNegate(u,v),m=p.constTimeNegate(f,m),m=new e(n.mul(m.px,a.beta),m.py,m.pz),i=v.add(m),o=g.add(w)}else{var b=this.wNAF(r);i=b.p,o=b.f}return e.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(t,n,r){var i=e.BASE,o=function(e,t){return t!==yl&&t!==ml&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t)},a=o(this,n).add(o(t,r));return a.is0()?void 0:a}},{key:"toAffine",value:function(e){return l(this,e)}},{key:"isTorsionFree",value:function(){var n=t.h,r=t.isTorsionFree;if(n===ml)return!0;if(r)return r(e,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var n=t.h,r=t.clearCofactor;return n===ml?this:r?r(e,this):this.multiplyUnsafe(t.h)}},{key:"toRawBytes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return eu("isCompressed",t),this.assertValidity(),i(e,this,t)}},{key:"toHex",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return eu("isCompressed",e),nu(this.toRawBytes(e))}}],[{key:"fromAffine",value:function(t){var r=t||{},i=r.x,o=r.y;if(!t||!n.isValid(i)||!n.isValid(o))throw new Error("invalid affine point");if(t instanceof e)throw new Error("projective point not allowed");var a=function(e){return n.eql(e,n.ZERO)};return a(i)&&a(o)?e.ZERO:new e(i,o,n.ONE)}},{key:"normalizeZ",value:function(t){var r=n.invertBatch(t.map(function(e){return e.pz}));return t.map(function(e,t){return e.toAffine(r[t])}).map(e.fromAffine)}},{key:"fromHex",value:function(t){var n=e.fromAffine(o(yu("pointHex",t)));return n.assertValidity(),n}},{key:"fromPrivateKey",value:function(t){return e.BASE.multiply(c(t))}},{key:"msm",value:function(t,n){return nl(e,r,t,n)}}])}();h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);var d=t.nBitLength,p=function(e,t){return{constTimeNegate:Ju,hasPrecomputes:function(e){return 1!==tl(e)},unsafeLadder:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,i=t;n>Zu;)n&Yu&&(r=r.add(i)),i=i.double(),n>>=Yu;return r},precomputeWindow:function(e,n){for(var r=Xu(n,t),i=r.windows,o=r.windowSize,a=[],s=e,c=s,u=0;u<i;u++){c=s,a.push(c);for(var l=1;l<o;l++)c=c.add(s),a.push(c);s=c.double()}return a},wNAF:function(n,r,i){for(var o=Xu(n,t),a=o.windows,s=o.windowSize,c=e.ZERO,u=e.BASE,l=BigInt(Math.pow(2,n)-1),f=Math.pow(2,n),h=BigInt(n),d=0;d<a;d++){var p=d*s,v=Number(i&l);i>>=h,v>s&&(v-=f,i+=Yu);var g=p,y=p+Math.abs(v)-1,m=d%2!=0,w=v<0;0===v?u=u.add(Ju(m,r[g])):c=c.add(Ju(w,r[y]))}return{p:c,f:u}},wNAFUnsafe:function(n,r,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO,a=Xu(n,t),s=a.windows,c=a.windowSize,u=BigInt(Math.pow(2,n)-1),l=Math.pow(2,n),f=BigInt(n),h=0;h<s;h++){var d=h*c;if(i===Zu)break;var p=Number(i&u);if(i>>=f,p>c&&(p-=l,i+=Yu),0!==p){var v=r[d+Math.abs(p)-1];p<0&&(v=v.negate()),o=o.add(v)}}return o},getPrecomputes:function(e,t,n){var r=$u.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&$u.set(t,n(r))),r},wNAFCached:function(e,t,n){var r=tl(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe:function(e,t,n,r){var i=tl(e);return 1===i?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize:function(e,n){Qu(n,t),el.set(e,n),$u.delete(e)}}}(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:function(e){return bu(e,ml,t.n)}}}function El(e){var t=function(e){var t=rl(e);return _u(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(a({lowS:!0},t))}(e),n=t.Fp,r=t.n,i=n.BYTES+1,o=2*n.BYTES+1;function s(e){return Du(e,r)}function c(e){return zu(e,r)}var u=bl(a(a({},t),{},{toBytes:function(e,t,r){var i=t.toAffine(),o=n.toBytes(i.x),a=mu;return eu("isCompressed",r),r?a(Uint8Array.from([t.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes:function(e){var t=e.length,r=e[0],a=e.subarray(1);if(t!==i||2!==r&&3!==r){if(t===o&&4===r)return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))};throw new Error("invalid Point, expected length of "+i+", or uncompressed "+o+", got "+t)}var s=du(a);if(!bu(s,ml,n.ORDER))throw new Error("Point is not on curve");var c,u=h(s);try{c=n.sqrt(u)}catch(YA){var l=YA instanceof Error?": "+YA.message:"";throw new Error("Point is not on curve"+l)}return!(1&~r)!==((c&ml)===ml)&&(c=n.neg(c)),{x:s,y:c}}})),l=u.ProjectivePoint,f=u.normPrivateKeyToScalar,h=u.weierstrassEquation,d=u.isWithinCurveOrder,p=function(e){return nu(vu(e,t.nByteLength))};function v(e){return e>r>>ml}var g=function(e,t,n){return du(e.slice(t,n))},y=function(){function e(t,n,r){S(this,e),this.r=t,this.s=n,this.recovery=r,this.assertValidity()}return P(e,[{key:"assertValidity",value:function(){Eu("r",this.r,ml,r),Eu("s",this.s,ml,r)}},{key:"addRecoveryBit",value:function(t){return new e(this.r,this.s,t)}},{key:"recoverPublicKey",value:function(e){var r=this.r,i=this.s,o=this.recovery,a=E(yu("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var u=2===o||3===o?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=1&o?"03":"02",h=l.fromHex(f+p(u)),d=c(u),v=s(-a*d),g=s(i*d),y=l.BASE.multiplyAndAddUnsafe(h,v,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}},{key:"hasHighS",value:function(){return v(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return hu(this.toDERHex())}},{key:"toDERHex",value:function(){return gl.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return hu(this.toCompactHex())}},{key:"toCompactHex",value:function(){return p(this.r)+p(this.s)}}],[{key:"fromCompact",value:function(n){var r=t.nByteLength;return n=yu("compactSignature",n,2*r),new e(g(n,0,r),g(n,r,2*r))}},{key:"fromDER",value:function(t){var n=gl.toSig(yu("DER",t));return new e(n.r,n.s)}}])}(),m={isValidPrivateKey:function(e){try{return f(e),!0}catch(t){return!1}},normPrivateKeyToScalar:f,randomPrivateKey:function(){var e=Gu(t.n);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.length,i=Wu(t),o=Gu(t);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);var a=Du(n?pu(e):du(e),t-Ru)+Ru;return n?gu(a,i):vu(a,i)}(t.randomBytes(e),t.n)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function w(e){var t=Xc(e),n="string"==typeof e,r=(t||n)&&e.length;return t?r===i||r===o:n?r===2*i||r===2*o:e instanceof l}var b=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");var n=du(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},E=t.bits2int_modN||function(e){return s(b(e))},k=Iu(t.nBitLength);function I(e){return Eu("num < 2^"+t.nBitLength,e,yl,k),vu(e,t.nByteLength)}function O(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x;if(["recovered","canonical"].some(function(e){return e in i}))throw new Error("sign() legacy options not supported");var o=t.hash,a=t.randomBytes,u=i.lowS,h=i.prehash,p=i.extraEntropy;null==u&&(u=!0),e=yu("msgHash",e),hl(i),h&&(e=yu("prehashed msgHash",o(e)));var g=E(e),m=f(r),w=[I(m),I(g)];if(null!=p&&!1!==p){var k=!0===p?a(n.BYTES):p;w.push(yu("extraEntropy",k))}var S=mu.apply(void 0,w),O=g;return{seed:S,k2sig:function(e){var t=b(e);if(d(t)){var n=c(t),r=l.BASE.multiply(t).toAffine(),i=s(r.x);if(i!==yl){var o=s(n*s(O+i*m));if(o!==yl){var a=(r.x===i?0:2)|Number(r.y&ml),f=o;return u&&v(o)&&(f=function(e){return v(e)?s(-e):e}(o),a^=1),new y(i,f,a)}}}}}}var x={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(w(e))throw new Error("first arg must be private key");if(!w(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(f(e)).toRawBytes(n)},sign:function(e,n){var r=O(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:x),i=r.seed,o=r.k2sig,a=t;return Pu(a.hash.outputLen,a.nByteLength,a.hmac)(i,o)},verify:function(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A,a=e;n=yu("msgHash",n),r=yu("publicKey",r);var u=o.lowS,f=o.prehash,h=o.format;if(hl(o),"strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw new Error("format must be compact or der");var d,p,v="string"==typeof a||Xc(a),g=!v&&!h&&"object"==_(a)&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!v&&!g)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(g&&(d=new y(a.r,a.s)),v){try{"compact"!==h&&(d=y.fromDER(a))}catch(Vx){if(!(Vx instanceof gl.Err))throw Vx}!d&&"der"!==h&&(d=y.fromCompact(a))}p=l.fromHex(r)}catch(x){return!1}if(!d||u&&d.hasHighS())return!1;f&&(n=t.hash(n));var m=d,w=m.r,b=m.s,k=E(n),I=c(b),S=s(k*I),O=s(w*I),P=null===(i=l.BASE.multiplyAndAddUnsafe(p,S,O))||void 0===i?void 0:i.toAffine();return!!P&&s(P.x)===w},ProjectivePoint:l,Signature:y,utils:m}}function kl(e){return{hash:e,hmac:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Lc(e,t,Cs.apply(void 0,r))},randomBytes:Ls}}BigInt(4);var Il=Ku(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Sl=function(e,t){var n=function(t){return El(a(a({},e),kl(t)))};return a(a({},n(t)),{},{create:n})}({a:Il.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:Il,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Zc),Ol="base10",Pl="base16",xl="base64pad",_l="base64url",Al="utf8";function Tl(){return Ka(Ls(32),Pl)}function Nl(e){return Ka(Zc(Fa(e,Pl)),Pl)}function Rl(e){return Ka(Zc(Fa(e,Al)),Pl)}function Bl(e){return Fa("".concat(e),Ol)}function Cl(e){return Number(Ka(e,Ol))}function Ul(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function jl(e){var t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return t+"=".repeat(n)}function Ll(e){var t=Bl(_(e.type)<"u"?e.type:0);if(1===Cl(t)&&_(e.senderPublicKey)>"u")throw new Error("Missing sender public key for type 1 envelope");var n=_(e.senderPublicKey)<"u"?Fa(e.senderPublicKey,Pl):void 0,r=_(e.iv)<"u"?Fa(e.iv,Pl):Ls(12),i=Fa(e.symKey,Pl),o=zl({type:t,sealed:Uc(i,r).encrypt(Fa(e.message,Al)),iv:r,senderPublicKey:n});return e.encoding===_l?Ul(o):o}function Dl(e){var t=Fa(e.symKey,Pl),n=Hl({encoded:e.encoded,encoding:e.encoding}),r=n.sealed,i=n.iv,o=Uc(t,i).decrypt(r);if(null===o)throw new Error("Failed to decrypt");return Ka(o,Al)}function ql(e,t){var n=Bl(2),r=Ls(12),i=zl({type:n,sealed:Fa(e,Al),iv:r});return t===_l?Ul(i):i}function Ml(e,t){return Ka(Hl({encoded:e,encoding:t}).sealed,Al)}function zl(e){if(2===Cl(e.type))return Ka(Ko([e.type,e.sealed]),xl);if(1===Cl(e.type)){if(_(e.senderPublicKey)>"u")throw new Error("Missing sender public key for type 1 envelope");return Ka(Ko([e.type,e.senderPublicKey,e.iv,e.sealed]),xl)}return Ka(Ko([e.type,e.iv,e.sealed]),xl)}function Hl(e){var t=Fa((e.encoding||xl)===_l?jl(e.encoded):e.encoded,xl),n=t.slice(0,1);if(1===Cl(n)){var r=t.slice(1,33),i=t.slice(33,45);return{type:n,sealed:t.slice(45),iv:i,senderPublicKey:r}}if(2===Cl(n))return{type:n,sealed:t.slice(1),iv:Ls(12)};var o=t.slice(1,13);return{type:n,sealed:t.slice(13),iv:o}}function Vl(e,t){var n=Hl({encoded:e,encoding:null==t?void 0:t.encoding});return Fl({type:Cl(n.type),senderPublicKey:_(n.senderPublicKey)<"u"?Ka(n.senderPublicKey,Pl):void 0,receiverPublicKey:null==t?void 0:t.receiverPublicKey})}function Fl(e){var t=(null==e?void 0:e.type)||0;if(1===t){if(_(null==e?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(_(null==e?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:null==e?void 0:e.senderPublicKey,receiverPublicKey:null==e?void 0:e.receiverPublicKey}}function Kl(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function Wl(e){return 2===e.type}function Gl(e,t){var n=r(e.split("."),3),i=n[0],o=n[1],a=n[2],s=Buffer.from(jl(a),"base64");if(64!==s.length)throw new Error("Invalid signature length");var c=s.slice(0,32),u=s.slice(32,64),l="".concat(i,".").concat(o),f=Zc(l),h=function(e){var t=Buffer.from(e.x,"base64"),n=Buffer.from(e.y,"base64");return Ko([new Uint8Array([4]),t,n])}(t);if(!Sl.verify(Ko([c,u]),f,h))throw new Error("Invalid signature");return ko(e).payload}function Zl(e){return(null==e?void 0:e.relay)||{protocol:"irn"}}function Yl(e){var t=Wa[e];if(_(t)>"u")throw new Error("Relay Protocol not supported: ".concat(e));return t}function Jl(e){var t={},n="relay"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-");return Object.keys(e).forEach(function(r){if(r.startsWith(n)){var i=r.replace(n,""),o=e[r];t[i]=o}}),t}function Ql(e){if(!e.includes("wc:")){var t=ys(e);null!=t&&t.includes("wc:")&&(e=t)}var n=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,i=e.substring(0,n),o=e.substring(n+1,r).split("@"),a=_(r)<"u"?e.substring(r):"",s=new URLSearchParams(a),c={};s.forEach(function(e,t){c[t]=e});var u="string"==typeof c.methods?c.methods.split(","):void 0;return{protocol:i,topic:Xl(o[0]),version:parseInt(o[1],10),symKey:c.symKey,relay:Jl(c),methods:u,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function Xl(e){return e.startsWith("//")?e.substring(2):e}function $l(e){var t=new URLSearchParams,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={};return Object.keys(e).forEach(function(r){var i=r,o="relay"+t+i;e[i]&&(n[o]=e[i])}),n}(e.relay);Object.keys(n).sort().forEach(function(e){t.set(e,n[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));var r=t.toString();return"".concat(e.protocol,":").concat(e.topic,"@").concat(e.version,"?").concat(r)}var ef={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},tf={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function nf(e,t){var n=tf[e],r=n.message,i=n.code;return{message:t?"".concat(r," ").concat(t):r,code:i}}function rf(e,t){var n=ef[e],r=n.message,i=n.code;return{message:t?"".concat(r," ").concat(t):r,code:i}}function of(e){return _(e)>"u"}function af(e,t){return"string"==typeof e&&!!e.trim().length}function sf(e){var t;return null==(t=null==e?void 0:e.proposer)?void 0:t.publicKey}function cf(e){return null==e?void 0:e.topic}function uf(e){return _(e)<"u"&&null!==_(e)}function lf(){var e=ns();return new Promise(function(t){switch(e){case Ja:t(ts()&&(null===(n=navigator)||void 0===n?void 0:n.onLine));break;case Za:t(function(){return ff.apply(this,arguments)}());break;default:t(!0)}var n})}function ff(){return ff=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:if(!(es()&&("undefined"==typeof global?"undefined":_(global))<"u"&&null!=global&&global.NetInfo)){e.n=2;break}return e.n=1,null==global?void 0:global.NetInfo.fetch();case 1:return t=e.v,e.a(2,null==t?void 0:t.isConnected);case 2:return e.a(2,!0)}},e)})),ff.apply(this,arguments)}function hf(e){switch(ns()){case Ja:!function(e){!es()&&ts()&&(window.addEventListener("online",function(){return e(!0)}),window.addEventListener("offline",function(){return e(!1)}))}(e);break;case Za:!function(e){var t;es()&&("undefined"==typeof global?"undefined":_(global))<"u"&&null!=global&&global.NetInfo&&(null===(t=global)||void 0===t||t.NetInfo.addEventListener(function(t){return e(null==t?void 0:t.isConnected)}))}(e)}}function df(){var e;return!ts()||!zo.getDocument()||"visible"===(null==(e=zo.getDocument())?void 0:e.visibilityState)}var pf="INTERNAL_ERROR",vf="SERVER_ERROR",gf=[-32700,-32600,-32601,-32602,-32603],yf=s(s(s(s(s(s({},"PARSE_ERROR",{code:-32700,message:"Parse error"}),"INVALID_REQUEST",{code:-32600,message:"Invalid Request"}),"METHOD_NOT_FOUND",{code:-32601,message:"Method not found"}),"INVALID_PARAMS",{code:-32602,message:"Invalid params"}),pf,{code:-32603,message:"Internal error"}),vf,{code:-32e3,message:"Server error"}),mf=vf;function wf(e){return Object.keys(yf).includes(e)?yf[e]:yf[mf]}function bf(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error("Unavailable ".concat(n," RPC url at ").concat(t)):e}var Ef={},kf=function(e,t){return kf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},kf(e,t)};
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation.

            Permission to use, copy, modify, and/or distribute this software for any
            purpose with or without fee is hereby granted.

            THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
            REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
            AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
            INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
            LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
            OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
            PERFORMANCE OF THIS SOFTWARE.
            ***************************************************************************** */var If=function(){return If=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},If.apply(this,arguments)};function Sf(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Of(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Pf(e){return this instanceof Pf?(this.v=e,this):new Pf(e)}var xf,_f=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return If},__asyncDelegator:function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:Pf(e[r](t)),done:"return"===r}:i?i(t):t}:i}},__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Pf?Promise.resolve(e.value.v).then(c,u):l(o[0][2],e)}(i[e](t))}catch(rO){l(o[0][3],rO)}}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Sf(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}},__await:Pf,__awaiter:function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(rO){o(rO)}}function s(e){try{c(r.throw(e))}catch(rO){o(rO)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},__createBinding:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},__decorate:function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},__exportStar:function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])},__extends:function(e,t){function n(){this.constructor=e}kf(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__generator:function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(rO){o=[6,rO],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__metadata:function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param:function(e,t){return function(n,r){t(n,r,e)}},__read:Of,__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Of(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},__values:Sf},Symbol.toStringTag,{value:"Module"})),Af=h(_f),Tf={};var Nf,Rf,Bf={};var Cf=(Rf||(Rf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Af;t.__exportStar(function(){if(xf)return Tf;function e(){return(null==p?void 0:p.crypto)||(null==p?void 0:p.msCrypto)||{}}function t(){var t=e();return t.subtle||t.webkitSubtle}return xf=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.isBrowserCryptoAvailable=Tf.getSubtleCrypto=Tf.getBrowerCrypto=void 0,Tf.getBrowerCrypto=e,Tf.getSubtleCrypto=t,Tf.isBrowserCryptoAvailable=function(){return!!e()&&!!t()},Tf}(),e),t.__exportStar(function(){if(Nf)return Bf;function e(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function t(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}return Nf=1,Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.isBrowser=Bf.isNode=Bf.isReactNative=void 0,Bf.isReactNative=e,Bf.isNode=t,Bf.isBrowser=function(){return!e()&&!t()},Bf}(),e)}(Ef)),Ef);function Uf(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function jf(){return BigInt(Uf(arguments.length>0&&void 0!==arguments[0]?arguments[0]:6))}function Lf(e,t,n){return{id:n||Uf(),jsonrpc:"2.0",method:e,params:t}}function Df(e,t){return{id:e,jsonrpc:"2.0",result:t}}function qf(e,t,n){return{id:e,jsonrpc:"2.0",error:Mf(t)}}function Mf(e,t){return void 0===e?wf(pf):("string"==typeof e&&(e=Object.assign(Object.assign({},wf(vf)),{message:e})),n=e.code,gf.includes(n)&&(e=function(e){var t=Object.values(yf).find(function(t){return t.code===e});return t||yf[mf]}(e.code)),e);var n}function zf(e,t){var n=function(e){var t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==n&&new RegExp(t).test(n)}function Hf(e){return zf(e,"^https?:")}function Vf(e){return zf(e,"^wss?:")}function Ff(e){return"object"===_(e)&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function Kf(e){return Ff(e)&&"method"in e}function Wf(e){return Ff(e)&&(Gf(e)||Zf(e))}function Gf(e){return"result"in e}function Zf(e){return"error"in e}var Yf=function(e){function t(e){var n;return S(this,t),(n=y(this,t,[e])).events=new N.EventEmitter,n.hasRegisteredEventListeners=!1,n.connection=n.setConnection(e),n.connection.connected&&n.registerEventListeners(),n}return k(t,e),P(t,[{key:"connect",value:(s=g(d().m(function e(){var t,n=arguments;return d().w(function(e){for(;;)switch(e.n){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.connection,e.n=1,this.open(t);case 1:return e.a(2)}},e,this)})),function(){return s.apply(this,arguments)})},{key:"disconnect",value:(a=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.close();case 1:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"request",value:(o=g(d().m(function e(t,n){return d().w(function(e){for(;;)if(0===e.n)return e.a(2,this.requestStrict(Lf(t.method,t.params||[],t.id||jf().toString()),n))},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"requestStrict",value:(i=g(d().m(function e(t,n){var r=this;return d().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(){var e=g(d().m(function e(i,o){var a,s;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.connection.connected){e.n=4;break}return e.p=1,e.n=2,r.open();case 2:e.n=4;break;case 3:e.p=3,a=e.v,o(a);case 4:return r.events.on("".concat(t.id),function(e){Zf(e)?o(e.error):i(e.result)}),e.p=5,e.n=6,r.connection.send(t,n);case 6:e.n=8;break;case 7:e.p=7,s=e.v,o(s);case 8:return e.a(2)}},e,null,[[5,7],[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()))},e)})),function(e,t){return i.apply(this,arguments)})},{key:"setConnection",value:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection}},{key:"onPayload",value:function(e){this.events.emit("payload",e),Wf(e)?this.events.emit("".concat(e.id),e):this.events.emit("message",{type:e.method,data:e.params})}},{key:"onClose",value:function(e){e&&3e3===e.code&&this.events.emit("error",new Error("WebSocket connection closed abnormally with code: ".concat(e.code," ").concat(e.reason?"(".concat(e.reason,")"):""))),this.events.emit("disconnect")}},{key:"open",value:(r=g(d().m(function e(){var t,n=arguments;return d().w(function(e){for(;;)switch(e.n){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:this.connection,this.connection===t&&this.connection.connected){e.n=4;break}if(this.connection.connected&&this.close(),"string"!=typeof t){e.n=2;break}return e.n=1,this.connection.open(t);case 1:t=this.connection;case 2:return this.connection=this.setConnection(t),e.n=3,this.connection.open();case 3:this.registerEventListeners(),this.events.emit("connect");case 4:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"close",value:(n=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.connection.close();case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"registerEventListeners",value:function(){var e=this;this.hasRegisteredEventListeners||(this.connection.on("payload",function(t){return e.onPayload(t)}),this.connection.on("close",function(t){return e.onClose(t)}),this.connection.on("error",function(t){return e.events.emit("error",t)}),this.connection.on("register_error",function(t){return e.onClose()}),this.hasRegisteredEventListeners=!0)}}]);var n,r,i,o,a,s}(function(e){function t(e){return S(this,t),y(this,t)}return k(t,e),P(t)}(function(e){function t(){return S(this,t),y(this,t)}return k(t,e),P(t)}(rO=P(function e(){S(this,e)}))));t("z",Yf);var Jf=function(e){return e.split("?")[0]},Qf=("undefined"==typeof WebSocket?"undefined":_(WebSocket))<"u"?WebSocket:("undefined"==typeof global?"undefined":_(global))<"u"&&_(global.WebSocket)<"u"?global.WebSocket:("undefined"==typeof window?"undefined":_(window))<"u"&&_(window.WebSocket)<"u"?window.WebSocket:("undefined"==typeof self?"undefined":_(self))<"u"&&_(self.WebSocket)<"u"?self.WebSocket:require("ws"),Xf=function(){return P(function e(t){if(S(this,e),this.url=t,this.events=new N.EventEmitter,this.registering=!1,!Vf(t))throw new Error("Provided URL is not compatible with WebSocket connection: ".concat(t));this.url=t},[{key:"connected",get:function(){return _(this.socket)<"u"}},{key:"connecting",get:function(){return this.registering}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"open",value:(n=g(d().m(function e(){var t,n=arguments;return d().w(function(e){for(;;)switch(e.n){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.url,e.n=1,this.register(t);case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"close",value:(t=g(d().m(function e(){var t=this;return d().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){_(t.socket)>"u"?n(new Error("Connection already closed")):(t.socket.onclose=function(n){t.onClose(n),e()},t.socket.close())}))},e)})),function(){return t.apply(this,arguments)})},{key:"send",value:(e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:if(!(_(this.socket)>"u")){e.n=2;break}return e.n=1,this.register();case 1:this.socket=e.v;case 2:try{this.socket.send(Le(t))}catch(Gs){this.onError(t.id,Gs)}case 3:return e.a(2)}},e,this)})),function(t){return e.apply(this,arguments)})},{key:"register",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url;if(!Vf(t))throw new Error("Provided URL is not compatible with WebSocket connection: ".concat(t));if(this.registering){var n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise(function(t,n){e.events.once("register_error",function(t){e.resetMaxListeners(),n(t)}),e.events.once("open",function(){if(e.resetMaxListeners(),_(e.socket)>"u")return n(new Error("WebSocket connection is missing or invalid"));t(e.socket)})})}return this.url=t,this.registering=!0,new Promise(function(n,r){var i,o=Cf.isReactNative()?void 0:{rejectUnauthorized:(i=t,!new RegExp("wss?://localhost(:d{2,5})?").test(i))},a=new Qf(t,[],o);("undefined"==typeof WebSocket?"undefined":_(WebSocket))<"u"||("undefined"==typeof global?"undefined":_(global))<"u"&&_(global.WebSocket)<"u"||("undefined"==typeof window?"undefined":_(window))<"u"&&_(window.WebSocket)<"u"||("undefined"==typeof self?"undefined":_(self))<"u"&&_(self.WebSocket)<"u"?a.onerror=function(t){var n=t;r(e.emitError(n.error))}:a.on("error",function(t){r(e.emitError(t))}),a.onopen=function(){e.onOpen(a),n(a)}})}},{key:"onOpen",value:function(e){var t=this;e.onmessage=function(e){return t.onPayload(e)},e.onclose=function(e){return t.onClose(e)},this.socket=e,this.registering=!1,this.events.emit("open")}},{key:"onClose",value:function(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}},{key:"onPayload",value:function(e){if(!(_(e.data)>"u")){var t="string"==typeof e.data?je(e.data):e.data;this.events.emit("payload",t)}}},{key:"onError",value:function(e,t){var n=this.parseError(t),r=qf(e,n.message||n.toString());this.events.emit("payload",r)}},{key:"parseError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url;return bf(e,Jf(t),"WS")}},{key:"resetMaxListeners",value:function(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}},{key:"emitError",value:function(e){var t=this.parseError(new Error((null==e?void 0:e.message)||"WebSocket connection failed for host: ".concat(Jf(this.url))));return this.events.emit("register_error",t),t}}]);var e,t,n}();t("B",Xf);var $f={},eh="core",th="".concat("wc","@2:").concat(eh,":"),nh="error",rh={database:":memory:"},ih="client_ed25519_seed",oh=ue.ONE_DAY,ah=ue.SIX_HOURS,sh="wss://relay.walletconnect.org",ch="relayer_message",uh="relayer_message_ack",lh="relayer_connect",fh="relayer_disconnect",hh="relayer_error",dh="relayer_connection_stalled",ph="relayer_publish",vh="payload",gh="connect",yh="disconnect",mh="error",wh="2.21.1",bh="link_mode",Eh="relay",kh="inbound",Ih="outbound",Sh="WALLETCONNECT_LINK_MODE_APPS",Oh="subscription_created",Ph="subscription_deleted",xh="subscription_sync",_h="subscription_resubscribed",Ah={wc_pairingDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:0},res:{ttl:ue.ONE_DAY,prompt:!1,tag:0}}},Th="pairing_create",Nh="pairing_expire",Rh="pairing_delete",Bh="pairing_ping",Ch="history_created",Uh="history_updated",jh="history_deleted",Lh="history_sync",Dh="expirer_created",qh="expirer_deleted",Mh="expirer_expired",zh="expirer_sync",Hh="https://verify.walletconnect.org",Vh=Hh,Fh="".concat(Vh,"/v3"),Kh=["https://verify.walletconnect.com",Hh],Wh="pairing_started",Gh="pairing_uri_validation_success",Zh="pairing_uri_not_expired",Yh="store_new_pairing",Jh="subscribing_pairing_topic",Qh="subscribe_pairing_topic_success",Xh="existing_pairing",$h="pairing_not_expired",ed="emit_inactive_pairing",td="emit_session_proposal",nd="no_internet_connection",rd="malformed_pairing_uri",id="active_pairing_already_exists",od="subscribe_pairing_topic_failure",ad="pairing_expired",sd="proposal_listener_not_found",cd="session_approve_started",ud="session_namespaces_validation_success",ld="subscribing_session_topic",fd="subscribe_session_topic_success",hd="publishing_session_approve",dd="session_approve_publish_success",pd="store_session",vd="publishing_session_settle",gd="session_settle_publish_success",yd="no_internet_connection",md="proposal_expired",wd="subscribe_session_topic_failure",bd="session_approve_publish_failure",Ed="session_settle_publish_failure",kd="session_approve_namespace_validation_failure",Id="proposal_not_found",Sd="authenticated_session_approve_started",Od="create_authenticated_session_topic",Pd="cacaos_verified",xd="store_authenticated_session",_d="subscribing_authenticated_session_topic",Ad="subscribe_authenticated_session_topic_success",Td="publishing_authenticated_session_approve",Nd="no_internet_connection",Rd="invalid_cacao",Bd="subscribe_authenticated_session_topic_failure",Cd="authenticated_session_approve_publish_failure",Ud="authenticated_session_pending_request_not_found";var jd=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),a=o.charCodeAt(0);if(255!==n[a])throw new TypeError(o+" is ambiguous");n[a]=i}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*u+1>>>0,a=new Uint8Array(o);e[t];){var l=n[e.charCodeAt(t)];if(255===l)return;for(var f=0,h=o-1;(0!==l||f<i)&&-1!==h;h--,f++)l+=s*a[h]>>>0,a[h]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===a[d];)d++;for(var p=new Uint8Array(r+(o-d)),v=r;d!==o;)p[v++]=a[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var a=(o-i)*l+1>>>0,u=new Uint8Array(a);i!==o;){for(var f=t[i],h=0,d=a-1;(0!==f||h<r)&&-1!==d;d--,h++)f+=256*u[d]>>>0,u[d]=f%s>>>0,f=f/s>>>0;if(0!==f)throw new Error("Non-zero carry");r=h,i++}for(var p=a-r;p!==a&&0===u[p];)p++;for(var v=c.repeat(n);p<a;++p)v+=e.charAt(u[p]);return v},decodeUnsafe:f,decode:function(e){var n=f(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}},Ld=jd,Dd=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},qd=function(){return P(function e(t,n,r){S(this,e),this.name=t,this.prefix=n,this.baseEncode=r},[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}])}(),Md=function(){return P(function e(t,n,r){if(S(this,e),this.name=t,this.prefix=n,void 0===n.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r},[{key:"decode",value:function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return Hd(this,e)}}])}(),zd=function(){return P(function e(t){S(this,e),this.decoders=t},[{key:"or",value:function(e){return Hd(this,e)}},{key:"decode",value:function(e){var t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}])}(),Hd=function(e,t){return new zd(a(a({},e.decoders||s({},e.prefix,e)),t.decoders||s({},t.prefix,t)))},Vd=function(){return P(function e(t,n,r,i){S(this,e),this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new qd(t,n,r),this.decoder=new Md(t,n,i)},[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}])}(),Fd=function(e){var t=e.name,n=e.prefix,r=e.encode,i=e.decode;return new Vd(t,n,r,i)},Kd=function(e){var t=e.prefix,n=e.name,r=e.alphabet,i=Ld(r,n),o=i.encode,a=i.decode;return Fd({prefix:t,name:n,encode:o,decode:function(e){return Dd(a(e))}})},Wd=function(e){var t=e.name,n=e.prefix,r=e.bitsPerChar,i=e.alphabet;return Fd({prefix:n,name:t,encode:function(e){return function(e,t,n){for(var r="="===t[t.length-1],i=(1<<n)-1,o="",a=0,s=0,c=0;c<e.length;++c)for(s=s<<8|e[c],a+=8;a>n;)o+=t[i&s>>(a-=n)];if(a&&(o+=t[i&s<<n-a]),r)for(;o.length*n&7;)o+="=";return o}(e,i,r)},decode:function(e){return function(e,t,n,r){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var a=e.length;"="===e[a-1];)--a;for(var s=new Uint8Array(a*n/8|0),c=0,u=0,l=0,f=0;f<a;++f){var h=i[e[f]];if(void 0===h)throw new SyntaxError("Non-".concat(r," character"));u=u<<n|h,(c+=n)>=8&&(c-=8,s[l++]=255&u>>c)}if(c>=n||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s}(e,i,r,t)}})},Gd=Fd({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),Zd=Object.freeze({__proto__:null,identity:Gd}),Yd=Wd({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Jd=Object.freeze({__proto__:null,base2:Yd}),Qd=Wd({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Xd=Object.freeze({__proto__:null,base8:Qd}),$d=Kd({prefix:"9",name:"base10",alphabet:"0123456789"}),ep=Object.freeze({__proto__:null,base10:$d}),tp=Wd({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),np=Wd({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),rp=Object.freeze({__proto__:null,base16:tp,base16upper:np}),ip=Wd({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),op=Wd({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ap=Wd({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sp=Wd({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),cp=Wd({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),up=Wd({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),lp=Wd({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fp=Wd({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hp=Wd({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),dp=Object.freeze({__proto__:null,base32:ip,base32upper:op,base32pad:ap,base32padupper:sp,base32hex:cp,base32hexupper:up,base32hexpad:lp,base32hexpadupper:fp,base32z:hp}),pp=Kd({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),vp=Kd({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),gp=Object.freeze({__proto__:null,base36:pp,base36upper:vp}),yp=Kd({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),mp=Kd({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),wp=Object.freeze({__proto__:null,base58btc:yp,base58flickr:mp}),bp=Wd({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ep=Wd({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kp=Wd({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ip=Wd({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Sp=Object.freeze({__proto__:null,base64:bp,base64pad:Ep,base64url:kp,base64urlpad:Ip}),Op=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Pp=Op.reduce(function(e,t,n){return e[n]=t,e},[]),xp=Op.reduce(function(e,t,n){return e[t.codePointAt(0)]=n,e},[]);var _p=Fd({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(function(e,t){return e+=Pp[t]},"")},decode:function(e){var t,n=[],r=u(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=xp[i.codePointAt(0)];if(void 0===o)throw new Error("Non-base256emoji character: ".concat(i));n.push(o)}}catch(a){r.e(a)}finally{r.f()}return new Uint8Array(n)}}),Ap=Object.freeze({__proto__:null,base256emoji:_p}),Tp=function e(t,n,r){n=n||[];for(var i=r=r||0;t>=Bp;)n[r++]=255&t|Np,t/=128;for(;t&Rp;)n[r++]=255&t|Np,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},Np=128,Rp=-128,Bp=Math.pow(2,31);var Cp=function e(t,n){var r,i=0,o=(n=n||0,0),a=n,s=t.length;do{if(a>=s)throw e.bytes=0,new RangeError("Could not decode varint");r=t[a++],i+=o<28?(r&jp)<<o:(r&jp)*Math.pow(2,o),o+=7}while(r>=Up);return e.bytes=a-n,i},Up=128,jp=127;var Lp=Math.pow(2,7),Dp=Math.pow(2,14),qp=Math.pow(2,21),Mp=Math.pow(2,28),zp=Math.pow(2,35),Hp=Math.pow(2,42),Vp=Math.pow(2,49),Fp=Math.pow(2,56),Kp=Math.pow(2,63),Wp={encode:Tp,decode:Cp,encodingLength:function(e){return e<Lp?1:e<Dp?2:e<qp?3:e<Mp?4:e<zp?5:e<Hp?6:e<Vp?7:e<Fp?8:e<Kp?9:10}},Gp=Wp,Zp=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Gp.encode(e,t,n),t},Yp=function(e){return Gp.encodingLength(e)},Jp=function(e,t){var n=t.byteLength,r=Yp(e),i=r+Yp(n),o=new Uint8Array(i+n);return Zp(e,o,0),Zp(n,o,r),o.set(t,i),new Qp(e,n,t,o)},Qp=P(function e(t,n,r,i){S(this,e),this.code=t,this.size=n,this.digest=r,this.bytes=i}),Xp=function(e){var t=e.name,n=e.code,r=e.encode;return new $p(t,n,r)},$p=function(){return P(function e(t,n,r){S(this,e),this.name=t,this.code=n,this.encode=r},[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var n=this.encode(e);return n instanceof Uint8Array?Jp(this.code,n):n.then(function(e){return Jp(t.code,e)})}throw Error("Unknown type, must be binary type")}}])}(),ev=function(e){return function(){var t=g(d().m(function t(n){var r,i;return d().w(function(t){for(;;)switch(t.n){case 0:return r=Uint8Array,t.n=1,crypto.subtle.digest(e,n);case 1:return i=t.v,t.a(2,new r(i))}},t)}));return function(e){return t.apply(this,arguments)}}()},tv=Xp({name:"sha2-256",code:18,encode:ev("SHA-256")}),nv=Xp({name:"sha2-512",code:19,encode:ev("SHA-512")}),rv=Object.freeze({__proto__:null,sha256:tv,sha512:nv}),iv=Dd,ov={code:0,name:"identity",encode:iv,digest:function(e){return Jp(0,iv(e))}},av=Object.freeze({__proto__:null,identity:ov});new TextEncoder,new TextDecoder;var sv=a(a(a(a(a(a(a(a(a(a({},Zd),Jd),Xd),ep),rp),dp),gp),wp),Sp),Ap);function cv(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}a(a({},rv),av);var uv=cv("utf8","u",function(e){return"u"+new TextDecoder("utf8").decode(e)},function(e){return(new TextEncoder).encode(e.substring(1))}),lv=cv("ascii","a",function(e){for(var t="a",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},function(e){for(var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),fv=a({utf8:uv,"utf-8":uv,hex:sv.base16,latin1:lv,ascii:lv,binary:lv},sv);function hv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=fv[t];if(!n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode("".concat(n.prefix).concat(e)):globalThis.Buffer.from(e,"utf8")}var dv=Object.defineProperty,pv=function(e,t,n){return function(e,t,n){return t in e?dv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},vv=function(){return P(function e(t,n){var r=this;S(this,e),this.core=t,this.logger=n,pv(this,"keychain",new Map),pv(this,"name","keychain"),pv(this,"version","0.3"),pv(this,"initialized",!1),pv(this,"storagePrefix",th),pv(this,"init",g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:if(r.initialized){e.n=2;break}return e.n=1,r.getKeyChain();case 1:_(t=e.v)<"u"&&(r.keychain=t),r.initialized=!0;case 2:return e.a(2)}},e)}))),pv(this,"has",function(e){return r.isInitialized(),r.keychain.has(e)}),pv(this,"set",function(){var e=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return r.isInitialized(),r.keychain.set(t,n),e.n=1,r.persist();case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),pv(this,"get",function(e){r.isInitialized();var t=r.keychain.get(e);if(_(t)>"u"){var n=nf("NO_MATCHING_KEY","".concat(r.name,": ").concat(e)).message;throw new Error(n)}return t}),pv(this,"del",function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return r.isInitialized(),r.keychain.delete(t),e.n=1,r.persist();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),this.core=t,this.logger=mt(n,this.name)},[{key:"context",get:function(){return yt(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"setKeyChain",value:(n=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.setItem(this.storageKey,as(t));case 1:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getKeyChain",value:(t=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.getItem(this.storageKey);case 1:return t=e.v,e.a(2,_(t)<"u"?ss(t):void 0)}},e,this)})),function(){return t.apply(this,arguments)})},{key:"persist",value:(e=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.setKeyChain(this.keychain);case 1:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]);var e,t,n}(),gv=Object.defineProperty,yv=function(e,t,n){return function(e,t,n){return t in e?gv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},mv=function(){return P(function e(t,n,r){var i=this;S(this,e),this.core=t,this.logger=n,yv(this,"name","crypto"),yv(this,"keychain"),yv(this,"randomSessionIdentifier",Tl()),yv(this,"initialized",!1),yv(this,"init",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(i.initialized){e.n=2;break}return e.n=1,i.keychain.init();case 1:i.initialized=!0;case 2:return e.a(2)}},e)}))),yv(this,"hasKeys",function(e){return i.isInitialized(),i.keychain.has(e)}),yv(this,"getClientId",g(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.n){case 0:return i.isInitialized(),e.n=1,i.getClientSeed();case 1:return t=e.v,n=Io(t),e.a(2,mo(n.publicKey))}},e)}))),yv(this,"generateKeyPair",function(){i.isInitialized();var e=function(){var e=fl.utils.randomPrivateKey(),t=fl.getPublicKey(e);return{privateKey:Ka(e,Pl),publicKey:Ka(t,Pl)}}();return i.setPrivateKey(e.publicKey,e.privateKey)}),yv(this,"signJWT",function(){var e=g(d().m(function e(t){var n,r,o,a;return d().w(function(e){for(;;)switch(e.n){case 0:return i.isInitialized(),e.n=1,i.getClientSeed();case 1:return n=e.v,r=Io(n),o=i.randomSessionIdentifier,a=oh,e.n=2,So(o,t,a,r);case 2:return e.a(2,e.v)}},e)}));return function(t){return e.apply(this,arguments)}}()),yv(this,"generateSharedKey",function(e,t,n){i.isInitialized();var r=function(e,t){var n=fl.getSharedSecret(Fa(e,Pl),Fa(t,Pl));return Ka(Mc(Zc,n,void 0,void 0,32),Pl)}(i.getPrivateKey(e),t);return i.setSymKey(r,n)}),yv(this,"setSymKey",function(){var e=g(d().m(function e(t,n){var r;return d().w(function(e){for(;;)switch(e.n){case 0:return i.isInitialized(),r=n||Nl(t),e.n=1,i.keychain.set(r,t);case 1:return e.a(2,r)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),yv(this,"deleteKeyPair",function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return i.isInitialized(),e.n=1,i.keychain.del(t);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),yv(this,"deleteSymKey",function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return i.isInitialized(),e.n=1,i.keychain.del(t);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),yv(this,"encode",function(){var e=g(d().m(function e(t,n,r){var o,a,s,c,u,l,f;return d().w(function(e){for(;;)switch(e.n){case 0:if(i.isInitialized(),o=Fl(r),a=Le(n),!Wl(o)){e.n=1;break}return e.a(2,ql(a,null==r?void 0:r.encoding));case 1:if(!Kl(o)){e.n=3;break}return s=o.senderPublicKey,c=o.receiverPublicKey,e.n=2,i.generateSharedKey(s,c);case 2:t=e.v;case 3:return u=i.getSymKey(t),l=o.type,f=o.senderPublicKey,e.a(2,Ll({type:l,symKey:u,message:a,senderPublicKey:f,encoding:null==r?void 0:r.encoding}))}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()),yv(this,"decode",function(){var e=g(d().m(function e(t,n,r){var o,a,s,c,u,l,f,h,p;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i.isInitialized(),!Wl(o=Vl(n,r))){e.n=1;break}return a=Ml(n,null==r?void 0:r.encoding),e.a(2,je(a));case 1:if(!Kl(o)){e.n=3;break}return s=o.receiverPublicKey,c=o.senderPublicKey,e.n=2,i.generateSharedKey(s,c);case 2:t=e.v;case 3:return e.p=3,u=i.getSymKey(t),l=Dl({symKey:u,encoded:n,encoding:null==r?void 0:r.encoding}),e.a(2,je(l));case 4:return e.p=4,f=e.v,h=i.logger,p="Failed to decode message from topic: '".concat(t,"', clientId: '"),e.n=5,i.getClientId();case 5:h.error.call(h,p.concat.call(p,e.v,"'")),i.logger.error(f);case 6:return e.a(2)}},e,null,[[3,4]])}));return function(t,n,r){return e.apply(this,arguments)}}()),yv(this,"getPayloadType",function(e){return Cl(Hl({encoded:e,encoding:arguments.length>1&&void 0!==arguments[1]?arguments[1]:xl}).type)}),yv(this,"getPayloadSenderPublicKey",function(e){var t=Hl({encoded:e,encoding:arguments.length>1&&void 0!==arguments[1]?arguments[1]:xl});return t.senderPublicKey?Ka(t.senderPublicKey,Pl):void 0}),this.core=t,this.logger=mt(n,this.name),this.keychain=r||new vv(this.core,this.logger)},[{key:"context",get:function(){return yt(this.logger)}},{key:"setPrivateKey",value:(t=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.keychain.set(t,n);case 1:return e.a(2,t)}},e,this)})),function(e,n){return t.apply(this,arguments)})},{key:"getPrivateKey",value:function(e){return this.keychain.get(e)}},{key:"getClientSeed",value:(e=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:t="",e.p=1,t=this.keychain.get(ih),e.n=3;break;case 2:return e.p=2,e.v,t=Tl(),e.n=3,this.keychain.set(ih,t);case 3:return e.a(2,hv(t,"base16"))}},e,this,[[1,2]])})),function(){return e.apply(this,arguments)})},{key:"getSymKey",value:function(e){return this.keychain.get(e)}},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]);var e,t}(),wv=Object.defineProperty,bv=Object.defineProperties,Ev=Object.getOwnPropertyDescriptors,kv=Object.getOwnPropertySymbols,Iv=Object.prototype.hasOwnProperty,Sv=Object.prototype.propertyIsEnumerable,Ov=function(e,t,n){return t in e?wv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Pv=function(e,t){for(var n in t||(t={}))Iv.call(t,n)&&Ov(e,n,t[n]);if(kv){var r,i=u(kv(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Sv.call(t,n)&&Ov(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},xv=function(e,t){return bv(e,Ev(t))},_v=function(e,t,n){return Ov(e,"symbol"!=_(t)?t+"":t,n)},Av=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n])).logger=e,r.core=n,_v(w(r),"messages",new Map),_v(w(r),"messagesWithoutClientAck",new Map),_v(w(r),"name","messages"),_v(w(r),"version","0.3"),_v(w(r),"initialized",!1),_v(w(r),"storagePrefix",th),_v(w(r),"init",g(d().m(function e(){var t,n,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.initialized){e.n=6;break}return r.logger.trace("Initialized"),e.p=1,e.n=2,r.getRelayerMessages();case 2:return _(t=e.v)<"u"&&(r.messages=t),e.n=3,r.getRelayerMessagesWithoutClientAck();case 3:_(n=e.v)<"u"&&(r.messagesWithoutClientAck=n),r.logger.debug("Successfully Restored records for ".concat(r.name)),r.logger.trace({type:"method",method:"restore",size:r.messages.size}),e.n=5;break;case 4:e.p=4,i=e.v,r.logger.debug("Failed to Restore records for ".concat(r.name)),r.logger.error(i);case 5:return e.p=5,r.initialized=!0,e.f(5);case 6:return e.a(2)}},e,null,[[1,4,5,6]])}))),_v(w(r),"set",function(){var e=g(d().m(function e(t,n,i){var o,a,c;return d().w(function(e){for(;;)switch(e.n){case 0:if(r.isInitialized(),o=Rl(n),_(a=r.messages.get(t))>"u"&&(a={}),!(_(a[o])<"u")){e.n=1;break}return e.a(2,o);case 1:return a[o]=n,r.messages.set(t,a),i===kh&&(c=r.messagesWithoutClientAck.get(t)||{},r.messagesWithoutClientAck.set(t,xv(Pv({},c),s({},o,n)))),e.n=2,r.persist();case 2:return e.a(2,o)}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()),_v(w(r),"get",function(e){r.isInitialized();var t=r.messages.get(e);return _(t)>"u"&&(t={}),t}),_v(w(r),"getWithoutAck",function(e){r.isInitialized();var t,n={},i=u(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=r.messagesWithoutClientAck.get(o)||{};n[o]=Object.values(a)}}catch(s){i.e(s)}finally{i.f()}return n}),_v(w(r),"has",function(e,t){return r.isInitialized(),_(r.get(e)[Rl(t)])<"u"}),_v(w(r),"ack",function(){var e=g(d().m(function e(t,n){var i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(r.isInitialized(),!(_(i=r.messagesWithoutClientAck.get(t))>"u")){e.n=1;break}return e.a(2);case 1:return o=Rl(n),delete i[o],0===Object.keys(i).length?r.messagesWithoutClientAck.delete(t):r.messagesWithoutClientAck.set(t,i),e.n=2,r.persist();case 2:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),_v(w(r),"del",function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return r.isInitialized(),r.messages.delete(t),r.messagesWithoutClientAck.delete(t),e.n=1,r.persist();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),r.logger=mt(e,r.name),r.core=n,r}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"storageKeyWithoutClientAck",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}},{key:"setRelayerMessages",value:(a=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.setItem(this.storageKey,as(t));case 1:return e.a(2)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"setRelayerMessagesWithoutClientAck",value:(o=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.setItem(this.storageKeyWithoutClientAck,as(t));case 1:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getRelayerMessages",value:(i=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.getItem(this.storageKey);case 1:return t=e.v,e.a(2,_(t)<"u"?ss(t):void 0)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getRelayerMessagesWithoutClientAck",value:(r=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.getItem(this.storageKeyWithoutClientAck);case 1:return t=e.v,e.a(2,_(t)<"u"?ss(t):void 0)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"persist",value:(n=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.setRelayerMessages(this.messages);case 1:return e.n=2,this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck);case 2:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]);var n,r,i,o,a}(Pt),Tv=Object.defineProperty,Nv=Object.defineProperties,Rv=Object.getOwnPropertyDescriptors,Bv=Object.getOwnPropertySymbols,Cv=Object.prototype.hasOwnProperty,Uv=Object.prototype.propertyIsEnumerable,jv=function(e,t,n){return t in e?Tv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Lv=function(e,t){for(var n in t||(t={}))Cv.call(t,n)&&jv(e,n,t[n]);if(Bv){var r,i=u(Bv(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Uv.call(t,n)&&jv(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},Dv=function(e,t){return Nv(e,Rv(t))},qv=function(e,t,n){return jv(e,"symbol"!=_(t)?t+"":t,n)},Mv=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n])).relayer=e,r.logger=n,qv(w(r),"events",new N.EventEmitter),qv(w(r),"name","publisher"),qv(w(r),"queue",new Map),qv(w(r),"publishTimeout",ue.toMiliseconds(ue.ONE_MINUTE)),qv(w(r),"initialPublishTimeout",ue.toMiliseconds(15*ue.ONE_SECOND)),qv(w(r),"needsTransportRestart",!1),qv(w(r),"publish",function(){var e=g(d().m(function e(t,n,i){var o,a,s,c,u,l,f,h,p,v;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return r.logger.debug("Publishing Payload"),r.logger.trace({type:"method",method:"publish",params:{topic:t,message:n,opts:i}}),a=(null==i?void 0:i.ttl)||ah,s=Zl(i),c=(null==i?void 0:i.prompt)||!1,u=(null==i?void 0:i.tag)||0,l=(null==i?void 0:i.id)||jf().toString(),f={topic:t,message:n,opts:{ttl:a,relay:s,prompt:c,tag:u,id:l,attestation:null==i?void 0:i.attestation,tvf:null==i?void 0:i.tvf}},h="Failed to publish payload, please try again. id:".concat(l," tag:").concat(u),e.p=1,p=new Promise(function(){var e=g(d().m(function e(o){var s,h,p;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=function(e){var t=e.id;f.opts.id===t&&(r.removeRequestFromQueue(t),r.relayer.events.removeListener(ph,s),o(f))},r.relayer.events.on(ph,s),h=us(new Promise(function(e,o){r.rpcPublish({topic:t,message:n,ttl:a,prompt:c,tag:u,id:l,attestation:null==i?void 0:i.attestation,tvf:null==i?void 0:i.tvf}).then(e).catch(function(e){r.logger.warn(e,null==e?void 0:e.message),o(e)})}),r.initialPublishTimeout,"Failed initial publish, retrying.... id:".concat(l," tag:").concat(u)),e.p=1,e.n=2,h;case 2:r.events.removeListener(ph,s),e.n=4;break;case 3:e.p=3,p=e.v,r.queue.set(l,Dv(Lv({},f),{attempt:1})),r.logger.warn(p,null==p?void 0:p.message);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),r.logger.trace({type:"method",method:"publish",params:{id:l,topic:t,message:n,opts:i}}),e.n=2,us(p,r.publishTimeout,h);case 2:e.n=4;break;case 3:if(e.p=3,v=e.v,r.logger.debug("Failed to Publish Payload"),r.logger.error(v),null==(o=null==i?void 0:i.internal)||!o.throwOnFailedPublish){e.n=4;break}throw v;case 4:return e.p=4,r.queue.delete(l),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t,n,r){return e.apply(this,arguments)}}()),qv(w(r),"on",function(e,t){r.events.on(e,t)}),qv(w(r),"once",function(e,t){r.events.once(e,t)}),qv(w(r),"off",function(e,t){r.events.off(e,t)}),qv(w(r),"removeListener",function(e,t){r.events.removeListener(e,t)}),r.relayer=e,r.logger=mt(n,r.name),r.registerEventListeners(),r}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"rpcPublish",value:(n=g(d().m(function e(t){var n,r,i,o,a,s,c,u,l,f,h,p,v,g,y;return d().w(function(e){for(;;)switch(e.n){case 0:return a=t.topic,s=t.message,c=t.ttl,u=void 0===c?ah:c,l=t.prompt,f=t.tag,h=t.id,p=t.attestation,v=t.tvf,g={method:Yl(Zl().protocol).publish,params:Lv({topic:a,message:s,ttl:u,prompt:l,tag:f,attestation:p},v),id:h},of(null==(n=g.params)?void 0:n.prompt)&&(null==(r=g.params)||delete r.prompt),of(null==(i=g.params)?void 0:i.tag)&&(null==(o=g.params)||delete o.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:g}),e.n=1,this.relayer.request(g);case 1:return y=e.v,e.a(2,(this.relayer.events.emit(ph,t),this.logger.debug("Successfully Published Payload"),y))}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"removeRequestFromQueue",value:function(e){this.queue.delete(e)}},{key:"checkQueue",value:function(){var e=this;this.queue.forEach(function(){var t=g(d().m(function t(n,r){var i,o,a,s,c;return d().w(function(t){for(;;)switch(t.n){case 0:return i=n.attempt+1,e.queue.set(r,Dv(Lv({},n),{attempt:i})),o=n.topic,a=n.message,s=n.opts,c=n.attestation,e.logger.warn({},"Publisher: queue->publishing: ".concat(n.opts.id,", tag: ").concat(n.opts.tag,", attempt: ").concat(i)),t.n=1,e.rpcPublish(Dv(Lv({},n),{topic:o,message:a,ttl:s.ttl,prompt:s.prompt,tag:s.tag,id:s.id,attestation:c,tvf:s.tvf}));case 1:e.logger.warn({},"Publisher: queue->published: ".concat(n.opts.id));case 2:return t.a(2)}},t)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"registerEventListeners",value:function(){var e=this;this.relayer.core.heartbeat.on(de.pulse,function(){if(e.needsTransportRestart)return e.needsTransportRestart=!1,void e.relayer.events.emit(dh);e.checkQueue()}),this.relayer.on(uh,function(t){e.removeRequestFromQueue(t.id.toString())})}}]);var n}(xt),zv=Object.defineProperty,Hv=function(e,t,n){return function(e,t,n){return t in e?zv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},Vv=function(){return P(function e(){var t=this;S(this,e),Hv(this,"map",new Map),Hv(this,"set",function(e,n){var r=t.get(e);t.exists(e,n)||t.map.set(e,[].concat(l(r),[n]))}),Hv(this,"get",function(e){return t.map.get(e)||[]}),Hv(this,"exists",function(e,n){return t.get(e).includes(n)}),Hv(this,"delete",function(e,n){if(_(n)>"u")t.map.delete(e);else if(t.map.has(e)){var r=t.get(e);if(t.exists(e,n)){var i=r.filter(function(e){return e!==n});i.length?t.map.set(e,i):t.map.delete(e)}}}),Hv(this,"clear",function(){t.map.clear()})},[{key:"topics",get:function(){return Array.from(this.map.keys())}}])}(),Fv=Object.defineProperty,Kv=Object.defineProperties,Wv=Object.getOwnPropertyDescriptors,Gv=Object.getOwnPropertySymbols,Zv=Object.prototype.hasOwnProperty,Yv=Object.prototype.propertyIsEnumerable,Jv=function(e,t,n){return t in e?Fv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Qv=function(e,t){for(var n in t||(t={}))Zv.call(t,n)&&Jv(e,n,t[n]);if(Gv){var r,i=u(Gv(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Yv.call(t,n)&&Jv(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},Xv=function(e,t){return Kv(e,Wv(t))},$v=function(e,t,n){return Jv(e,"symbol"!=_(t)?t+"":t,n)},eg=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n])).relayer=e,r.logger=n,$v(w(r),"subscriptions",new Map),$v(w(r),"topicMap",new Vv),$v(w(r),"events",new N.EventEmitter),$v(w(r),"name","subscription"),$v(w(r),"version","0.3"),$v(w(r),"pending",new Map),$v(w(r),"cached",[]),$v(w(r),"initialized",!1),$v(w(r),"storagePrefix",th),$v(w(r),"subscribeTimeout",ue.toMiliseconds(ue.ONE_MINUTE)),$v(w(r),"initialSubscribeTimeout",ue.toMiliseconds(15*ue.ONE_SECOND)),$v(w(r),"clientId"),$v(w(r),"batchSubscribeTopicsLimit",500),$v(w(r),"init",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(r.initialized){e.n=1;break}return r.logger.trace("Initialized"),r.registerEventListeners(),e.n=1,r.restore();case 1:r.initialized=!0;case 2:return e.a(2)}},e)}))),$v(w(r),"subscribe",function(){var e=g(d().m(function e(t,n){var i,o,a,s;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return r.isInitialized(),r.logger.debug("Subscribing Topic"),r.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:n}}),e.p=1,i=Zl(n),o={topic:t,relay:i,transportType:null==n?void 0:n.transportType},r.pending.set(t,o),e.n=2,r.rpcSubscribe(t,i,n);case 2:return a=e.v,e.a(2,("string"==typeof a&&(r.onSubscribe(a,o),r.logger.debug("Successfully Subscribed Topic"),r.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:n}})),a));case 3:throw e.p=3,s=e.v,r.logger.debug("Failed to Subscribe Topic"),r.logger.error(s),s;case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()),$v(w(r),"unsubscribe",function(){var e=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:if(r.isInitialized(),!(_(null==n?void 0:n.id)<"u")){e.n=2;break}return e.n=1,r.unsubscribeById(t,n.id,n);case 1:e.n=3;break;case 2:return e.n=3,r.unsubscribeByTopic(t,n);case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$v(w(r),"isSubscribed",function(e){return new Promise(function(t){t(r.topicMap.topics.includes(e))})}),$v(w(r),"isKnownTopic",function(e){return new Promise(function(t){t(r.topicMap.topics.includes(e)||r.pending.has(e)||r.cached.some(function(t){return t.topic===e}))})}),$v(w(r),"on",function(e,t){r.events.on(e,t)}),$v(w(r),"once",function(e,t){r.events.once(e,t)}),$v(w(r),"off",function(e,t){r.events.off(e,t)}),$v(w(r),"removeListener",function(e,t){r.events.removeListener(e,t)}),$v(w(r),"start",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.onConnect();case 1:return e.a(2)}},e)}))),$v(w(r),"stop",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.onDisconnect();case 1:return e.a(2)}},e)}))),$v(w(r),"restart",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.restore();case 1:return e.n=2,r.onRestart();case 2:return e.a(2)}},e)}))),$v(w(r),"checkPending",g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:if(0!==r.pending.size||r.initialized&&r.relayer.connected){e.n=1;break}return e.a(2);case 1:return t=[],r.pending.forEach(function(e){t.push(e)}),e.n=2,r.batchSubscribe(t);case 2:return e.a(2)}},e)}))),$v(w(r),"registerEventListeners",function(){r.relayer.core.heartbeat.on(de.pulse,g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.checkPending();case 1:return e.a(2)}},e)}))),r.events.on(Oh,function(){var e=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return n=Oh,r.logger.info("Emitting ".concat(n)),r.logger.debug({type:"event",event:n,data:t}),e.n=1,r.persist();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),r.events.on(Ph,function(){var e=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return n=Ph,r.logger.info("Emitting ".concat(n)),r.logger.debug({type:"event",event:n,data:t}),e.n=1,r.persist();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}())}),r.relayer=e,r.logger=mt(n,r.name),r.clientId="",r}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}},{key:"length",get:function(){return this.subscriptions.size}},{key:"ids",get:function(){return Array.from(this.subscriptions.keys())}},{key:"values",get:function(){return Array.from(this.subscriptions.values())}},{key:"topics",get:function(){return this.topicMap.topics}},{key:"hasAnyTopics",get:function(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}},{key:"hasSubscription",value:function(e,t){var n=!1;try{n=this.getSubscription(e).topic===t}catch(r){}return n}},{key:"reset",value:function(){this.cached=[],this.initialized=!0}},{key:"onDisable",value:function(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}},{key:"unsubscribeByTopic",value:(O=g(d().m(function e(t,n){var r,i=this;return d().w(function(e){for(;;)switch(e.n){case 0:return r=this.topicMap.get(t),e.n=1,Promise.all(r.map(function(){var e=g(d().m(function e(r){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i.unsubscribeById(t,r,n);case 1:return e.a(2,e.v)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:return e.a(2)}},e,this)})),function(e,t){return O.apply(this,arguments)})},{key:"unsubscribeById",value:(I=g(d().m(function e(t,n,r){var i,o,a;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}}),e.p=1,i=Zl(r),e.n=2,this.restartToComplete({topic:t,id:n,relay:i});case 2:return e.n=3,this.rpcUnsubscribe(t,n,i);case 3:return o=rf("USER_DISCONNECTED","".concat(this.name,", ").concat(t)),e.n=4,this.onUnsubscribe(t,n,o);case 4:this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}}),e.n=6;break;case 5:throw e.p=5,a=e.v,this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a;case 6:return e.a(2)}},e,this,[[1,5]])})),function(e,t,n){return I.apply(this,arguments)})},{key:"rpcSubscribe",value:(E=g(d().m(function e(t,n,r){var i,o,a,s,c,u,l,f=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r&&(null==r?void 0:r.transportType)!==Eh){e.n=1;break}return e.n=1,this.restartToComplete({topic:t,id:t,relay:n});case 1:return o={method:Yl(n.protocol).subscribe,params:{topic:t}},this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),a=null==(i=null==r?void 0:r.internal)?void 0:i.throwOnFailedPublish,e.p=2,e.n=3,this.getSubscriptionId(t);case 3:if(s=e.v,(null==r?void 0:r.transportType)!==bh){e.n=4;break}return e.a(2,(setTimeout(function(){(f.relayer.connected||f.relayer.connecting)&&f.relayer.request(o).catch(function(e){return f.logger.warn(e)})},ue.toMiliseconds(ue.ONE_SECOND)),s));case 4:return c=new Promise(function(){var e=g(d().m(function e(n){var r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=function(e){e.topic===t&&(f.events.removeListener(Oh,r),n(e.id))},f.events.on(Oh,r),e.p=1,e.n=2,us(new Promise(function(e,t){f.relayer.request(o).catch(function(e){f.logger.warn(e,null==e?void 0:e.message),t(e)}).then(e)}),f.initialSubscribeTimeout,"Subscribing to ".concat(t," failed, please try again"));case 2:i=e.v,f.events.removeListener(Oh,r),n(i),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),e.n=5,us(c,this.subscribeTimeout,"Subscribing to ".concat(t," failed, please try again"));case 5:if((u=e.v)||!a){e.n=6;break}throw new Error("Subscribing to ".concat(t," failed, please try again"));case 6:return e.a(2,u?s:null);case 7:if(e.p=7,l=e.v,this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(dh),!a){e.n=8;break}throw l;case 8:return e.a(2,null)}},e,this,[[2,7]])})),function(e,t,n){return E.apply(this,arguments)})},{key:"rpcBatchSubscribe",value:(b=g(d().m(function e(t){var n,r,i=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.length){e.n=1;break}return e.a(2);case 1:return n=t[0].relay,r={method:Yl(n.protocol).batchSubscribe,params:{topics:t.map(function(e){return e.topic})}},this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r}),e.p=2,e.n=3,us(new Promise(function(e){i.relayer.request(r).catch(function(e){return i.logger.warn(e)}).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again");case 3:return e.n=4,e.v;case 4:e.n=6;break;case 5:e.p=5,e.v,this.relayer.events.emit(dh);case 6:return e.a(2)}},e,this,[[2,5]])})),function(e){return b.apply(this,arguments)})},{key:"rpcBatchFetchMessages",value:(m=g(d().m(function e(t){var n,r,i,o=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.length){e.n=1;break}return e.a(2);case 1:return n=t[0].relay,r={method:Yl(n.protocol).batchFetchMessages,params:{topics:t.map(function(e){return e.topic})}},this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r}),e.p=2,e.n=3,us(new Promise(function(e,t){o.relayer.request(r).catch(function(e){o.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again");case 3:return e.n=4,e.v;case 4:i=e.v,e.n=6;break;case 5:e.p=5,e.v,this.relayer.events.emit(dh);case 6:return e.a(2,i)}},e,this,[[2,5]])})),function(e){return m.apply(this,arguments)})},{key:"rpcUnsubscribe",value:function(e,t,n){var r={method:Yl(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r}),this.relayer.request(r)}},{key:"onSubscribe",value:function(e,t){this.setSubscription(e,Xv(Qv({},t),{id:e})),this.pending.delete(t.topic)}},{key:"onBatchSubscribe",value:function(e){var t=this;e.length&&e.forEach(function(e){t.setSubscription(e.id,Qv({},e)),t.pending.delete(e.topic)})}},{key:"onUnsubscribe",value:(v=g(d().m(function e(t,n,r){return d().w(function(e){for(;;)switch(e.n){case 0:return this.events.removeAllListeners(n),this.hasSubscription(n,t)&&this.deleteSubscription(n,r),e.n=1,this.relayer.messages.del(t);case 1:return e.a(2)}},e,this)})),function(e,t,n){return v.apply(this,arguments)})},{key:"setRelayerSubscriptions",value:(p=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.relayer.core.storage.setItem(this.storageKey,t);case 1:return e.a(2)}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"getRelayerSubscriptions",value:(h=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.relayer.core.storage.getItem(this.storageKey);case 1:return e.a(2,e.v)}},e,this)})),function(){return h.apply(this,arguments)})},{key:"setSubscription",value:function(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}},{key:"addSubscription",value:function(e,t){this.subscriptions.set(e,Qv({},t)),this.topicMap.set(t.topic,e),this.events.emit(Oh,t)}},{key:"getSubscription",value:function(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});var t=this.subscriptions.get(e);if(!t){var n=nf("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw new Error(n)}return t}},{key:"deleteSubscription",value:function(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});var n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Ph,Xv(Qv({},n),{reason:t}))}},{key:"persist",value:(f=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.setRelayerSubscriptions(this.values);case 1:this.events.emit(xh);case 2:return e.a(2)}},e,this)})),function(){return f.apply(this,arguments)})},{key:"onRestart",value:(u=g(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.n){case 0:if(!this.cached.length){e.n=3;break}t=l(this.cached),n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit),r=0;case 1:if(!(r<n)){e.n=3;break}return i=t.splice(0,this.batchSubscribeTopicsLimit),e.n=2,this.batchSubscribe(i);case 2:r++,e.n=1;break;case 3:this.events.emit(_h);case 4:return e.a(2)}},e,this)})),function(){return u.apply(this,arguments)})},{key:"restore",value:(c=g(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getRelayerSubscriptions();case 1:if(!(_(t=e.v)>"u")&&t.length){e.n=2;break}return e.a(2);case 2:if(!this.subscriptions.size){e.n=3;break}throw n=nf("RESTORE_WILL_OVERRIDE",this.name),r=n.message,this.logger.error(r),this.logger.error("".concat(this.name,": ").concat(JSON.stringify(this.values))),new Error(r);case 3:this.cached=t,this.logger.debug("Successfully Restored subscriptions for ".concat(this.name)),this.logger.trace({type:"method",method:"restore",subscriptions:this.values}),e.n=5;break;case 4:e.p=4,i=e.v,this.logger.debug("Failed to Restore subscriptions for ".concat(this.name)),this.logger.error(i);case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return c.apply(this,arguments)})},{key:"batchSubscribe",value:(s=g(d().m(function e(t){var n,r=this;return d().w(function(e){for(;;)switch(e.n){case 0:if(!t.length){e.n=3;break}return e.n=1,this.rpcBatchSubscribe(t);case 1:return n=this,e.n=2,Promise.all(t.map(function(){var e=g(d().m(function e(t){var n,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:return n=Xv,i=Qv({},t),e.n=1,r.getSubscriptionId(t.topic);case 1:return o=e.v,e.a(2,n(i,{id:o}))}},e)}));return function(t){return e.apply(this,arguments)}}()));case 2:n.onBatchSubscribe.call(n,e.v);case 3:return e.a(2)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"batchFetchMessages",value:(a=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:if(t.length){e.n=1;break}return e.a(2);case 1:return this.logger.trace("Fetching batch messages for ".concat(t.length," subscriptions")),e.n=2,this.rpcBatchFetchMessages(t);case 2:if(!(n=e.v)||!n.messages){e.n=4;break}return e.n=3,ms(ue.toMiliseconds(ue.ONE_SECOND));case 3:return e.n=4,this.relayer.handleBatchMessageEvents(n.messages);case 4:return e.a(2)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"onConnect",value:(o=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.restart();case 1:this.reset();case 2:return e.a(2)}},e,this)})),function(){return o.apply(this,arguments)})},{key:"onDisconnect",value:function(){this.onDisable()}},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"restartToComplete",value:(i=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.relayer.connected||this.relayer.connecting){e.n=1;break}return this.cached.push(t),e.n=1,this.relayer.transportOpen();case 1:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"getClientId",value:(r=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.clientId){e.n=2;break}return e.n=1,this.relayer.core.crypto.getClientId();case 1:this.clientId=e.v;case 2:return e.a(2,this.clientId)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getSubscriptionId",value:(n=g(d().m(function e(t){var n,r,i;return d().w(function(e){for(;;)switch(e.n){case 0:return n=Rl,r=t,e.n=1,this.getClientId();case 1:return i=e.v,e.a(2,n(r+i))}},e,this)})),function(e){return n.apply(this,arguments)})}]);var n,r,i,o,a,s,c,u,f,h,p,v,m,b,E,I,O}(Tt),tg=Object.defineProperty,ng=Object.getOwnPropertySymbols,rg=Object.prototype.hasOwnProperty,ig=Object.prototype.propertyIsEnumerable,og=function(e,t,n){return t in e?tg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},ag=function(e,t){for(var n in t||(t={}))rg.call(t,n)&&og(e,n,t[n]);if(ng){var r,i=u(ng(t));try{for(i.s();!(r=i.n()).done;){n=r.value;ig.call(t,n)&&og(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},sg=function(e,t,n){return og(e,"symbol"!=_(t)?t+"":t,n)},cg=function(e){function t(e){var n;return S(this,t),n=y(this,t,[e]),sg(w(n),"protocol","wc"),sg(w(n),"version",2),sg(w(n),"core"),sg(w(n),"logger"),sg(w(n),"events",new N.EventEmitter),sg(w(n),"provider"),sg(w(n),"messages"),sg(w(n),"subscriber"),sg(w(n),"publisher"),sg(w(n),"name","relayer"),sg(w(n),"transportExplicitlyClosed",!1),sg(w(n),"initialized",!1),sg(w(n),"connectionAttemptInProgress",!1),sg(w(n),"relayUrl"),sg(w(n),"projectId"),sg(w(n),"packageName"),sg(w(n),"bundleId"),sg(w(n),"hasExperiencedNetworkDisruption",!1),sg(w(n),"pingTimeout"),sg(w(n),"heartBeatTimeout",ue.toMiliseconds(ue.THIRTY_SECONDS+ue.FIVE_SECONDS)),sg(w(n),"reconnectTimeout"),sg(w(n),"connectPromise"),sg(w(n),"reconnectInProgress",!1),sg(w(n),"requestsInFlight",[]),sg(w(n),"connectTimeout",ue.toMiliseconds(15*ue.ONE_SECOND)),sg(w(n),"request",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.logger.debug("Publishing Request Payload"),o=t.id||jf().toString(),e.n=1,n.toEstablishConnection();case 1:return e.p=1,n.logger.trace({id:o,method:t.method,topic:null==(r=t.params)?void 0:r.topic},"relayer.request - publishing..."),a="".concat(o,":").concat((null==(i=t.params)?void 0:i.tag)||""),n.requestsInFlight.push(a),e.n=2,n.provider.request(t);case 2:return s=e.v,e.a(2,(n.requestsInFlight=n.requestsInFlight.filter(function(e){return e!==a}),s));case 3:throw e.p=3,c=e.v,n.logger.debug("Failed to Publish Request: ".concat(o)),c;case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),sg(w(n),"resetPingTimeout",function(){$a()&&(clearTimeout(n.pingTimeout),n.pingTimeout=setTimeout(function(){var e,t,r,i;try{n.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(r=null==(t=null==(e=n.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||i.call(r)}catch(vS){n.logger.warn(vS,null==vS?void 0:vS.message)}},n.heartBeatTimeout))}),sg(w(n),"onPayloadHandler",function(e){n.onProviderPayload(e),n.resetPingTimeout()}),sg(w(n),"onConnectHandler",function(){n.logger.warn({},"Relayer connected 🛜"),n.startPingTimeout(),n.events.emit(lh)}),sg(w(n),"onDisconnectHandler",function(){n.logger.warn({},"Relayer disconnected 🛑"),n.requestsInFlight=[],n.onProviderDisconnect()}),sg(w(n),"onProviderErrorHandler",function(e){n.logger.fatal("Fatal socket error: ".concat(e.message)),n.events.emit(hh,e),n.logger.fatal("Fatal socket error received, closing transport"),n.transportClose()}),sg(w(n),"registerProviderListeners",function(){n.provider.on(vh,n.onPayloadHandler),n.provider.on(gh,n.onConnectHandler),n.provider.on(yh,n.onDisconnectHandler),n.provider.on(mh,n.onProviderErrorHandler)}),n.core=e.core,n.logger=_(e.logger)<"u"&&"string"!=typeof e.logger?mt(e.logger,n.name):Xe(gt({level:e.logger||"error"})),n.messages=new Av(n.logger,e.core),n.subscriber=new eg(w(n),n.logger),n.publisher=new Mv(w(n),n.logger),n.relayUrl=(null==e?void 0:e.relayUrl)||sh,n.projectId=e.projectId,es()&&("undefined"==typeof global?"undefined":_(global))<"u"&&_(null==global?void 0:global.Platform)<"u"&&"android"===(null==global?void 0:global.Platform.OS)?n.packageName=rs():es()&&("undefined"==typeof global?"undefined":_(global))<"u"&&_(null==global?void 0:global.Platform)<"u"&&"ios"===(null==global?void 0:global.Platform.OS)&&(n.bundleId=rs()),n.provider={},n}return k(t,e),P(t,[{key:"init",value:(R=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.logger.trace("Initialized"),this.registerEventListeners(),e.n=1,Promise.all([this.messages.init(),this.subscriber.init()]);case 1:if(this.initialized=!0,!this.subscriber.hasAnyTopics){e.n=5;break}return e.p=2,e.n=3,this.transportOpen();case 3:e.n=5;break;case 4:e.p=4,t=e.v,this.logger.warn(t,null==t?void 0:t.message);case 5:return e.a(2)}},e,this,[[2,4]])})),function(){return R.apply(this,arguments)})},{key:"context",get:function(){return yt(this.logger)}},{key:"connected",get:function(){var e,t,n;return 1===(null==(n=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:n.readyState)||!1}},{key:"connecting",get:function(){var e,t,n;return 0===(null==(n=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:n.readyState)||void 0!==this.connectPromise||!1}},{key:"publish",value:(T=g(d().m(function e(t,n,r){return d().w(function(e){for(;;)switch(e.n){case 0:return this.isInitialized(),e.n=1,this.publisher.publish(t,n,r);case 1:return e.n=2,this.recordMessageEvent({topic:t,message:n,publishedAt:Date.now(),transportType:Eh},Ih);case 2:return e.a(2)}},e,this)})),function(e,t,n){return T.apply(this,arguments)})},{key:"subscribe",value:(A=g(d().m(function e(t,n){var r,i,o,a,s,c,u,l=this;return d().w(function(e){for(;;)switch(e.n){case 0:if(this.isInitialized(),null!=n&&n.transportType&&"relay"!==(null==n?void 0:n.transportType)){e.n=1;break}return e.n=1,this.toEstablishConnection();case 1:return a=_(null==(r=null==n?void 0:n.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=null==n?void 0:n.internal)?void 0:i.throwOnFailedPublish),s=(null==(o=this.subscriber.topicMap.get(t))?void 0:o[0])||"",u=function(e){e.topic===t&&(l.subscriber.off(Oh,u),c())},e.n=2,Promise.all([new Promise(function(e){c=e,l.subscriber.on(Oh,u)}),new Promise(function(){var e=g(d().m(function e(r,i){var o;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l.subscriber.subscribe(t,ag({internal:{throwOnFailedPublish:a}},n)).catch(function(e){a&&i(e)});case 1:if(o=e.v){e.n=2;break}o=s;case 2:s=o,r();case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}())]);case 2:return e.a(2,s)}},e,this)})),function(e,t){return A.apply(this,arguments)})},{key:"unsubscribe",value:(x=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return this.isInitialized(),e.n=1,this.subscriber.unsubscribe(t,n);case 1:return e.a(2)}},e,this)})),function(e,t){return x.apply(this,arguments)})},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"transportDisconnect",value:(O=g(d().m(function e(){var t=this;return d().w(function(e){for(;;)switch(e.n){case 0:if(!this.provider.disconnect||!this.hasExperiencedNetworkDisruption&&!this.connected){e.n=2;break}return e.n=1,us(this.provider.disconnect(),2e3,"provider.disconnect()").catch(function(){return t.onProviderDisconnect()});case 1:e.n=3;break;case 2:this.onProviderDisconnect();case 3:return e.a(2)}},e,this)})),function(){return O.apply(this,arguments)})},{key:"transportClose",value:(I=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return this.transportExplicitlyClosed=!0,e.n=1,this.transportDisconnect();case 1:return e.a(2)}},e,this)})),function(){return I.apply(this,arguments)})},{key:"transportOpen",value:(E=g(d().m(function e(t){var n=this;return d().w(function(e){for(;;)switch(e.n){case 0:if(this.subscriber.hasAnyTopics){e.n=1;break}return this.logger.warn("Starting WS connection skipped because the client has no topics to work with."),e.a(2);case 1:if(!this.connectPromise){e.n=3;break}return this.logger.debug({},"Waiting for existing connection attempt to resolve..."),e.n=2,this.connectPromise;case 2:this.logger.debug({},"Existing connection attempt resolved"),e.n=4;break;case 3:return this.connectPromise=new Promise(function(){var e=g(d().m(function e(r,i){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n.connect(t).then(r).catch(i).finally(function(){n.connectPromise=void 0});case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),e.n=4,this.connectPromise;case 4:if(this.connected){e.n=5;break}throw new Error("Couldn't establish socket connection to the relay server: ".concat(this.relayUrl));case 5:return e.a(2)}},e,this)})),function(e){return E.apply(this,arguments)})},{key:"restartTransport",value:(b=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress){e.n=3;break}return this.relayUrl=t||this.relayUrl,e.n=1,this.confirmOnlineStateOrThrow();case 1:return e.n=2,this.transportClose();case 2:return e.n=3,this.transportOpen();case 3:return e.a(2)}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"confirmOnlineStateOrThrow",value:(m=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,lf();case 1:if(e.v){e.n=2;break}throw new Error("No internet connection detected. Please restart your network and try again.");case 2:return e.a(2)}},e)})),function(){return m.apply(this,arguments)})},{key:"handleBatchMessageEvents",value:(v=g(d().m(function e(t){var n,r,i,o,a,s;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(0!==(null==t?void 0:t.length)){e.n=1;break}return this.logger.trace("Batch message events is empty. Ignoring..."),e.a(2);case 1:n=t.sort(function(e,t){return e.publishedAt-t.publishedAt}),this.logger.debug("Batch of ".concat(n.length," message events sorted")),r=u(n),e.p=2,r.s();case 3:if((i=r.n()).done){e.n=8;break}return o=i.value,e.p=4,e.n=5,this.onMessageEvent(o);case 5:e.n=7;break;case 6:e.p=6,a=e.v,this.logger.warn(a,"Error while processing batch message event: "+(null==a?void 0:a.message));case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,s=e.v,r.e(s);case 10:return e.p=10,r.f(),e.f(10);case 11:this.logger.trace("Batch of ".concat(n.length," message events processed"));case 12:return e.a(2)}},e,this,[[4,6],[2,9,10,11]])})),function(e){return v.apply(this,arguments)})},{key:"onLinkMessageEvent",value:(p=g(d().m(function e(t,n){var r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(r=t.topic,n.sessionExists){e.n=1;break}return i=hs(ue.FIVE_MINUTES),o={topic:r,expiry:i,relay:{protocol:"irn"},active:!1},e.n=1,this.core.pairing.pairings.set(r,o);case 1:return this.events.emit(ch,t),e.n=2,this.recordMessageEvent(t,kh);case 2:return e.a(2)}},e,this)})),function(e,t){return p.apply(this,arguments)})},{key:"connect",value:(h=g(d().m(function e(t){var n,r,i,o=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.confirmOnlineStateOrThrow();case 1:if(!t||t===this.relayUrl){e.n=2;break}return this.relayUrl=t,e.n=2,this.transportDisconnect();case 2:this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1,n=1;case 3:if(!(n<6)){e.n=15;break}if(e.p=4,!this.transportExplicitlyClosed){e.n=5;break}return e.a(3,15);case 5:return this.logger.debug({},"Connecting to ".concat(this.relayUrl,", attempt: ").concat(n,"...")),e.n=6,this.createProvider();case 6:return e.n=7,new Promise(function(){var e=g(d().m(function e(t,n){var r;return d().w(function(e){for(;;)switch(e.n){case 0:return r=function(){n(new Error("Connection interrupted while trying to subscribe"))},o.provider.once(yh,r),e.n=1,us(new Promise(function(e,t){o.provider.connect().then(e).catch(t)}),o.connectTimeout,"Socket stalled when trying to connect to ".concat(o.relayUrl)).catch(function(e){n(e)}).finally(function(){o.provider.off(yh,r),clearTimeout(o.reconnectTimeout)});case 1:return e.n=2,new Promise(function(){var e=g(d().m(function e(t,n){var r;return d().w(function(e){for(;;)switch(e.n){case 0:return r=function(){n(new Error("Connection interrupted while trying to subscribe"))},o.provider.once(yh,r),e.n=1,o.subscriber.start().then(t).catch(n).finally(function(){o.provider.off(yh,r)});case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 2:o.hasExperiencedNetworkDisruption=!1,t();case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 7:e.n=10;break;case 8:return e.p=8,i=e.v,e.n=9,this.subscriber.stop();case 9:r=i,this.logger.warn({},r.message),this.hasExperiencedNetworkDisruption=!0;case 10:return e.p=10,this.connectionAttemptInProgress=!1,e.f(10);case 11:if(!this.connected){e.n=12;break}return this.logger.debug({},"Connected to ".concat(this.relayUrl," successfully on attempt: ").concat(n)),e.a(3,15);case 12:return e.n=13,new Promise(function(e){return setTimeout(e,ue.toMiliseconds(1*n))});case 13:n++;case 14:e.n=3;break;case 15:return e.a(2)}},e,this,[[4,8,10,11]])})),function(e){return h.apply(this,arguments)})},{key:"startPingTimeout",value:function(){var e,t,n,r,i,o=this;if($a())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(i=null==(r=null==(n=this.provider)?void 0:n.connection)?void 0:r.socket)||i.on("ping",function(){o.resetPingTimeout()})),this.resetPingTimeout()}catch(vS){this.logger.warn(vS,null==vS?void 0:vS.message)}}},{key:"createProvider",value:(f=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:return this.provider.connection&&this.unregisterProviderListeners(),e.n=1,this.core.crypto.signJWT(this.relayUrl);case 1:t=e.v,this.provider=new Yf(new Xf(os({sdkVersion:wh,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners();case 2:return e.a(2)}},e,this)})),function(){return f.apply(this,arguments)})},{key:"recordMessageEvent",value:(l=g(d().m(function e(t,n){var r,i;return d().w(function(e){for(;;)switch(e.n){case 0:return r=t.topic,i=t.message,e.n=1,this.messages.set(r,i,n);case 1:return e.a(2)}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"shouldIgnoreMessageEvent",value:(c=g(d().m(function e(t){var n,r,i;return d().w(function(e){for(;;)switch(e.n){case 0:if(n=t.topic,(r=t.message)&&0!==r.length){e.n=1;break}return e.a(2,(this.logger.warn("Ignoring invalid/empty message: ".concat(r)),!0));case 1:return e.n=2,this.subscriber.isKnownTopic(n);case 2:if(e.v){e.n=3;break}return e.a(2,(this.logger.warn("Ignoring message for unknown topic ".concat(n)),!0));case 3:return i=this.messages.has(n,r),e.a(2,(i&&this.logger.warn("Ignoring duplicate message: ".concat(r)),i))}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"onProviderPayload",value:(s=g(d().m(function e(t){var n,r,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),!Kf(t)){e.n=4;break}if(t.method.endsWith("_subscription")){e.n=1;break}return e.a(2);case 1:return n=t.params,r=n.data,i=r.topic,o=r.message,a=r.publishedAt,s=r.attestation,c={topic:i,message:o,publishedAt:a,transportType:Eh,attestation:s},this.logger.debug("Emitting Relayer Payload"),this.logger.trace(ag({type:"event",event:n.id},c)),this.events.emit(n.id,c),e.n=2,this.acknowledgePayload(t);case 2:return e.n=3,this.onMessageEvent(c);case 3:e.n=5;break;case 4:Wf(t)&&this.events.emit(uh,t);case 5:return e.a(2)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"onMessageEvent",value:(a=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.shouldIgnoreMessageEvent(t);case 1:if(e.v){e.n=3;break}return e.n=2,this.recordMessageEvent(t,kh);case 2:this.events.emit(ch,t);case 3:return e.a(2)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"acknowledgePayload",value:(o=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return n=Df(t.id,!0),e.n=1,this.provider.connection.send(n);case 1:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"unregisterProviderListeners",value:function(){this.provider.off(vh,this.onPayloadHandler),this.provider.off(gh,this.onConnectHandler),this.provider.off(yh,this.onDisconnectHandler),this.provider.off(mh,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}},{key:"registerEventListeners",value:(i=g(d().m(function e(){var t,n=this;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,lf();case 1:t=e.v,hf(function(){var e=g(d().m(function e(r){return d().w(function(e){for(;;)switch(e.n){case 0:if(t===r){e.n=4;break}if(t=r,!r){e.n=2;break}return e.n=1,n.transportOpen().catch(function(e){return n.logger.error(e,null==e?void 0:e.message)});case 1:e.n=4;break;case 2:return n.hasExperiencedNetworkDisruption=!0,e.n=3,n.transportDisconnect();case 3:n.transportExplicitlyClosed=!1;case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),this.core.heartbeat.on(de.pulse,g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.transportExplicitlyClosed||n.connected||!df()){e.n=5;break}return e.p=1,e.n=2,n.confirmOnlineStateOrThrow();case 2:return e.n=3,n.transportOpen();case 3:e.n=5;break;case 4:e.p=4,t=e.v,n.logger.warn(t,null==t?void 0:t.message);case 5:return e.a(2)}},e,null,[[1,4]])})));case 2:return e.a(2)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"onProviderDisconnect",value:(r=g(d().m(function e(){var t=this;return d().w(function(e){for(;;)switch(e.n){case 0:if(clearTimeout(this.pingTimeout),this.events.emit(fh),this.connectionAttemptInProgress=!1,this.reconnectInProgress){e.n=2;break}return this.reconnectInProgress=!0,e.n=1,this.subscriber.stop();case 1:this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.transportOpen().catch(function(e){return t.logger.error(e,null==e?void 0:e.message)});case 1:t.reconnectTimeout=void 0,t.reconnectInProgress=!1;case 2:return e.a(2)}},e)})),ue.toMiliseconds(.1))));case 2:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"toEstablishConnection",value:(n=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.confirmOnlineStateOrThrow();case 1:if(this.connected){e.n=4;break}if(!this.connectPromise){e.n=3;break}return e.n=2,this.connectPromise;case 2:case 4:return e.a(2);case 3:return e.n=4,this.connect()}},e,this)})),function(){return n.apply(this,arguments)})}]);var n,r,i,o,a,s,c,l,f,h,p,v,m,b,E,I,O,x,A,T,R}(_t);function ug(){}function lg(e){if(!e||"object"!=_(e))return!1;var t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function fg(e){return Object.getOwnPropertySymbols(e).filter(function(t){return Object.prototype.propertyIsEnumerable.call(e,t)})}function hg(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var dg="[object Arguments]",pg="[object Object]";function vg(e,t,n,r,i,o,a){var s=a(e,t,n,r,i,o);if(void 0!==s)return s;if(_(e)==_(t))switch(_(e)){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return gg(e,t,o,a)}return gg(e,t,o,a)}function gg(e,t,n,i){if(Object.is(e,t))return!0;var o=hg(e),a=hg(t);if(o===dg&&(o=pg),a===dg&&(a=pg),o!==a)return!1;switch(o){case"[object String]":return e.toString()===t.toString();case"[object Number]":return function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}(e.valueOf(),t.valueOf());case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(e.valueOf(),t.valueOf());case"[object RegExp]":return e.source===t.source&&e.flags===t.flags;case"[object Function]":return e===t}var s=(n=null!=n?n:new Map).get(e),c=n.get(t);if(null!=s&&null!=c)return s===t;n.set(e,t),n.set(t,e);try{switch(o){case"[object Map]":if(e.size!==t.size)return!1;var f,h=u(e.entries());try{for(h.s();!(f=h.n()).done;){var d=r(f.value,2),p=d[0],v=d[1];if(!t.has(p)||!vg(v,t.get(p),p,e,t,n,i))return!1}}catch(x){h.e(x)}finally{h.f()}return!0;case"[object Set]":if(e.size!==t.size)return!1;for(var g,y=Array.from(e.values()),m=Array.from(t.values()),w=function(){var r=y[b],o=m.findIndex(function(o){return vg(r,o,void 0,e,t,n,i)});if(-1===o)return{v:!1};m.splice(o,1)},b=0;b<y.length;b++)if(g=w())return g.v;return!0;case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if(("undefined"==typeof Buffer?"undefined":_(Buffer))<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(var E=0;E<e.length;E++)if(!vg(e[E],t[E],E,e,t,n,i))return!1;return!0;case"[object ArrayBuffer]":return e.byteLength===t.byteLength&&gg(new Uint8Array(e),new Uint8Array(t),n,i);case"[object DataView]":return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&gg(new Uint8Array(e),new Uint8Array(t),n,i);case"[object Error]":return e.name===t.name&&e.message===t.message;case pg:if(!(gg(e.constructor,t.constructor,n,i)||lg(e)&&lg(t)))return!1;var k=[].concat(l(Object.keys(e)),l(fg(e))),I=[].concat(l(Object.keys(t)),l(fg(t)));if(k.length!==I.length)return!1;for(var S=0;S<k.length;S++){var O=k[S],P=e[O];if(!Object.hasOwn(t,O))return!1;if(!vg(P,t[O],O,e,t,n,i))return!1}return!0;default:return!1}}finally{n.delete(e),n.delete(t)}}function yg(e,t){return function(e,t,n){return vg(e,t,void 0,void 0,void 0,void 0,n)}(e,t,ug)}var mg=Object.defineProperty,wg=Object.getOwnPropertySymbols,bg=Object.prototype.hasOwnProperty,Eg=Object.prototype.propertyIsEnumerable,kg=function(e,t,n){return t in e?mg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Ig=function(e,t){for(var n in t||(t={}))bg.call(t,n)&&kg(e,n,t[n]);if(wg){var r,i=u(wg(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Eg.call(t,n)&&kg(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},Sg=function(e,t,n){return kg(e,"symbol"!=_(t)?t+"":t,n)},Og=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:th,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return S(this,t),(i=y(this,t,[e,n,r,o])).core=e,i.logger=n,i.name=r,Sg(w(i),"map",new Map),Sg(w(i),"version","0.3"),Sg(w(i),"cached",[]),Sg(w(i),"initialized",!1),Sg(w(i),"getKey"),Sg(w(i),"storagePrefix",th),Sg(w(i),"recentlyDeleted",[]),Sg(w(i),"recentlyDeletedLimit",200),Sg(w(i),"init",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(i.initialized){e.n=2;break}return i.logger.trace("Initialized"),e.n=1,i.restore();case 1:i.cached.forEach(function(e){i.getKey&&null!==e&&!of(e)?i.map.set(i.getKey(e),e):sf(e)?i.map.set(e.id,e):cf(e)&&i.map.set(e.topic,e)}),i.cached=[],i.initialized=!0;case 2:return e.a(2)}},e)}))),Sg(w(i),"set",function(){var e=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:if(i.isInitialized(),!i.map.has(t)){e.n=2;break}return e.n=1,i.update(t,n);case 1:e.n=3;break;case 2:return i.logger.debug("Setting value"),i.logger.trace({type:"method",method:"set",key:t,value:n}),i.map.set(t,n),e.n=3,i.persist();case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),Sg(w(i),"get",function(e){return i.isInitialized(),i.logger.debug("Getting value"),i.logger.trace({type:"method",method:"get",key:e}),i.getData(e)}),Sg(w(i),"getAll",function(e){return i.isInitialized(),e?i.values.filter(function(t){return Object.keys(e).every(function(n){return yg(t[n],e[n])})}):i.values}),Sg(w(i),"update",function(){var e=g(d().m(function e(t,n){var r;return d().w(function(e){for(;;)switch(e.n){case 0:return i.isInitialized(),i.logger.debug("Updating value"),i.logger.trace({type:"method",method:"update",key:t,update:n}),r=Ig(Ig({},i.getData(t)),n),i.map.set(t,r),e.n=1,i.persist();case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),Sg(w(i),"delete",function(){var e=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:if(i.isInitialized(),!i.map.has(t)){e.n=1;break}return i.logger.debug("Deleting value"),i.logger.trace({type:"method",method:"delete",key:t,reason:n}),i.map.delete(t),i.addToRecentlyDeleted(t),e.n=1,i.persist();case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),i.logger=mt(n,i.name),i.storagePrefix=o,i.getKey=a,i}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"length",get:function(){return this.map.size}},{key:"keys",get:function(){return Array.from(this.map.keys())}},{key:"values",get:function(){return Array.from(this.map.values())}},{key:"addToRecentlyDeleted",value:function(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}},{key:"setDataStore",value:(o=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.setItem(this.storageKey,t);case 1:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getDataStore",value:(i=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.getItem(this.storageKey);case 1:return e.a(2,e.v)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getData",value:function(e){var t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){var n=nf("MISSING_OR_INVALID","Record was recently deleted - ".concat(this.name,": ").concat(e)).message;throw this.logger.error(n),new Error(n)}var r=nf("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw this.logger.error(r),new Error(r)}return t}},{key:"persist",value:(r=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.setDataStore(this.values);case 1:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"restore",value:(n=g(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getDataStore();case 1:if(!(_(t=e.v)>"u")&&t.length){e.n=2;break}return e.a(2);case 2:if(!this.map.size){e.n=3;break}throw n=nf("RESTORE_WILL_OVERRIDE",this.name),r=n.message,this.logger.error(r),new Error(r);case 3:this.cached=t,this.logger.debug("Successfully Restored value for ".concat(this.name)),this.logger.trace({type:"method",method:"restore",value:this.values}),e.n=5;break;case 4:e.p=4,i=e.v,this.logger.debug("Failed to Restore value for ".concat(this.name)),this.logger.error(i);case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return n.apply(this,arguments)})},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]);var n,r,i,o}(At),Pg=Object.defineProperty,xg=function(e,t,n){return function(e,t,n){return t in e?Pg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},_g=function(){return P(function e(t,n){var r=this;S(this,e),this.core=t,this.logger=n,xg(this,"name","pairing"),xg(this,"version","0.3"),xg(this,"events",new R),xg(this,"pairings"),xg(this,"initialized",!1),xg(this,"storagePrefix",th),xg(this,"ignoredPayloadTypes",[1]),xg(this,"registeredMethods",[]),xg(this,"init",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(r.initialized){e.n=3;break}return e.n=1,r.pairings.init();case 1:return e.n=2,r.cleanup();case 2:r.registerRelayerEvents(),r.registerExpirerEvents(),r.initialized=!0,r.logger.trace("Initialized");case 3:return e.a(2)}},e)}))),xg(this,"register",function(e){var t=e.methods;r.isInitialized(),r.registeredMethods=l(new Set([].concat(l(r.registeredMethods),l(t))))}),xg(this,"create",function(){var e=g(d().m(function e(t){var n,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:return r.isInitialized(),n=Tl(),e.n=1,r.core.crypto.setSymKey(n);case 1:return i=e.v,o=hs(ue.FIVE_MINUTES),s={topic:i,expiry:o,relay:a={protocol:"irn"},active:!1,methods:null==t?void 0:t.methods},c=$l({protocol:r.core.protocol,version:r.core.version,topic:i,symKey:n,relay:a,expiryTimestamp:o,methods:null==t?void 0:t.methods}),r.events.emit(Th,s),r.core.expirer.set(i,o),e.n=2,r.pairings.set(i,s);case 2:return e.n=3,r.core.relayer.subscribe(i,{transportType:null==t?void 0:t.transportType});case 3:return e.a(2,{topic:i,uri:c})}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"pair",function(){var e=g(d().m(function e(t){var n,i,o,a,s,c,u,l,f,h,p;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.isInitialized(),n=r.core.eventClient.createEvent({properties:{topic:null==t?void 0:t.uri,trace:[Wh]}}),r.isValidPair(t,n),i=Ql(t.uri),o=i.topic,a=i.symKey,s=i.relay,c=i.expiryTimestamp,u=i.methods,n.props.properties.topic=o,n.addTrace(Gh),n.addTrace(Zh),!r.pairings.keys.includes(o)){e.n=2;break}if(l=r.pairings.get(o),n.addTrace(Xh),!l.active){e.n=1;break}throw n.setError(id),new Error("Pairing already exists: ".concat(o,". Please try again with a new connection URI."));case 1:n.addTrace($h);case 2:return f=c||hs(ue.FIVE_MINUTES),h={topic:o,relay:s,expiry:f,active:!1,methods:u},r.core.expirer.set(o,f),e.n=3,r.pairings.set(o,h);case 3:if(n.addTrace(Yh),!t.activatePairing){e.n=4;break}return e.n=4,r.activate({topic:o});case 4:if(r.events.emit(Th,h),n.addTrace(ed),r.core.crypto.keychain.has(o)){e.n=5;break}return e.n=5,r.core.crypto.setSymKey(a,o);case 5:return n.addTrace(Jh),e.p=6,e.n=7,r.core.relayer.confirmOnlineStateOrThrow();case 7:e.n=9;break;case 8:e.p=8,e.v,n.setError(nd);case 9:return e.p=9,e.n=10,r.core.relayer.subscribe(o,{relay:s});case 10:e.n=12;break;case 11:throw e.p=11,p=e.v,n.setError(od),p;case 12:return e.a(2,(n.addTrace(Qh),h))}},e,null,[[9,11],[6,8]])}));return function(t){return e.apply(this,arguments)}}()),xg(this,"activate",function(){var e=g(d().m(function e(t){var n,i;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.topic,r.isInitialized(),i=hs(ue.FIVE_MINUTES),r.core.expirer.set(n,i),e.n=1,r.pairings.update(n,{active:!0,expiry:i});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"ping",function(){var e=g(d().m(function e(t){var n,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:return r.isInitialized(),e.n=1,r.isValidPing(t);case 1:if(r.logger.warn("ping() is deprecated and will be removed in the next major release."),n=t.topic,!r.pairings.keys.includes(n)){e.n=3;break}return e.n=2,r.sendRequest(n,"wc_pairingPing",{});case 2:return i=e.v,o=cs(),a=o.done,s=o.resolve,c=o.reject,r.events.once(ps("pairing_ping",i),function(e){var t=e.error;t?c(t):s()}),e.n=3,a();case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"updateExpiry",function(){var e=g(d().m(function e(t){var n,i;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.topic,i=t.expiry,r.isInitialized(),e.n=1,r.pairings.update(n,{expiry:i});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"updateMetadata",function(){var e=g(d().m(function e(t){var n,i;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.topic,i=t.metadata,r.isInitialized(),e.n=1,r.pairings.update(n,{peerMetadata:i});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"getPairings",function(){return r.isInitialized(),r.pairings.values}),xg(this,"disconnect",function(){var e=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return r.isInitialized(),e.n=1,r.isValidDisconnect(t);case 1:if(n=t.topic,!r.pairings.keys.includes(n)){e.n=3;break}return e.n=2,r.sendRequest(n,"wc_pairingDelete",rf("USER_DISCONNECTED"));case 2:return e.n=3,r.deletePairing(n);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"formatUriFromPairing",function(e){r.isInitialized();var t=e.topic,n=e.relay,i=e.expiry,o=e.methods,a=r.core.crypto.keychain.get(t);return $l({protocol:r.core.protocol,version:r.core.version,topic:t,symKey:a,relay:n,expiryTimestamp:i,methods:o})}),xg(this,"sendRequest",function(){var e=g(d().m(function e(t,n,i){var o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:return o=Lf(n,i),e.n=1,r.core.crypto.encode(t,o);case 1:return a=e.v,s=Ah[n].req,e.a(2,(r.core.history.set(t,o),r.core.relayer.publish(t,a,s),o.id))}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()),xg(this,"sendResult",function(){var e=g(d().m(function e(t,n,i){var o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:return o=Df(t,i),e.n=1,r.core.crypto.encode(n,o);case 1:return a=e.v,e.n=2,r.core.history.get(n,t);case 2:return s=e.v.request.method,c=Ah[s].res,e.n=3,r.core.relayer.publish(n,a,c);case 3:return e.n=4,r.core.history.resolve(o);case 4:return e.a(2)}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()),xg(this,"sendError",function(){var e=g(d().m(function e(t,n,i){var o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:return o=qf(t,i),e.n=1,r.core.crypto.encode(n,o);case 1:return a=e.v,e.n=2,r.core.history.get(n,t);case 2:return s=e.v.request.method,c=Ah[s]?Ah[s].res:Ah.unregistered_method.res,e.n=3,r.core.relayer.publish(n,a,c);case 3:return e.n=4,r.core.history.resolve(o);case 4:return e.a(2)}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()),xg(this,"deletePairing",function(){var e=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.core.relayer.unsubscribe(t);case 1:return e.n=2,Promise.all([r.pairings.delete(t,rf("USER_DISCONNECTED")),r.core.crypto.deleteSymKey(t),n?Promise.resolve():r.core.expirer.del(t)]);case 2:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),xg(this,"cleanup",g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:return t=r.pairings.getAll().filter(function(e){return ds(e.expiry)}),e.n=1,Promise.all(t.map(function(e){return r.deletePairing(e.topic)}));case 1:return e.a(2)}},e)}))),xg(this,"onRelayEventRequest",function(){var e=g(d().m(function e(t){var n,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:n=t.topic,i=t.payload,o=i.method,e.n="wc_pairingPing"===o?1:"wc_pairingDelete"===o?3:5;break;case 1:return e.n=2,r.onPairingPingRequest(n,i);case 2:case 4:case 6:return e.a(2,e.v);case 3:return e.n=4,r.onPairingDeleteRequest(n,i);case 5:return e.n=6,r.onUnknownRpcMethodRequest(n,i);case 7:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"onRelayEventResponse",function(){var e=g(d().m(function e(t){var n,i,o,a;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.topic,i=t.payload,e.n=1,r.core.history.get(n,i.id);case 1:o=e.v.request.method,a=o,e.n="wc_pairingPing"===a?2:3;break;case 2:return e.a(2,r.onPairingPingResponse(n,i));case 3:return e.a(2,r.onUnknownRpcMethodResponse(o));case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"onPairingPingRequest",function(){var e=g(d().m(function e(t,n){var i,o;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=n.id,e.p=1,r.isValidPing({topic:t}),e.n=2,r.sendResult(i,t,!0);case 2:r.events.emit(Bh,{id:i,topic:t}),e.n=5;break;case 3:return e.p=3,o=e.v,e.n=4,r.sendError(i,t,o);case 4:r.logger.error(o);case 5:return e.a(2)}},e,null,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()),xg(this,"onPairingPingResponse",function(e,t){var n=t.id;setTimeout(function(){Gf(t)?r.events.emit(ps("pairing_ping",n),{}):Zf(t)&&r.events.emit(ps("pairing_ping",n),{error:t.error})},500)}),xg(this,"onPairingDeleteRequest",function(){var e=g(d().m(function e(t,n){var i,o;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=n.id,e.p=1,r.isValidDisconnect({topic:t}),e.n=2,r.deletePairing(t);case 2:r.events.emit(Rh,{id:i,topic:t}),e.n=5;break;case 3:return e.p=3,o=e.v,e.n=4,r.sendError(i,t,o);case 4:r.logger.error(o);case 5:return e.a(2)}},e,null,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()),xg(this,"onUnknownRpcMethodRequest",function(){var e=g(d().m(function e(t,n){var i,o,a,s;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=n.id,o=n.method,e.p=1,!r.registeredMethods.includes(o)){e.n=2;break}return e.a(2);case 2:return a=rf("WC_METHOD_UNSUPPORTED",o),e.n=3,r.sendError(i,t,a);case 3:r.logger.error(a),e.n=6;break;case 4:return e.p=4,s=e.v,e.n=5,r.sendError(i,t,s);case 5:r.logger.error(s);case 6:return e.a(2)}},e,null,[[1,4]])}));return function(t,n){return e.apply(this,arguments)}}()),xg(this,"onUnknownRpcMethodResponse",function(e){r.registeredMethods.includes(e)||r.logger.error(rf("WC_METHOD_UNSUPPORTED",e))}),xg(this,"isValidPair",function(e,t){var n;if(!uf(e)){var r=nf("MISSING_OR_INVALID","pair() params: ".concat(e)).message;throw t.setError(rd),new Error(r)}if(!function(e){function t(e){try{return _(new URL(e))<"u"}catch(t){return!1}}try{if(af(e))return!!t(e)||t(ys(e))}catch(n){}return!1}(e.uri)){var i=nf("MISSING_OR_INVALID","pair() uri: ".concat(e.uri)).message;throw t.setError(rd),new Error(i)}var o=Ql(null==e?void 0:e.uri);if(null==(n=null==o?void 0:o.relay)||!n.protocol){var a=nf("MISSING_OR_INVALID","pair() uri#relay-protocol").message;throw t.setError(rd),new Error(a)}if(null==o||!o.symKey){var s=nf("MISSING_OR_INVALID","pair() uri#symKey").message;throw t.setError(rd),new Error(s)}if(null!=o&&o.expiryTimestamp&&ue.toMiliseconds(null==o?void 0:o.expiryTimestamp)<Date.now()){t.setError(ad);var c=nf("EXPIRED","pair() URI has expired. Please try again with a new connection URI.").message;throw new Error(c)}}),xg(this,"isValidPing",function(){var e=g(d().m(function e(t){var n,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(uf(t)){e.n=1;break}throw n=nf("MISSING_OR_INVALID","ping() params: ".concat(t)),i=n.message,new Error(i);case 1:return o=t.topic,e.n=2,r.isValidPairingTopic(o);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"isValidDisconnect",function(){var e=g(d().m(function e(t){var n,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(uf(t)){e.n=1;break}throw n=nf("MISSING_OR_INVALID","disconnect() params: ".concat(t)),i=n.message,new Error(i);case 1:return o=t.topic,e.n=2,r.isValidPairingTopic(o);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),xg(this,"isValidPairingTopic",function(){var e=g(d().m(function e(t){var n,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:if(af(t)){e.n=1;break}throw n=nf("MISSING_OR_INVALID","pairing topic should be a string: ".concat(t)),i=n.message,new Error(i);case 1:if(r.pairings.keys.includes(t)){e.n=2;break}throw o=nf("NO_MATCHING_KEY","pairing topic doesn't exist: ".concat(t)),a=o.message,new Error(a);case 2:if(!ds(r.pairings.get(t).expiry)){e.n=4;break}return e.n=3,r.deletePairing(t);case 3:throw s=nf("EXPIRED","pairing topic: ".concat(t)),c=s.message,new Error(c);case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),this.core=t,this.logger=mt(n,this.name),this.pairings=new Og(this.core,this.logger,this.name,this.storagePrefix)},[{key:"context",get:function(){return yt(this.logger)}},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"registerRelayerEvents",value:function(){var e=this;this.core.relayer.on(ch,function(){var t=g(d().m(function t(n){var r,i,o,a,s;return d().w(function(t){for(;;)switch(t.p=t.n){case 0:if(r=n.topic,i=n.message,o=n.transportType,!e.pairings.keys.includes(r)||o===bh||e.ignoredPayloadTypes.includes(e.core.crypto.getPayloadType(i))){t.n=10;break}return t.p=1,t.n=2,e.core.crypto.decode(r,i);case 2:if(!Kf(a=t.v)){t.n=4;break}return e.core.history.set(r,a),t.n=3,e.onRelayEventRequest({topic:r,payload:a});case 3:t.n=7;break;case 4:if(!Wf(a)){t.n=7;break}return t.n=5,e.core.history.resolve(a);case 5:return t.n=6,e.onRelayEventResponse({topic:r,payload:a});case 6:e.core.history.delete(r,a.id);case 7:return t.n=8,e.core.relayer.messages.ack(r,i);case 8:t.n=10;break;case 9:t.p=9,s=t.v,e.logger.error(s);case 10:return t.a(2)}},t,null,[[1,9]])}));return function(e){return t.apply(this,arguments)}}())}},{key:"registerExpirerEvents",value:function(){var e=this;this.core.expirer.on(Mh,function(){var t=g(d().m(function t(n){var r,i;return d().w(function(t){for(;;)switch(t.n){case 0:if(r=fs(n.target),i=r.topic,!(i&&e.pairings.keys.includes(i))){t.n=2;break}return t.n=1,e.deletePairing(i,!0);case 1:e.events.emit(Nh,{topic:i});case 2:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}())}}])}(),Ag=Object.defineProperty,Tg=function(e,t,n){return function(e,t,n){return t in e?Ag(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},Ng=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n])).core=e,r.logger=n,Tg(w(r),"records",new Map),Tg(w(r),"events",new N.EventEmitter),Tg(w(r),"name","history"),Tg(w(r),"version","0.3"),Tg(w(r),"cached",[]),Tg(w(r),"initialized",!1),Tg(w(r),"storagePrefix",th),Tg(w(r),"init",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(r.initialized){e.n=2;break}return r.logger.trace("Initialized"),e.n=1,r.restore();case 1:r.cached.forEach(function(e){return r.records.set(e.id,e)}),r.cached=[],r.registerEventListeners(),r.initialized=!0;case 2:return e.a(2)}},e)}))),Tg(w(r),"set",function(e,t,n){if(r.isInitialized(),r.logger.debug("Setting JSON-RPC request history record"),r.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:n}),!r.records.has(t.id)){var i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:n,expiry:hs(ue.THIRTY_DAYS)};r.records.set(i.id,i),r.persist(),r.events.emit(Ch,i)}}),Tg(w(r),"resolve",function(){var e=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:if(r.isInitialized(),r.logger.debug("Updating JSON-RPC response history record"),r.logger.trace({type:"method",method:"update",response:t}),r.records.has(t.id)){e.n=1;break}return e.a(2);case 1:return e.n=2,r.getRecord(t.id);case 2:_((n=e.v).response)>"u"&&(n.response=Zf(t)?{error:t.error}:{result:t.result},r.records.set(n.id,n),r.persist(),r.events.emit(Uh,n));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),Tg(w(r),"get",function(){var e=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return r.isInitialized(),r.logger.debug("Getting record"),r.logger.trace({type:"method",method:"get",topic:t,id:n}),e.n=1,r.getRecord(n);case 1:return e.a(2,e.v)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),Tg(w(r),"delete",function(e,t){r.isInitialized(),r.logger.debug("Deleting record"),r.logger.trace({type:"method",method:"delete",id:t}),r.values.forEach(function(n){if(n.topic===e){if(_(t)<"u"&&n.id!==t)return;r.records.delete(n.id),r.events.emit(jh,n)}}),r.persist()}),Tg(w(r),"exists",function(){var e=g(d().m(function e(t,n){var i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(r.isInitialized(),!r.records.has(n)){e.n=2;break}return e.n=1,r.getRecord(n);case 1:o=e.v.topic,i=o===t,e.n=3;break;case 2:i=!1;case 3:return e.a(2,i)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),Tg(w(r),"on",function(e,t){r.events.on(e,t)}),Tg(w(r),"once",function(e,t){r.events.once(e,t)}),Tg(w(r),"off",function(e,t){r.events.off(e,t)}),Tg(w(r),"removeListener",function(e,t){r.events.removeListener(e,t)}),r.logger=mt(n,r.name),r}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"size",get:function(){return this.records.size}},{key:"keys",get:function(){return Array.from(this.records.keys())}},{key:"values",get:function(){return Array.from(this.records.values())}},{key:"pending",get:function(){var e=[];return this.values.forEach(function(t){if(!(_(t.response)<"u")){var n={topic:t.topic,request:Lf(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}}),e}},{key:"setJsonRpcRecords",value:(o=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.setItem(this.storageKey,t);case 1:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getJsonRpcRecords",value:(i=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.getItem(this.storageKey);case 1:return e.a(2,e.v)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getRecord",value:function(e){this.isInitialized();var t=this.records.get(e);if(!t){var n=nf("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw new Error(n)}return t}},{key:"persist",value:(r=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.setJsonRpcRecords(this.values);case 1:this.events.emit(Lh);case 2:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"restore",value:(n=g(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getJsonRpcRecords();case 1:if(!(_(t=e.v)>"u")&&t.length){e.n=2;break}return e.a(2);case 2:if(!this.records.size){e.n=3;break}throw n=nf("RESTORE_WILL_OVERRIDE",this.name),r=n.message,this.logger.error(r),new Error(r);case 3:this.cached=t,this.logger.debug("Successfully Restored records for ".concat(this.name)),this.logger.trace({type:"method",method:"restore",records:this.values}),e.n=5;break;case 4:e.p=4,i=e.v,this.logger.debug("Failed to Restore records for ".concat(this.name)),this.logger.error(i);case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return n.apply(this,arguments)})},{key:"registerEventListeners",value:function(){var e=this;this.events.on(Ch,function(t){var n=Ch;e.logger.info("Emitting ".concat(n)),e.logger.debug({type:"event",event:n,record:t})}),this.events.on(Uh,function(t){var n=Uh;e.logger.info("Emitting ".concat(n)),e.logger.debug({type:"event",event:n,record:t})}),this.events.on(jh,function(t){var n=jh;e.logger.info("Emitting ".concat(n)),e.logger.debug({type:"event",event:n,record:t})}),this.core.heartbeat.on(de.pulse,function(){e.cleanup()})}},{key:"cleanup",value:function(){var e=this;try{this.isInitialized();var t=!1;this.records.forEach(function(n){ue.toMiliseconds(n.expiry||0)-Date.now()<=0&&(e.logger.info("Deleting expired history log: ".concat(n.id)),e.records.delete(n.id),e.events.emit(jh,n,!1),t=!0)}),t&&this.persist()}catch(rO){this.logger.warn(rO)}}},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]);var n,r,i,o}(Ot),Rg=Object.defineProperty,Bg=function(e,t,n){return function(e,t,n){return t in e?Rg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},Cg=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n])).core=e,r.logger=n,Bg(w(r),"expirations",new Map),Bg(w(r),"events",new N.EventEmitter),Bg(w(r),"name","expirer"),Bg(w(r),"version","0.3"),Bg(w(r),"cached",[]),Bg(w(r),"initialized",!1),Bg(w(r),"storagePrefix",th),Bg(w(r),"init",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(r.initialized){e.n=2;break}return r.logger.trace("Initialized"),e.n=1,r.restore();case 1:r.cached.forEach(function(e){return r.expirations.set(e.target,e)}),r.cached=[],r.registerEventListeners(),r.initialized=!0;case 2:return e.a(2)}},e)}))),Bg(w(r),"has",function(e){try{var t=r.formatTarget(e);return _(r.getExpiration(t))<"u"}catch(n){return!1}}),Bg(w(r),"set",function(e,t){r.isInitialized();var n=r.formatTarget(e),i={target:n,expiry:t};r.expirations.set(n,i),r.checkExpiry(n,i),r.events.emit(Dh,{target:n,expiration:i})}),Bg(w(r),"get",function(e){r.isInitialized();var t=r.formatTarget(e);return r.getExpiration(t)}),Bg(w(r),"del",function(e){if(r.isInitialized(),r.has(e)){var t=r.formatTarget(e),n=r.getExpiration(t);r.expirations.delete(t),r.events.emit(qh,{target:t,expiration:n})}}),Bg(w(r),"on",function(e,t){r.events.on(e,t)}),Bg(w(r),"once",function(e,t){r.events.once(e,t)}),Bg(w(r),"off",function(e,t){r.events.off(e,t)}),Bg(w(r),"removeListener",function(e,t){r.events.removeListener(e,t)}),r.logger=mt(n,r.name),r}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}},{key:"length",get:function(){return this.expirations.size}},{key:"keys",get:function(){return Array.from(this.expirations.keys())}},{key:"values",get:function(){return Array.from(this.expirations.values())}},{key:"formatTarget",value:function(e){if("string"==typeof e)return function(e){return ls("topic",e)}(e);if("number"==typeof e)return function(e){return ls("id",e)}(e);var t=nf("UNKNOWN_TYPE","Target type: ".concat(_(e))).message;throw new Error(t)}},{key:"setExpirations",value:(o=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.setItem(this.storageKey,t);case 1:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getExpirations",value:(i=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.core.storage.getItem(this.storageKey);case 1:return e.a(2,e.v)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"persist",value:(r=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.setExpirations(this.values);case 1:this.events.emit(zh);case 2:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"restore",value:(n=g(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getExpirations();case 1:if(!(_(t=e.v)>"u")&&t.length){e.n=2;break}return e.a(2);case 2:if(!this.expirations.size){e.n=3;break}throw n=nf("RESTORE_WILL_OVERRIDE",this.name),r=n.message,this.logger.error(r),new Error(r);case 3:this.cached=t,this.logger.debug("Successfully Restored expirations for ".concat(this.name)),this.logger.trace({type:"method",method:"restore",expirations:this.values}),e.n=5;break;case 4:e.p=4,i=e.v,this.logger.debug("Failed to Restore expirations for ".concat(this.name)),this.logger.error(i);case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return n.apply(this,arguments)})},{key:"getExpiration",value:function(e){var t=this.expirations.get(e);if(!t){var n=nf("NO_MATCHING_KEY","".concat(this.name,": ").concat(e)).message;throw this.logger.warn(n),new Error(n)}return t}},{key:"checkExpiry",value:function(e,t){var n=t.expiry;ue.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}},{key:"expire",value:function(e,t){this.expirations.delete(e),this.events.emit(Mh,{target:e,expiration:t})}},{key:"checkExpirations",value:function(){var e=this;this.core.relayer.connected&&this.expirations.forEach(function(t,n){return e.checkExpiry(n,t)})}},{key:"registerEventListeners",value:function(){var e=this;this.core.heartbeat.on(de.pulse,function(){return e.checkExpirations()}),this.events.on(Dh,function(t){var n=Dh;e.logger.info("Emitting ".concat(n)),e.logger.debug({type:"event",event:n,data:t}),e.persist()}),this.events.on(Mh,function(t){var n=Mh;e.logger.info("Emitting ".concat(n)),e.logger.debug({type:"event",event:n,data:t}),e.persist()}),this.events.on(qh,function(t){var n=qh;e.logger.info("Emitting ".concat(n)),e.logger.debug({type:"event",event:n,data:t}),e.persist()})}},{key:"isInitialized",value:function(){if(!this.initialized){var e=nf("NOT_INITIALIZED",this.name).message;throw new Error(e)}}}]);var n,r,i,o}(Nt),Ug=Object.defineProperty,jg=function(e,t,n){return function(e,t,n){return t in e?Ug(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},Lg=function(e){function t(e,n,r){var i;return S(this,t),(i=y(this,t,[e,n,r])).core=e,i.logger=n,i.store=r,jg(w(i),"name","verify-api"),jg(w(i),"abortController"),jg(w(i),"isDevEnv"),jg(w(i),"verifyUrlV3",Fh),jg(w(i),"storagePrefix",th),jg(w(i),"version",2),jg(w(i),"publicKey"),jg(w(i),"fetchPromise"),jg(w(i),"init",g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:if(i.isDevEnv){e.n=2;break}return e.n=1,i.store.getItem(i.storeKey);case 1:if(i.publicKey=e.v,!(i.publicKey&&ue.toMiliseconds(null==(t=i.publicKey)?void 0:t.expiresAt)<Date.now())){e.n=2;break}return i.logger.debug("verify v2 public key expired"),e.n=2,i.removePublicKey();case 2:return e.a(2)}},e)}))),jg(w(i),"register",function(){var e=g(d().m(function e(t){var n,r,o,a,s,c,u,l;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(ts()&&!i.isDevEnv){e.n=1;break}return e.a(2);case 1:return n=window.location.origin,r=t.id,o=t.decryptedId,a="".concat(i.verifyUrlV3,"/attestation?projectId=").concat(i.core.projectId,"&origin=").concat(n,"&id=").concat(r,"&decryptedId=").concat(o),e.p=2,s=zo.getDocument(),c=i.startAbortTimer(5*ue.ONE_SECOND),e.n=3,new Promise(function(e,t){var n=function(){window.removeEventListener("message",u),s.body.removeChild(o),t("attestation aborted")};i.abortController.signal.addEventListener("abort",n);var o=s.createElement("iframe");o.src=a,o.style.display="none",o.addEventListener("error",n,{signal:i.abortController.signal});var u=function(t){if(t.data&&"string"==typeof t.data)try{var a=JSON.parse(t.data);if("verify_attestation"===a.type){if(ko(a.attestation).payload.id!==r)return;clearInterval(c),s.body.removeChild(o),i.abortController.signal.removeEventListener("abort",n),window.removeEventListener("message",u),e(null===a.attestation?"":a.attestation)}}catch(KA){i.logger.warn(KA)}};s.body.appendChild(o),window.addEventListener("message",u,{signal:i.abortController.signal})});case 3:return u=e.v,e.a(2,(i.logger.debug("jwt attestation",u),u));case 4:return e.p=4,l=e.v,i.logger.warn(l),e.a(2,"")}},e,null,[[2,4]])}));return function(t){return e.apply(this,arguments)}}()),jg(w(i),"resolve",function(){var e=g(d().m(function e(t){var n,r,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:if(!i.isDevEnv){e.n=1;break}return e.a(2,"");case 1:if(n=t.attestationId,r=t.hash,o=t.encryptedId,""!==n){e.n=2;break}return i.logger.debug("resolve: attestationId is empty, skipping"),e.a(2);case 2:if(!n){e.n=6;break}if(ko(n).payload.id===o){e.n=3;break}return e.a(2);case 3:return e.n=4,i.isValidJwtAttestation(n);case 4:if(!(a=e.v)){e.n=6;break}if(a.isVerified){e.n=5;break}return i.logger.warn("resolve: jwt attestation: origin url not verified"),e.a(2);case 5:return e.a(2,a);case 6:if(r){e.n=7;break}return e.a(2);case 7:return s=i.getVerifyUrl(null==t?void 0:t.verifyUrl),e.a(2,i.fetchAttestation(r,s))}},e)}));return function(t){return e.apply(this,arguments)}}()),jg(w(i),"fetchAttestation",function(){var e=g(d().m(function e(t,n){var r,o,a;return d().w(function(e){for(;;)switch(e.n){case 0:return i.logger.debug("resolving attestation: ".concat(t," from url: ").concat(n)),r=i.startAbortTimer(5*ue.ONE_SECOND),e.n=1,fetch("".concat(n,"/attestation/").concat(t,"?v2Supported=true"),{signal:i.abortController.signal});case 1:if(o=e.v,clearTimeout(r),200!==o.status){e.n=3;break}return e.n=2,o.json();case 2:a=e.v,e.n=4;break;case 3:a=void 0;case 4:return e.a(2,a)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),jg(w(i),"getVerifyUrl",function(e){var t=e||Vh;return Kh.includes(t)||(i.logger.info("verify url: ".concat(t,", not included in trusted list, assigning default: ").concat(Vh)),t=Vh),t}),jg(w(i),"fetchPublicKey",g(d().m(function e(){var t,n,r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,i.logger.debug("fetching public key from: ".concat(i.verifyUrlV3)),t=i.startAbortTimer(ue.FIVE_SECONDS),e.n=1,fetch("".concat(i.verifyUrlV3,"/public-key"),{signal:i.abortController.signal});case 1:return n=e.v,clearTimeout(t),e.n=2,n.json();case 2:return e.a(2,e.v);case 3:e.p=3,r=e.v,i.logger.warn(r);case 4:return e.a(2)}},e,null,[[0,3]])}))),jg(w(i),"persistPublicKey",function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return i.logger.debug("persisting public key to local storage",t),e.n=1,i.store.setItem(i.storeKey,t);case 1:i.publicKey=t;case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),jg(w(i),"removePublicKey",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return i.logger.debug("removing verify v2 public key from storage"),e.n=1,i.store.removeItem(i.storeKey);case 1:i.publicKey=void 0;case 2:return e.a(2)}},e)}))),jg(w(i),"isValidJwtAttestation",function(){var e=g(d().m(function e(t){var n,r,o,a;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,i.getPublicKey();case 1:if(n=e.v,e.p=2,!n){e.n=3;break}return e.a(2,i.validateAttestation(t,n));case 3:e.n=5;break;case 4:e.p=4,o=e.v,i.logger.error(o),i.logger.warn("error validating attestation");case 5:return e.n=6,i.fetchAndPersistPublicKey();case 6:if(r=e.v,e.p=7,!r){e.n=8;break}return e.a(2,i.validateAttestation(t,r));case 8:e.n=10;break;case 9:e.p=9,a=e.v,i.logger.error(a),i.logger.warn("error validating attestation");case 10:return e.a(2)}},e,null,[[7,9],[2,4]])}));return function(t){return e.apply(this,arguments)}}()),jg(w(i),"getPublicKey",g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:if(!i.publicKey){e.n=1;break}t=i.publicKey,e.n=3;break;case 1:return e.n=2,i.fetchAndPersistPublicKey();case 2:t=e.v;case 3:return e.a(2,t)}},e)}))),jg(w(i),"fetchAndPersistPublicKey",g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:if(!i.fetchPromise){e.n=2;break}return e.n=1,i.fetchPromise;case 1:return e.a(2,i.publicKey);case 2:return i.fetchPromise=new Promise(function(){var e=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i.fetchPublicKey();case 1:if(n=e.v,!n){e.n=3;break}return e.n=2,i.persistPublicKey(n);case 2:t(n);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),e.n=3,i.fetchPromise;case 3:return t=e.v,e.a(2,(i.fetchPromise=void 0,t))}},e)}))),jg(w(i),"validateAttestation",function(e,t){var n=Gl(e,t.publicKey),r={hasExpired:ue.toMiliseconds(n.exp)<Date.now(),payload:n};if(r.hasExpired)throw i.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:r.payload.origin,isScam:r.payload.isScam,isVerified:r.payload.isVerified}}),i.logger=mt(n,i.name),i.abortController=new AbortController,i.isDevEnv=gs(),i.init(),i}return k(t,e),P(t,[{key:"storeKey",get:function(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}},{key:"context",get:function(){return yt(this.logger)}},{key:"startAbortTimer",value:function(e){var t=this;return this.abortController=new AbortController,setTimeout(function(){return t.abortController.abort()},ue.toMiliseconds(e))}}])}(Rt),Dg=Object.defineProperty,qg=function(e,t,n){return function(e,t,n){return t in e?Dg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},Mg=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n])).projectId=e,r.logger=n,qg(w(r),"context","echo"),qg(w(r),"registerDeviceToken",function(){var e=g(d().m(function e(t){var n,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.clientId,i=t.token,o=t.notificationType,a=t.enableEncrypted,s=void 0!==a&&a,c="".concat("https://echo.walletconnect.com","/").concat(r.projectId,"/clients"),e.n=1,fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:o,token:i,always_raw:s})});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),r.logger=mt(n,r.context),r}return k(t,e),P(t)}(Bt),zg=Object.defineProperty,Hg=Object.getOwnPropertySymbols,Vg=Object.prototype.hasOwnProperty,Fg=Object.prototype.propertyIsEnumerable,Kg=function(e,t,n){return t in e?zg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Wg=function(e,t){for(var n in t||(t={}))Vg.call(t,n)&&Kg(e,n,t[n]);if(Hg){var r,i=u(Hg(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Fg.call(t,n)&&Kg(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},Gg=function(e,t,n){return Kg(e,"symbol"!=_(t)?t+"":t,n)},Zg=function(e){function t(e,n){var i,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return S(this,t),(i=y(this,t,[e,n,o])).core=e,i.logger=n,Gg(w(i),"context","event-client"),Gg(w(i),"storagePrefix",th),Gg(w(i),"storageVersion",.1),Gg(w(i),"events",new Map),Gg(w(i),"shouldPersist",!1),Gg(w(i),"init",g(d().m(function e(){var t,n,r,o,a,s,c;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(gs()){e.n=5;break}return e.p=1,n=vs(),r=Date.now(),o=i.getAppDomain(),e.n=2,i.core.crypto.getClientId();case 2:return a=e.v,s=is(i.core.relayer.protocol,i.core.relayer.version,wh),t={eventId:n,timestamp:r,domain:o,props:{event:"INIT",type:"",properties:{client_id:a,user_agent:s}}},e.n=3,i.sendEvent([t]);case 3:e.n=5;break;case 4:e.p=4,c=e.v,i.logger.warn(c);case 5:return e.a(2)}},e,null,[[1,4]])}))),Gg(w(i),"createEvent",function(e){var t=e.event,n=void 0===t?"ERROR":t,r=e.type,o=void 0===r?"":r,a=e.properties,s=a.topic,c=a.trace,u=vs(),l=i.core.projectId||"",f=Date.now(),h=Wg({eventId:u,timestamp:f,props:{event:n,type:o,properties:{topic:s,trace:c}},bundleId:l,domain:i.getAppDomain()},i.setMethods(u));return i.telemetryEnabled&&(i.events.set(u,h),i.shouldPersist=!0),h}),Gg(w(i),"getEvent",function(e){var t=e.eventId,n=e.topic;if(t)return i.events.get(t);var r=Array.from(i.events.values()).find(function(e){return e.props.properties.topic===n});return r?Wg(Wg({},r),i.setMethods(r.eventId)):void 0}),Gg(w(i),"deleteEvent",function(e){var t=e.eventId;i.events.delete(t),i.shouldPersist=!0}),Gg(w(i),"setEventListeners",function(){i.core.heartbeat.on(de.pulse,g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(!i.shouldPersist){e.n=1;break}return e.n=1,i.persist();case 1:i.events.forEach(function(e){ue.fromMiliseconds(Date.now())-ue.fromMiliseconds(e.timestamp)>86400&&(i.events.delete(e.eventId),i.shouldPersist=!0)});case 2:return e.a(2)}},e)})))}),Gg(w(i),"setMethods",function(e){return{addTrace:function(t){return i.addTrace(e,t)},setError:function(t){return i.setError(e,t)}}}),Gg(w(i),"addTrace",function(e,t){var n=i.events.get(e);n&&(n.props.properties.trace.push(t),i.events.set(e,n),i.shouldPersist=!0)}),Gg(w(i),"setError",function(e,t){var n=i.events.get(e);n&&(n.props.type=t,n.timestamp=Date.now(),i.events.set(e,n),i.shouldPersist=!0)}),Gg(w(i),"persist",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i.core.storage.setItem(i.storageKey,Array.from(i.events.values()));case 1:i.shouldPersist=!1;case 2:return e.a(2)}},e)}))),Gg(w(i),"restore",g(d().m(function e(){var t,n,r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,i.core.storage.getItem(i.storageKey);case 1:if(n=e.v){e.n=2;break}n=[];case 2:if((t=n).length){e.n=3;break}return e.a(2);case 3:t.forEach(function(e){i.events.set(e.eventId,Wg(Wg({},e),i.setMethods(e.eventId)))}),e.n=5;break;case 4:e.p=4,r=e.v,i.logger.warn(r);case 5:return e.a(2)}},e,null,[[0,4]])}))),Gg(w(i),"submit",g(d().m(function e(){var t,n,o,a,s,c,l,f,h;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i.telemetryEnabled&&0!==i.events.size){e.n=1;break}return e.a(2);case 1:t=[],n=u(i.events);try{for(n.s();!(o=n.n()).done;)a=r(o.value,2),a[0],(s=a[1]).props.type&&t.push(s)}catch(d){n.e(d)}finally{n.f()}if(0===t.length){e.n=6;break}return e.p=2,e.n=3,i.sendEvent(t);case 3:if(!e.v.ok){e.n=4;break}c=u(t);try{for(c.s();!(l=c.n()).done;)f=l.value,i.events.delete(f.eventId),i.shouldPersist=!0}catch(d){c.e(d)}finally{c.f()}case 4:e.n=6;break;case 5:e.p=5,h=e.v,i.logger.warn(h);case 6:return e.a(2)}},e,null,[[2,5]])}))),Gg(w(i),"sendEvent",function(){var e=g(d().m(function e(t){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return n=i.getAppDomain()?"":"&sp=desktop",e.n=1,fetch("".concat("https://pulse.walletconnect.org/batch","?projectId=").concat(i.core.projectId,"&st=events_sdk&sv=js-").concat(wh).concat(n),{method:"POST",body:JSON.stringify(t)});case 1:return e.a(2,e.v)}},e)}));return function(t){return e.apply(this,arguments)}}()),Gg(w(i),"getAppDomain",function(){return(Vo.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}).url}),i.logger=mt(n,i.context),i.telemetryEnabled=o,o?i.restore().then(g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i.submit();case 1:i.setEventListeners();case 2:return e.a(2)}},e)}))):i.persist(),i}return k(t,e),P(t,[{key:"storageKey",get:function(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}])}(Ct),Yg=Object.defineProperty,Jg=Object.getOwnPropertySymbols,Qg=Object.prototype.hasOwnProperty,Xg=Object.prototype.propertyIsEnumerable,$g=function(e,t,n){return t in e?Yg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},ey=function(e,t){for(var n in t||(t={}))Qg.call(t,n)&&$g(e,n,t[n]);if(Jg){var r,i=u(Jg(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Xg.call(t,n)&&$g(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},ty=function(e,t,n){return $g(e,"symbol"!=_(t)?t+"":t,n)},ny=function(e){function t(e){var n,r;S(this,t),n=y(this,t,[e]),ty(w(n),"protocol","wc"),ty(w(n),"version",2),ty(w(n),"name",eh),ty(w(n),"relayUrl"),ty(w(n),"projectId"),ty(w(n),"customStoragePrefix"),ty(w(n),"events",new N.EventEmitter),ty(w(n),"logger"),ty(w(n),"heartbeat"),ty(w(n),"relayer"),ty(w(n),"crypto"),ty(w(n),"storage"),ty(w(n),"history"),ty(w(n),"expirer"),ty(w(n),"pairing"),ty(w(n),"verify"),ty(w(n),"echoClient"),ty(w(n),"linkModeSupportedApps"),ty(w(n),"eventClient"),ty(w(n),"initialized",!1),ty(w(n),"logChunkController"),ty(w(n),"on",function(e,t){return n.events.on(e,t)}),ty(w(n),"once",function(e,t){return n.events.once(e,t)}),ty(w(n),"off",function(e,t){return n.events.off(e,t)}),ty(w(n),"removeListener",function(e,t){return n.events.removeListener(e,t)}),ty(w(n),"dispatchEnvelope",function(e){var t=e.topic,r=e.message,i=e.sessionExists;if(t&&r){var o={topic:t,message:r,publishedAt:Date.now(),transportType:bh};n.relayer.onLinkMessageEvent(o,{sessionExists:i})}});var i=n.getGlobalCore(null==e?void 0:e.customStoragePrefix);if(i)try{return m(n,(n.customStoragePrefix=i.customStoragePrefix,n.logger=i.logger,n.heartbeat=i.heartbeat,n.crypto=i.crypto,n.history=i.history,n.expirer=i.expirer,n.storage=i.storage,n.relayer=i.relayer,n.pairing=i.pairing,n.verify=i.verify,n.echoClient=i.echoClient,n.linkModeSupportedApps=i.linkModeSupportedApps,n.eventClient=i.eventClient,n.initialized=i.initialized,n.logChunkController=i.logChunkController,i))}catch(bt){console.warn("Failed to copy global core",bt)}n.projectId=null==e?void 0:e.projectId,n.relayUrl=(null==e?void 0:e.relayUrl)||sh,n.customStoragePrefix=null!=e&&e.customStoragePrefix?":".concat(e.customStoragePrefix):"";var o=wt({opts:gt({level:"string"==typeof(null==e?void 0:e.logger)&&e.logger?e.logger:nh,name:eh}),maxSizeInBytes:null==e?void 0:e.maxLogBlobSizeInBytes,loggerOverride:null==e?void 0:e.logger}),a=o.logger,s=o.chunkLoggerController;return n.logChunkController=s,null!=(r=n.logChunkController)&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=g(d().m(function e(){var t,r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(!(null!=(t=n.logChunkController)&&t.downloadLogsBlobInBrowser)){e.n=2;break}if(null==(r=n.logChunkController)){e.n=2;break}return i=r,e.n=1,n.crypto.getClientId();case 1:o=e.v,i.downloadLogsBlobInBrowser.call(i,{clientId:o});case 2:return e.a(2)}},e)}))),n.logger=mt(a,n.name),n.heartbeat=new pe,n.crypto=new mv(n,n.logger,null==e?void 0:e.keychain),n.history=new Ng(n,n.logger),n.expirer=new Cg(n,n.logger),n.storage=null!=e&&e.storage?e.storage:new Je(ey(ey({},rh),null==e?void 0:e.storageOptions)),n.relayer=new cg({core:n,logger:n.logger,relayUrl:n.relayUrl,projectId:n.projectId}),n.pairing=new _g(n,n.logger),n.verify=new Lg(n,n.logger,n.storage),n.echoClient=new Mg(n.projectId||"",n.logger),n.linkModeSupportedApps=[],n.eventClient=new Zg(n,n.logger,null==e?void 0:e.telemetryEnabled),n.setGlobalCore(n),n}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"start",value:(a=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.initialized){e.n=1;break}return e.n=1,this.initialize();case 1:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"getLogsBlob",value:(o=g(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.n){case 0:if(null!=(t=this.logChunkController)){e.n=1;break}n=void 0,e.n=3;break;case 1:return r=t,e.n=2,this.crypto.getClientId();case 2:i=e.v,n=r.logsToBlob.call(r,{clientId:i});case 3:return e.a(2,n)}},e,this)})),function(){return o.apply(this,arguments)})},{key:"addLinkModeSupportedApp",value:(i=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.linkModeSupportedApps.includes(t)){e.n=1;break}return this.linkModeSupportedApps.push(t),e.n=1,this.storage.setItem(Sh,this.linkModeSupportedApps);case 1:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"initialize",value:(r=g(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.logger.trace("Initialized"),e.p=1,e.n=2,this.crypto.init();case 2:return e.n=3,this.history.init();case 3:return e.n=4,this.expirer.init();case 4:return e.n=5,this.relayer.init();case 5:return e.n=6,this.heartbeat.init();case 6:return e.n=7,this.pairing.init();case 7:return e.n=8,this.storage.getItem(Sh);case 8:if(t=e.v){e.n=9;break}t=[];case 9:this.linkModeSupportedApps=t,this.initialized=!0,this.logger.info("Core Initialization Success"),e.n=11;break;case 10:throw e.p=10,n=e.v,this.logger.warn("Core Initialization Failure at epoch ".concat(Date.now()),n),this.logger.error(n.message),n;case 11:return e.a(2)}},e,this,[[1,10]])})),function(){return r.apply(this,arguments)})},{key:"getGlobalCore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(this.isGlobalCoreDisabled())return;var t="_walletConnectCore_".concat(e),n="".concat(t,"_count");return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn("WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ".concat(globalThis[n]," times.")),globalThis[t]}catch(t){return void console.warn("Failed to get global WalletConnect core",t)}}},{key:"setGlobalCore",value:function(e){var t;try{if(this.isGlobalCoreDisabled())return;var n="_walletConnectCore_".concat((null==(t=e.opts)?void 0:t.customStoragePrefix)||"");globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}},{key:"isGlobalCoreDisabled",value:function(){try{return("undefined"==typeof process?"undefined":_(process))<"u"&&"true"===$f.DISABLE_GLOBAL_CORE}catch(e){return!0}}}],[{key:"init",value:(n=g(d().m(function e(n){var r,i;return d().w(function(e){for(;;)switch(e.n){case 0:return r=new t(n),e.n=1,r.initialize();case 1:return e.n=2,r.crypto.getClientId();case 2:return i=e.v,e.n=3,r.storage.setItem("WALLETCONNECT_CLIENT_ID",i);case 3:return e.a(2,r)}},e)})),function(e){return n.apply(this,arguments)})}]);var n,r,i,o,a}(kt),ry=ny;function iy(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).strict;return!!e&&("string"==typeof e&&(void 0===t||t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")))}function oy(e){return iy(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}var ay="2.23.2",sy={getDocsUrl:function(e){var t=e.docsBaseUrl,n=e.docsPath,r=void 0===n?"":n,i=e.docsSlug;return r?"".concat(null!=t?t:"https://viem.sh").concat(r).concat(i?"#".concat(i):""):void 0},version:"viem@".concat(ay)},cy=function(e){function t(e){var n,r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S(this,t);var s,c=o.cause instanceof t?o.cause.details:null!==(s=o.cause)&&void 0!==s&&s.message?o.cause.message:o.details,u=o.cause instanceof t&&o.cause.docsPath||o.docsPath,f=null===(n=sy.getDocsUrl)||void 0===n?void 0:n.call(sy,a(a({},o),{},{docsPath:u}));return i=y(this,t,[[e||"An error occurred.",""].concat(l(o.metaMessages?[].concat(l(o.metaMessages),[""]):[]),l(f?["Docs: ".concat(f)]:[]),l(c?["Details: ".concat(c)]:[]),l(sy.version?["Version: ".concat(sy.version)]:[])).join("\n"),o.cause?{cause:o.cause}:void 0]),Object.defineProperty(i,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),i.details=c,i.docsPath=u,i.metaMessages=o.metaMessages,i.name=null!==(r=o.name)&&void 0!==r?r:i.name,i.shortMessage=e,i.version=ay,i}return k(t,e),P(t,[{key:"walk",value:function(e){return uy(this,e)}}])}(n(Error));function uy(e,t){return null!=t&&t(e)?e:e&&"object"===_(e)&&"cause"in e&&void 0!==e.cause?uy(e.cause,t):t?null:e}var ly=function(e){function t(e){var n=e.size,r=e.targetSize,i=e.type;return S(this,t),y(this,t,["".concat(i.charAt(0).toUpperCase()).concat(i.slice(1).toLowerCase()," size (").concat(n,") exceeds padding size (").concat(r,")."),{name:"SizeExceedsPaddingSizeError"}])}return k(t,e),P(t)}(cy);function fy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.dir,r=t.size,i=void 0===r?32:r;return"string"==typeof e?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.dir,r=t.size,i=void 0===r?32:r;if(null===i)return e;var o=e.replace("0x","");if(o.length>2*i)throw new ly({size:Math.ceil(o.length/2),targetSize:i,type:"hex"});return"0x".concat(o["right"===n?"padEnd":"padStart"](2*i,"0"))}(e,{dir:n,size:i}):function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.dir,r=t.size,i=void 0===r?32:r;if(null===i)return e;if(e.length>i)throw new ly({size:e.length,targetSize:i,type:"bytes"});for(var o=new Uint8Array(i),a=0;a<i;a++){var s="right"===n;o[s?a:i-a-1]=e[s?a:e.length-a-1]}return o}(e,{dir:n,size:i})}var hy=function(e){function t(e){var n=e.max,r=e.min,i=e.signed,o=e.size,a=e.value;return S(this,t),y(this,t,['Number "'.concat(a,'" is not in safe ').concat(o?"".concat(8*o,"-bit ").concat(i?"signed":"unsigned"," "):"","integer range ").concat(n?"(".concat(r," to ").concat(n,")"):"(above ".concat(r,")")),{name:"IntegerOutOfRangeError"}])}return k(t,e),P(t)}(cy),dy=function(e){function t(e){var n=e.givenSize,r=e.maxSize;return S(this,t),y(this,t,["Size cannot exceed ".concat(r," bytes. Given size: ").concat(n," bytes."),{name:"SizeOverflowError"}])}return k(t,e),P(t)}(cy);function py(e,t){var n=t.size;if(oy(e)>n)throw new dy({givenSize:oy(e),maxSize:n})}function vy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.signed;t.size&&py(e,{size:t.size});var r=BigInt(e);if(!n)return r;var i=(e.length-2)/2;return r<=(1n<<8n*BigInt(i)-1n)-1n?r:r-BigInt("0x".concat("f".padStart(2*i,"f")))-1n}function gy(e){return Number(vy(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}var yy=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function my(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"number"==typeof e||"bigint"==typeof e?by(e,t):"string"==typeof e?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ey.encode(e);return wy(n,t)}(e,t):"boolean"==typeof e?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="0x".concat(Number(e));if("number"==typeof t.size)return py(n,{size:t.size}),fy(n,{size:t.size});return n}(e,t):wy(e,t)}function wy(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="",r=0;r<e.length;r++)n+=yy[e[r]];var i="0x".concat(n);return"number"==typeof t.size?(py(i,{size:t.size}),fy(i,{dir:"right",size:t.size})):i}function by(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.signed,i=n.size,o=BigInt(e);i?t=r?(1n<<8n*BigInt(i)-1n)-1n:Math.pow(2n,8n*BigInt(i))-1n:"number"==typeof e&&(t=BigInt(Number.MAX_SAFE_INTEGER));var a="bigint"==typeof t&&r?-t-1n:0;if(t&&o>t||o<a){var s="bigint"==typeof e?"n":"";throw new hy({max:t?"".concat(t).concat(s):void 0,min:"".concat(a).concat(s),signed:r,size:i,value:"".concat(e).concat(s)})}var c="0x".concat((r&&o<0?(1n<<BigInt(8*i))+BigInt(o):o).toString(16));return i?fy(c,{size:i}):c}var Ey=new TextEncoder;var ky=new TextEncoder;function Iy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"number"==typeof e||"bigint"==typeof e?function(e,t){var n=by(e,t);return Py(n)}(e,t):"boolean"==typeof e?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Uint8Array(1);if(n[0]=Number(e),"number"==typeof t.size)return py(n,{size:t.size}),fy(n,{size:t.size});return n}(e,t):iy(e)?Py(e,t):xy(e,t)}var Sy={zero:48,nine:57,A:65,F:70,a:97,f:102};function Oy(e){return e>=Sy.zero&&e<=Sy.nine?e-Sy.zero:e>=Sy.A&&e<=Sy.F?e-(Sy.A-10):e>=Sy.a&&e<=Sy.f?e-(Sy.a-10):void 0}function Py(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;t.size&&(py(n,{size:t.size}),n=fy(n,{dir:"right",size:t.size}));var r=n.slice(2);r.length%2&&(r="0".concat(r));for(var i=r.length/2,o=new Uint8Array(i),a=0,s=0;a<i;a++){var c=Oy(r.charCodeAt(s++)),u=Oy(r.charCodeAt(s++));if(void 0===c||void 0===u)throw new cy('Invalid byte sequence ("'.concat(r[s-2]).concat(r[s-1],'" in "').concat(r,'").'));o[a]=16*c+u}return o}function xy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ky.encode(e);return"number"==typeof t.size?(py(n,{size:t.size}),fy(n,{dir:"right",size:t.size})):n}function _y(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ay(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function Ty(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ny(e,t){Ay(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var Ry=BigInt(Math.pow(2,32)-1),By=BigInt(32);function Cy(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&Ry),l:Number(e>>By&Ry)}:{h:0|Number(e>>By&Ry),l:0|Number(e&Ry)}}function Uy(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length),i=0;i<e.length;i++){var o=Cy(e[i],t),a=[o.h,o.l];n[i]=a[0],r[i]=a[1]}return[n,r]}var jy="object"===("undefined"==typeof globalThis?"undefined":_(globalThis))&&"crypto"in globalThis?globalThis.crypto:void 0;var Ly=function(){return 68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]}();function Dy(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function qy(e){for(var t=0;t<e.length;t++)e[t]=Dy(e[t])}function My(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+_(e));return new Uint8Array((new TextEncoder).encode(e))}(e)),Ay(e),e}var zy=function(){return P(function e(){S(this,e)},[{key:"clone",value:function(){return this._cloneInto()}}])}();function Hy(e){var t=function(t){return e().update(My(t)).digest()},n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(){return e()},t}t("H",zy);for(var Vy=[],Fy=[],Ky=[],Wy=BigInt(0),Gy=BigInt(1),Zy=BigInt(2),Yy=BigInt(7),Jy=BigInt(256),Qy=BigInt(113),Xy=0,$y=Gy,em=1,tm=0;Xy<24;Xy++){var nm=[tm,(2*em+3*tm)%5];em=nm[0],tm=nm[1],Vy.push(2*(5*tm+em)),Fy.push((Xy+1)*(Xy+2)/2%64);Gs=Wy;for(var rm=0;rm<7;rm++)($y=($y<<Gy^($y>>Yy)*Qy)%Jy)&Zy&&(Gs^=Gy<<(Gy<<BigInt(rm))-Gy);Ky.push(Gs)}var im=r(Uy(Ky,!0),2),om=im[0],am=im[1],sm=function(e,t,n){return n>32?function(e,t,n){return t<<n-32|e>>>64-n}(e,t,n):function(e,t,n){return e<<n|t>>>32-n}(e,t,n)},cm=function(e,t,n){return n>32?function(e,t,n){return e<<n-32|t>>>64-n}(e,t,n):function(e,t,n){return t<<n|e>>>32-n}(e,t,n)};var um=function(e){function t(e,n,r){var i,o,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(S(this,t),(i=y(this,t)).blockLen=e,i.suffix=n,i.outputLen=r,i.enableXOF=a,i.rounds=s,i.pos=0,i.posOut=0,i.finished=!1,i.destroyed=!1,_y(r),0>=i.blockLen||i.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");return i.state=new Uint8Array(200),i.state32=(o=i.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4))),i}return k(t,e),P(t,[{key:"keccak",value:function(){Ly||qy(this.state32),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,n=new Uint32Array(10),r=24-t;r<24;r++){for(var i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(var o=0;o<10;o+=2)for(var a=(o+8)%10,s=(o+2)%10,c=n[s],u=n[s+1],l=sm(c,u,1)^n[a],f=cm(c,u,1)^n[a+1],h=0;h<50;h+=10)e[o+h]^=l,e[o+h+1]^=f;for(var d=e[2],p=e[3],v=0;v<24;v++){var g=Fy[v],y=sm(d,p,g),m=cm(d,p,g),w=Vy[v];d=e[w],p=e[w+1],e[w]=y,e[w+1]=m}for(var b=0;b<50;b+=10){for(var E=0;E<10;E++)n[E]=e[b+E];for(var k=0;k<10;k++)e[b+k]^=~n[(k+2)%10]&n[(k+4)%10]}e[0]^=om[r],e[1]^=am[r]}n.fill(0)}(this.state32,this.rounds),Ly||qy(this.state32),this.posOut=0,this.pos=0}},{key:"update",value:function(e){Ty(this);for(var t=this.blockLen,n=this.state,r=(e=My(e)).length,i=0;i<r;){for(var o=Math.min(t-this.pos,r-i),a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}},{key:"finish",value:function(){if(!this.finished){this.finished=!0;var e=this.state,t=this.suffix,n=this.pos,r=this.blockLen;e[n]^=t,128&t&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}}},{key:"writeInto",value:function(e){Ty(this,!1),Ay(e),this.finish();for(var t=this.state,n=this.blockLen,r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();var o=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}},{key:"xofInto",value:function(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}},{key:"xof",value:function(e){return _y(e),this.xofInto(new Uint8Array(e))}},{key:"digestInto",value:function(e){if(Ny(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}},{key:"digest",value:function(){return this.digestInto(new Uint8Array(this.outputLen))}},{key:"destroy",value:function(){this.destroyed=!0,this.state.fill(0)}},{key:"_cloneInto",value:function(e){var n=this.blockLen,r=this.suffix,i=this.outputLen,o=this.rounds,a=this.enableXOF;return e||(e=new t(n,r,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}])}(zy),lm=function(e,t,n){return Hy(function(){return new um(t,e,n)})}(1,136,32);function fm(e,t){var n=t||"hex",r=lm(iy(e,{strict:!1})?Iy(e):e);return"bytes"===n?r:my(r)}var hm=function(t){function n(e){var t;return S(this,n),t=y(this,n),Object.defineProperty(t,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.maxSize=e,t}return k(n,t),P(n,[{key:"get",value:function(t){var r=e(n,"get",this,3)([t]);return e(n,"has",this,3)([t])&&void 0!==r&&(this.delete(t),e(n,"set",this,3)([t,r])),r}},{key:"set",value:function(t,r){if(e(n,"set",this,3)([t,r]),this.maxSize&&this.size>this.maxSize){var i=this.keys().next().value;i&&this.delete(i)}return this}}])}(n(Map)),dm=new hm(8192);function pm(e){var t=fm("0x".concat(e.substring(4))).substring(26);return function(e,t){if(dm.has("".concat(e,".").concat(t)))return dm.get("".concat(e,".").concat(t));for(var n=e.substring(2).toLowerCase(),r=fm(xy(n),"bytes"),i=n.split(""),o=0;o<40;o+=2)r[o>>1]>>4>=8&&i[o]&&(i[o]=i[o].toUpperCase()),(15&r[o>>1])>=8&&i[o+1]&&(i[o+1]=i[o+1].toUpperCase());var a="0x".concat(i.join(""));return dm.set("".concat(e,".").concat(t),a),a}("0x".concat(t))}function vm(e){return gm.apply(this,arguments)}function gm(){return gm=g(d().m(function e(t){var n,r,i,a,s,c,u;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.hash,r=t.signature,i=iy(n)?n:my(n),e.n=1,v(g(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,o.import("./secp256k1-legacy-CzD_E3qM.js");case 1:return t=e.v,n=t.secp256k1,e.a(2,{secp256k1:n})}},e)})),void 0);case 1:return a=e.v,s=a.secp256k1,c=function(){if("object"===_(r)&&"r"in r&&"s"in r){var e=r.r,t=r.s,n=r.v,i=r.yParity,o=ym(Number(null!=i?i:n));return new s.Signature(vy(e),vy(t)).addRecoveryBit(o)}var a=iy(r)?r:my(r),c=ym(gy("0x".concat(a.slice(130))));return s.Signature.fromCompact(a.substring(2,130)).addRecoveryBit(c)}(),u=c.recoverPublicKey(i.substring(2)).toHex(!1),e.a(2,"0x".concat(u))}},e)})),gm.apply(this,arguments)}function ym(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw new Error("Invalid yParityOrV value")}function mm(e){return wm.apply(this,arguments)}function wm(){return(wm=g(d().m(function e(t){var n,r,i;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.hash,r=t.signature,i=pm,e.n=1,vm({hash:n,signature:r});case 1:return e.a(2,i(e.v))}},e)}))).apply(this,arguments)}var bm=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=r}var a=e.length,s=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var n=0,r=0,i=0;e[n]===s;)r++,n++;for(var o=(e.length-n)*c+1>>>0,u=new Uint8Array(o);n<e.length;){var l=e.charCodeAt(n);if(l>255)return;var f=t[l];if(255===f)return;for(var h=0,d=o-1;(0!==f||h<i)&&-1!==d;d--,h++)f+=a*u[d]>>>0,u[d]=f%256>>>0,f=f/256>>>0;if(0!==f)throw new Error("Non-zero carry");i=h,n++}for(var p=o-i;p!==o&&0===u[p];)p++;for(var v=new Uint8Array(r+(o-p)),g=r;p!==o;)v[g++]=u[p++];return v}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var c=(o-i)*u+1>>>0,l=new Uint8Array(c);i!==o;){for(var f=t[i],h=0,d=c-1;(0!==f||h<r)&&-1!==d;d--,h++)f+=256*l[d]>>>0,l[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");r=h,i++}for(var p=c-r;p!==c&&0===l[p];)p++;for(var v=s.repeat(n);p<c;++p)v+=e.charAt(l[p]);return v},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Em={};function km(e){var t=r(e.split(":"),2);return{namespace:t[0],reference:t[1]}}function Im(e,t){return e.includes(":")?[e]:t.chains||[]}var Sm=Object.defineProperty,Om=Object.defineProperties,Pm=Object.getOwnPropertyDescriptors,xm=Object.getOwnPropertySymbols,_m=Object.prototype.hasOwnProperty,Am=Object.prototype.propertyIsEnumerable,Tm=function(e,t,n){return t in e?Sm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Nm=function(e,t){for(var n in t||(t={}))_m.call(t,n)&&Tm(e,n,t[n]);if(xm){var r,i=u(xm(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Am.call(t,n)&&Tm(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},Rm="react-native",Bm="node",Cm="browser",Um="unknown";function jm(){return("undefined"==typeof process?"undefined":_(process))<"u"&&_(process.versions)<"u"&&_(process.versions.node)<"u"}function Lm(){return!zo.getDocument()&&!!zo.getNavigator()&&"ReactNative"===navigator.product}function Dm(){return!jm()&&!!zo.getNavigator()&&!!zo.getDocument()}function qm(){return Lm()?Rm:jm()?Bm:Dm()?Cm:Um}function Mm(e){var t,n,r=Vo.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]};try{return null!=e&&e.url&&r.url&&new URL(e.url).host!==new URL(r.url).host&&(console.warn("The configured WalletConnect 'metadata.url':".concat(e.url," differs from the actual page url:").concat(r.url,". This is probably unintended and can lead to issues.")),e.url=r.url),null!=(t=null==e?void 0:e.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(function(e){return""!==e})),function(e,t){return Om(e,Pm(t))}(Nm(Nm({},r),e),{url:(null==e?void 0:e.url)||r.url,name:(null==e?void 0:e.name)||r.name,description:(null==e?void 0:e.description)||r.description,icons:null!=(n=null==e?void 0:e.icons)&&n.length&&e.icons.length>0?e.icons:r.icons})}catch(vS){return console.warn("Error populating app metadata",vS),e||r}}function zm(e,t){return e.filter(function(e){return t.includes(e)}).length===e.length}function Hm(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue.FIVE_MINUTES,o=arguments.length>1?arguments[1]:void 0,a=ue.toMiliseconds(i||ue.FIVE_MINUTES);return{resolve:function(t){n&&e&&(clearTimeout(n),e(t),r=Promise.resolve(t))},reject:function(e){n&&t&&(clearTimeout(n),t(e))},done:function(){return new Promise(function(i,s){if(r)return i(r);n=setTimeout(function(){var e=new Error(o);r=Promise.reject(e),s(e)},a),e=i,t=s})}}}function Vm(e){var t=r(e.split(":"),2),n=t[0],i=t[1],o={id:void 0,topic:void 0};if("topic"===n&&"string"==typeof i)o.topic=i;else{if("id"!==n||!Number.isInteger(Number(i)))throw new Error("Invalid target, expected id:number or topic:string, got ".concat(n,":").concat(i));o.id=Number(i)}return o}function Fm(e,t){return ue.fromMiliseconds(Date.now()+ue.toMiliseconds(e))}function Km(e){return Date.now()>=ue.toMiliseconds(e)}function Wm(e,t){return"".concat(e).concat(t?":".concat(t):"")}function Gm(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return l(new Set([].concat(l(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),l(e))))}function Zm(e){return Ym.apply(this,arguments)}function Ym(){return Ym=g(d().m(function e(t){var n,r,i,o,a,s,c,u,l;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=t.id,r=t.topic,i=t.wcDeepLink,e.p=1,i){e.n=2;break}return e.a(2);case 2:if(a="string"==typeof i?JSON.parse(i):i,"string"==typeof(s=null==a?void 0:a.href)){e.n=3;break}return e.a(2);case 3:if(c=Jm(s,n,r),(u=qm())!==Cm){e.n=5;break}if(null!=(o=zo.getDocument())&&o.hasFocus()){e.n=4;break}return console.warn("Document does not have focus, skipping deeplink."),e.a(2);case 4:Qm(c),e.n=6;break;case 5:if(!(u===Rm&&_(null==global?void 0:global.Linking)<"u")){e.n=6;break}return e.n=6,global.Linking.openURL(c);case 6:e.n=8;break;case 7:e.p=7,l=e.v,console.error(l);case 8:return e.a(2)}},e,null,[[1,7]])})),Ym.apply(this,arguments)}function Jm(e,t,n){var r="requestId=".concat(t,"&sessionTopic=").concat(n);e.endsWith("/")&&(e=e.slice(0,-1));var i="".concat(e);if(e.startsWith("https://t.me")){var o=e.includes("?")?"&startapp=":"?startapp=";i="".concat(i).concat(o).concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Buffer.from(e).toString("base64");return t?n.replace(/[=]/g,""):n}(r,!0))}else i="".concat(i,"/wc?").concat(r);return i}function Qm(e){var t="_self";!function(){try{return window.self!==window.top}catch(e){return!1}}()?(("undefined"==typeof window?"undefined":_(window))<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"):t="_top",window.open(e,t,"noreferrer noopener")}function Xm(e,t){return $m.apply(this,arguments)}function $m(){return $m=g(d().m(function e(t,n){var r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r="",e.p=1,!Dm()||!(r=localStorage.getItem(n))){e.n=2;break}return e.a(2,r);case 2:return e.n=3,t.getItem(n);case 3:r=e.v,e.n=5;break;case 4:e.p=4,i=e.v,console.error(i);case 5:return e.a(2,r)}},e,null,[[1,4]])})),$m.apply(this,arguments)}function ew(e,t){if(!e.includes(t))return null;var n=e.split(/([&,?,=])/),r=n.indexOf(t);return n[r+2]}function tw(){return("undefined"==typeof process?"undefined":_(process))<"u"&&"true"===Em.IS_VITEST}function nw(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function rw(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function iw(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ow(e,t){rw(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var aw=BigInt(Math.pow(2,32)-1),sw=BigInt(32);function cw(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&aw),l:Number(e>>sw&aw)}:{h:0|Number(e>>sw&aw),l:0|Number(e&aw)}}var uw="object"==("undefined"==typeof globalThis?"undefined":_(globalThis))&&"crypto"in globalThis?globalThis.crypto:void 0;function lw(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function fw(e,t){return e<<32-t|e>>>t}var hw=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function dw(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function pw(e){for(var t=0;t<e.length;t++)e[t]=dw(e[t])}function vw(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+_(e));return new Uint8Array((new TextEncoder).encode(e))}(e)),rw(e),e}function gw(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];rw(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r}var yw=function(){return P(function e(){S(this,e)},[{key:"clone",value:function(){return this._cloneInto()}}])}();function mw(e){var t=function(t){return e().update(vw(t)).digest()},n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(){return e()},t}function ww(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(uw&&"function"==typeof uw.getRandomValues)return uw.getRandomValues(new Uint8Array(e));if(uw&&"function"==typeof uw.randomBytes)return uw.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}for(var bw=[],Ew=[],kw=[],Iw=BigInt(0),Sw=BigInt(1),Ow=BigInt(2),Pw=BigInt(7),xw=BigInt(256),_w=BigInt(113),Aw=0,Tw=Sw,Nw=1,Rw=0;Aw<24;Aw++){var Bw;Nw=(Bw=[Rw,(2*Nw+3*Rw)%5])[0],Rw=Bw[1],bw.push(2*(5*Rw+Nw)),Ew.push((Aw+1)*(Aw+2)/2%64);for(var Cw=Iw,Uw=0;Uw<7;Uw++)(Tw=(Tw<<Sw^(Tw>>Pw)*_w)%xw)&Ow&&(Cw^=Sw<<(Sw<<BigInt(Uw))-Sw);kw.push(Cw)}var jw=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length),i=0;i<e.length;i++){var o=cw(e[i],t),a=[o.h,o.l];n[i]=a[0],r[i]=a[1]}return[n,r]}(kw,!0),Lw=r(jw,2),Dw=Lw[0],qw=Lw[1],Mw=function(e,t,n){return n>32?function(e,t,n){return t<<n-32|e>>>64-n}(e,t,n):function(e,t,n){return e<<n|t>>>32-n}(e,t,n)},zw=function(e,t,n){return n>32?function(e,t,n){return e<<n-32|t>>>64-n}(e,t,n):function(e,t,n){return t<<n|e>>>32-n}(e,t,n)};var Hw=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(S(this,t),(i=y(this,t)).blockLen=e,i.suffix=n,i.outputLen=r,i.enableXOF=o,i.rounds=a,i.pos=0,i.posOut=0,i.finished=!1,i.destroyed=!1,nw(r),0>=i.blockLen||i.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");return i.state=new Uint8Array(200),i.state32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}(i.state),i}return k(t,e),P(t,[{key:"keccak",value:function(){hw||pw(this.state32),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,n=new Uint32Array(10),r=24-t;r<24;r++){for(var i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(var o=0;o<10;o+=2)for(var a=(o+8)%10,s=(o+2)%10,c=n[s],u=n[s+1],l=Mw(c,u,1)^n[a],f=zw(c,u,1)^n[a+1],h=0;h<50;h+=10)e[o+h]^=l,e[o+h+1]^=f;for(var d=e[2],p=e[3],v=0;v<24;v++){var g=Ew[v],y=Mw(d,p,g),m=zw(d,p,g),w=bw[v];d=e[w],p=e[w+1],e[w]=y,e[w+1]=m}for(var b=0;b<50;b+=10){for(var E=0;E<10;E++)n[E]=e[b+E];for(var k=0;k<10;k++)e[b+k]^=~n[(k+2)%10]&n[(k+4)%10]}e[0]^=Dw[r],e[1]^=qw[r]}n.fill(0)}(this.state32,this.rounds),hw||pw(this.state32),this.posOut=0,this.pos=0}},{key:"update",value:function(e){iw(this);for(var t=this.blockLen,n=this.state,r=(e=vw(e)).length,i=0;i<r;){for(var o=Math.min(t-this.pos,r-i),a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}},{key:"finish",value:function(){if(!this.finished){this.finished=!0;var e=this.state,t=this.suffix,n=this.pos,r=this.blockLen;e[n]^=t,!!(128&t)&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}}},{key:"writeInto",value:function(e){iw(this,!1),rw(e),this.finish();for(var t=this.state,n=this.blockLen,r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();var o=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}},{key:"xofInto",value:function(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}},{key:"xof",value:function(e){return nw(e),this.xofInto(new Uint8Array(e))}},{key:"digestInto",value:function(e){if(ow(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}},{key:"digest",value:function(){return this.digestInto(new Uint8Array(this.outputLen))}},{key:"destroy",value:function(){this.destroyed=!0,this.state.fill(0)}},{key:"_cloneInto",value:function(e){var n=this.blockLen,r=this.suffix,i=this.outputLen,o=this.rounds,a=this.enableXOF;return e||(e=new t(n,r,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}])}(yw),Vw=function(e,t,n){return mw(function(){return new Hw(t,e,n)})}(1,136,32);function Fw(e){var t="Ethereum Signed Message:\n".concat(e.length),n=(new TextEncoder).encode(t+e);return"0x"+Buffer.from(Vw(n)).toString("hex")}function Kw(e,t,n,r,i,o){return Ww.apply(this,arguments)}function Ww(){return Ww=g(d().m(function e(t,n,r,i,o,a){var s;return d().w(function(e){for(;;)switch(e.n){case 0:s=r.t,e.n="eip191"===s?1:"eip1271"===s?3:5;break;case 1:return e.n=2,Gw(t,n,r.s);case 2:case 4:return e.a(2,e.v);case 3:return e.n=4,Yw(t,n,r.s,i,o,a);case 5:throw new Error("verifySignature failed: Attempted to verify CacaoSignature with unknown type: ".concat(r.t));case 6:return e.a(2)}},e)})),Ww.apply(this,arguments)}function Gw(e,t,n){return Zw.apply(this,arguments)}function Zw(){return Zw=g(d().m(function e(t,n,r){var i,o;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,mm({hash:Fw(n),signature:r});case 1:return i=e.v.toLowerCase(),o=t.toLowerCase(),e.a(2,i===o)}},e)})),Zw.apply(this,arguments)}function Yw(e,t,n,r,i,o){return Jw.apply(this,arguments)}function Jw(){return Jw=g(d().m(function e(t,n,r,i,o,a){var s,c,u,l,f,h,p,v,g;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if((s=km(i)).namespace&&s.reference){e.n=1;break}throw new Error("isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ".concat(i));case 1:return e.p=1,c="0x1626ba7e",u=r.substring(2),l=Fw(n).substring(2),f=c+l+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+u,e.n=2,fetch("".concat(a||"https://rpc.walletconnect.org/v1","/?chainId=").concat(i,"&projectId=").concat(o),{method:"POST",body:JSON.stringify({id:Qw(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:f},"latest"]})});case 2:return h=e.v,e.n=3,h.json();case 3:return p=e.v,v=p.result,e.a(2,!!v&&v.slice(0,c.length).toLowerCase()===c.toLowerCase());case 4:return e.p=4,g=e.v,e.a(2,(console.error("isValidEip1271Signature: ",g),!1))}},e,null,[[1,4]])})),Jw.apply(this,arguments)}function Qw(){return Date.now()+Math.floor(1e3*Math.random())}var Xw=Object.defineProperty,$w=Object.defineProperties,eb=Object.getOwnPropertyDescriptors,tb=Object.getOwnPropertySymbols,nb=Object.prototype.hasOwnProperty,rb=Object.prototype.propertyIsEnumerable,ib=function(e,t,n){return t in e?Xw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},ob=function(e){return null==e?void 0:e.split(":")},ab=function(e){var t=e&&ob(e);if(t)return t[2]+":"+t[3]},sb=function(e){var t=e&&ob(e);if(t)return t.pop()};function cb(e){return ub.apply(this,arguments)}function ub(){return ub=g(d().m(function e(t){var n,r,i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:return n=t.cacao,r=t.projectId,i=n.s,o=n.p,a=lb(o,o.iss),s=sb(o.iss),e.n=1,Kw(s,a,i,ab(o.iss),r);case 1:return e.a(2,e.v)}},e)})),ub.apply(this,arguments)}var lb=function(e,t){var n="".concat(e.domain," wants you to sign in with your Ethereum account:"),r=sb(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");var i=e.statement||void 0,o="URI: ".concat(e.aud||e.uri),a="Version: ".concat(e.version),s="Chain ID: ".concat(function(e){var t=e&&ob(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]}(t)),c="Nonce: ".concat(e.nonce),u="Issued At: ".concat(e.iat),l=e.exp?"Expiration Time: ".concat(e.exp):void 0,f=e.nbf?"Not Before: ".concat(e.nbf):void 0,h=e.requestId?"Request ID: ".concat(e.requestId):void 0,d=e.resources?"Resources:".concat(e.resources.map(function(e){return"\n- ".concat(e)}).join("")):void 0,p=wb(e.resources);p&&(i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;fb(t);var n="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(n))return e;var r=[],i=0;Object.keys(t.att).forEach(function(e){var n=Object.keys(t.att[e]).map(function(e){return{ability:e.split("/")[0],action:e.split("/")[1]}});n.sort(function(e,t){return e.action.localeCompare(t.action)});var o={};n.forEach(function(e){o[e.ability]||(o[e.ability]=[]),o[e.ability].push(e.action)});var a=Object.keys(o).map(function(t){return i++,"(".concat(i,") '").concat(t,"': '").concat(o[t].join("', '"),"' for '").concat(e,"'.")});r.push(a.join(", ").replace(".,","."))});var o=r.join(" "),a="".concat(n).concat(o);return"".concat(e?e+" ":"").concat(a)}(i,pb(p)));return[n,r,"",i,"",o,a,s,c,u,l,f,h,d].filter(function(e){return null!=e}).join("\n")};function fb(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");var t=Object.keys(e.att);if(null==t||!t.length)throw new Error("No resources found in `att` property");t.forEach(function(t){var n=e.att[t];if(Array.isArray(n))throw new Error("Resource must be an object: ".concat(t));if("object"!=_(n))throw new Error("Resource must be an object: ".concat(t));if(!Object.keys(n).length)throw new Error("Resource object is empty: ".concat(t));Object.keys(n).forEach(function(e){var t=n[e];if(!Array.isArray(t))throw new Error("Ability limits ".concat(e," must be an array of objects, found: ").concat(t));if(!t.length)throw new Error("Value of ".concat(e," is empty array, must be an array with objects"));t.forEach(function(t){if("object"!=_(t))throw new Error("Ability limits (".concat(e,") must be an array of objects, found: ").concat(t))})})})}function hb(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=null===(n=t)||void 0===n?void 0:n.sort(function(e,t){return e.localeCompare(t)});var i=t.map(function(t){return s({},"".concat(e,"/").concat(t),[r])});return Object.assign.apply(Object,[{}].concat(l(i)))}function db(e){return fb(e),"urn:recap:".concat(function(e){return Buffer.from(JSON.stringify(e)).toString("base64")}(e).replace(/=/g,""))}function pb(e){var t=function(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}(e.replace("urn:recap:",""));return fb(t),t}function vb(e,t,n){var r=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return null!=n&&n.sort(function(e,t){return e.localeCompare(t)}),{att:s({},e,hb(t,n,r))}}(e,t,n);return db(r)}function gb(e,t){var n=function(e,t){fb(e),fb(t);var n=Object.keys(e.att).concat(Object.keys(t.att)).sort(function(e,t){return e.localeCompare(t)}),r={att:{}};return n.forEach(function(n){var i,o;Object.keys((null==(i=e.att)?void 0:i[n])||{}).concat(Object.keys((null==(o=t.att)?void 0:o[n])||{})).sort(function(e,t){return e.localeCompare(t)}).forEach(function(i){var o,a;r.att[n]=function(e,t){return $w(e,eb(t))}(function(e,t){for(var n in t||(t={}))nb.call(t,n)&&ib(e,n,t[n]);if(tb){var r,i=u(tb(t));try{for(i.s();!(r=i.n()).done;)n=r.value,rb.call(t,n)&&ib(e,n,t[n])}catch(o){i.e(o)}finally{i.f()}}return e}({},r.att[n]),s({},i,(null==(o=e.att[n])?void 0:o[i])||(null==(a=t.att[n])?void 0:a[i])))})}),r}(pb(e),pb(t));return db(n)}function yb(e){var t,n=pb(e);fb(n);var r=null==(t=n.att)?void 0:t.eip155;return r?Object.keys(r).map(function(e){return e.split("/")[1]}):[]}function mb(e){var t=pb(e);fb(t);var n=[];return Object.values(t.att).forEach(function(e){Object.values(e).forEach(function(e){var t;null!=(t=null==e?void 0:e[0])&&t.chains&&n.push(e[0].chains)})}),l(new Set(n.flat()))}function wb(e){if(e){var t=null==e?void 0:e[e.length-1];return function(e){return e&&e.includes("urn:recap:")}(t)?t:void 0}}function bb(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Eb(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function kb(e){if(!Eb(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function Ib(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Sb(e){if("boolean"!=typeof e)throw new Error("boolean expected, not ".concat(e))}var Ob=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function Pb(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Eb(e))throw new Error("Uint8Array expected, got "+_(e));e=Ab(e)}return e}function xb(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function _b(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),s=Number(n&o);e.setUint32(t+4,a,r),e.setUint32(t+0,s,r)}function Ab(e){return Uint8Array.from(e)}function Tb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)t[r].fill(0)}var Nb=function(e){return Uint8Array.from(e.split("").map(function(e){return e.charCodeAt(0)}))},Rb=Nb("expand 16-byte k"),Bb=Nb("expand 32-byte k"),Cb=Ob(Rb),Ub=Ob(Bb);function jb(e,t){return e<<t|e>>>32-t}function Lb(e){return e.byteOffset%4==0}var Db=Math.pow(2,32)-1,qb=new Uint32Array;var Mb=function(e,t){return 255&e[t++]|(255&e[t++])<<8},zb=function(){return P(function e(t){S(this,e),this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,kb(t=Pb(t),32);var n=Mb(t,0),r=Mb(t,2),i=Mb(t,4),o=Mb(t,6),a=Mb(t,8),s=Mb(t,10),c=Mb(t,12),u=Mb(t,14);this.r[0]=8191&n,this.r[1]=8191&(n>>>13|r<<3),this.r[2]=7939&(r>>>10|i<<6),this.r[3]=8191&(i>>>7|o<<9),this.r[4]=255&(o>>>4|a<<12),this.r[5]=a>>>1&8190,this.r[6]=8191&(a>>>14|s<<2),this.r[7]=8065&(s>>>11|c<<5),this.r[8]=8191&(c>>>8|u<<8),this.r[9]=u>>>5&127;for(var l=0;l<8;l++)this.pad[l]=Mb(t,16+2*l)},[{key:"process",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,r=this.h,i=this.r,o=i[0],a=i[1],s=i[2],c=i[3],u=i[4],l=i[5],f=i[6],h=i[7],d=i[8],p=i[9],v=Mb(e,t+0),g=Mb(e,t+2),y=Mb(e,t+4),m=Mb(e,t+6),w=Mb(e,t+8),b=Mb(e,t+10),E=Mb(e,t+12),k=Mb(e,t+14),I=r[0]+(8191&v),S=r[1]+(8191&(v>>>13|g<<3)),O=r[2]+(8191&(g>>>10|y<<6)),P=r[3]+(8191&(y>>>7|m<<9)),x=r[4]+(8191&(m>>>4|w<<12)),_=r[5]+(w>>>1&8191),A=r[6]+(8191&(w>>>14|b<<2)),T=r[7]+(8191&(b>>>11|E<<5)),N=r[8]+(8191&(E>>>8|k<<8)),R=r[9]+(k>>>5|n),B=0,C=B+I*o+S*(5*p)+O*(5*d)+P*(5*h)+x*(5*f);B=C>>>13,C&=8191;var U=(B+=(C+=_*(5*l)+A*(5*u)+T*(5*c)+N*(5*s)+R*(5*a))>>>13)+I*a+S*o+O*(5*p)+P*(5*d)+x*(5*h);B=U>>>13,U&=8191,B+=(U+=_*(5*f)+A*(5*l)+T*(5*u)+N*(5*c)+R*(5*s))>>>13,U&=8191;var j=B+I*s+S*a+O*o+P*(5*p)+x*(5*d);B=j>>>13,j&=8191,B+=(j+=_*(5*h)+A*(5*f)+T*(5*l)+N*(5*u)+R*(5*c))>>>13,j&=8191;var L=B+I*c+S*s+O*a+P*o+x*(5*p);B=L>>>13,L&=8191,B+=(L+=_*(5*d)+A*(5*h)+T*(5*f)+N*(5*l)+R*(5*u))>>>13,L&=8191;var D=B+I*u+S*c+O*s+P*a+x*o;B=D>>>13,D&=8191,B+=(D+=_*(5*p)+A*(5*d)+T*(5*h)+N*(5*f)+R*(5*l))>>>13,D&=8191;var q=B+I*l+S*u+O*c+P*s+x*a;B=q>>>13,q&=8191,B+=(q+=_*o+A*(5*p)+T*(5*d)+N*(5*h)+R*(5*f))>>>13,q&=8191;var M=B+I*f+S*l+O*u+P*c+x*s;B=M>>>13,M&=8191,B+=(M+=_*a+A*o+T*(5*p)+N*(5*d)+R*(5*h))>>>13,M&=8191;var z=B+I*h+S*f+O*l+P*u+x*c;B=z>>>13,z&=8191,B+=(z+=_*s+A*a+T*o+N*(5*p)+R*(5*d))>>>13,z&=8191;var H=B+I*d+S*h+O*f+P*l+x*u;B=H>>>13,H&=8191,B+=(H+=_*c+A*s+T*a+N*o+R*(5*p))>>>13,H&=8191;var V=B+I*p+S*d+O*h+P*f+x*l;B=V>>>13,V&=8191,B+=(V+=_*u+A*c+T*s+N*a+R*o)>>>13,V&=8191,C=8191&(B=(B=(B<<2)+B|0)+(C&=8191)|0),U+=B>>>=13,r[0]=C,r[1]=U,r[2]=j,r[3]=L,r[4]=D,r[5]=q,r[6]=M,r[7]=z,r[8]=H,r[9]=V}},{key:"finalize",value:function(){var e=this.h,t=this.pad,n=new Uint16Array(10),r=e[1]>>>13;e[1]&=8191;for(var i=2;i<10;i++)e[i]+=r,r=e[i]>>>13,e[i]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,n[0]=e[0]+5,r=n[0]>>>13,n[0]&=8191;for(var o=1;o<10;o++)n[o]=e[o]+r,r=n[o]>>>13,n[o]&=8191;n[9]-=8192;for(var a=(1^r)-1,s=0;s<10;s++)n[s]&=a;a=~a;for(var c=0;c<10;c++)e[c]=e[c]&a|n[c];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);var u=e[0]+t[0];e[0]=65535&u;for(var l=1;l<8;l++)u=(e[l]+t[l]|0)+(u>>>16)|0,e[l]=65535&u;Tb(n)}},{key:"update",value:function(e){Ib(this);for(var t=this.buffer,n=this.blockLen,r=(e=Pb(e)).length,i=0;i<r;){var o=Math.min(n-this.pos,r-i);if(o!==n)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=r-i;i+=n)this.process(e,i)}return this}},{key:"destroy",value:function(){Tb(this.h,this.r,this.buffer,this.pad)}},{key:"digestInto",value:function(e){Ib(this),function(e,t){kb(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;var t=this.buffer,n=this.h,r=this.pos;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();for(var i=0,o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var n=e.slice(0,t);return this.destroy(),n}}])}();var Hb=function(e){var t=function(t,n){return e(n).update(Pb(t)).digest()},n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(t){return e(t)},t}(function(e){return new zb(e)});var Vb=function(e,t){var n=function(e,t){if(null==t||"object"!=_(t))throw new Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t),r=n.allowShortKeys,i=n.extendNonceFn,o=n.counterLength,a=n.counterRight,s=n.rounds;if("function"!=typeof e)throw new Error("core must be a function");return bb(o),bb(s),Sb(a),Sb(r),function(t,n,c,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;kb(t),kb(n),kb(c);var f=c.length;if(void 0===u&&(u=new Uint8Array(f)),kb(u),bb(l),l<0||l>=Db)throw new Error("arx: counter overflow");if(u.length<f)throw new Error("arx: output (".concat(u.length,") is shorter than data (").concat(f,")"));var h,d,p=[],v=t.length;if(32===v)p.push(h=Ab(t)),d=Ub;else{if(16!==v||!r)throw new Error("arx: invalid 32-byte key, got length=".concat(v));(h=new Uint8Array(32)).set(t),h.set(t,16),d=Cb,p.push(h)}Lb(n)||p.push(n=Ab(n));var g=Ob(h);if(i){if(24!==n.length)throw new Error("arx: extended nonce must be 24 bytes");i(d,g,Ob(n.subarray(0,16)),g),n=n.subarray(16)}var y=16-o;if(y!==n.length)throw new Error("arx: nonce must be ".concat(y," or 16 bytes"));if(12!==y){var m=new Uint8Array(12);m.set(n,a?0:12-n.length),n=m,p.push(n)}var w=Ob(n);return function(e,t,n,r,i,o,a,s){for(var c=i.length,u=new Uint8Array(64),l=Ob(u),f=Lb(i)&&Lb(o),h=f?Ob(i):qb,d=f?Ob(o):qb,p=0;p<c;a++){if(e(t,n,r,l,a,s),a>=Db)throw new Error("arx: counter overflow");var v=Math.min(64,c-p);if(f&&64===v){var g=p/4;if(p%4!=0)throw new Error("arx: invalid block position");for(var y,m=0;m<16;m++)d[y=g+m]=h[y]^l[m];p+=64}else{for(var w,b=0;b<v;b++)o[w=p+b]=i[w]^u[b];p+=v}}}(e,d,g,w,c,u,l,s),Tb.apply(void 0,p),u}}(function(e,t,n,r,i){for(var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,a=e[0],s=e[1],c=e[2],u=e[3],l=t[0],f=t[1],h=t[2],d=t[3],p=t[4],v=t[5],g=t[6],y=t[7],m=i,w=n[0],b=n[1],E=n[2],k=a,I=s,S=c,O=u,P=l,x=f,_=h,A=d,T=p,N=v,R=g,B=y,C=m,U=w,j=b,L=E,D=0;D<o;D+=2)C=jb(C^(k=k+P|0),16),P=jb(P^(T=T+C|0),12),C=jb(C^(k=k+P|0),8),P=jb(P^(T=T+C|0),7),U=jb(U^(I=I+x|0),16),x=jb(x^(N=N+U|0),12),U=jb(U^(I=I+x|0),8),x=jb(x^(N=N+U|0),7),j=jb(j^(S=S+_|0),16),_=jb(_^(R=R+j|0),12),j=jb(j^(S=S+_|0),8),_=jb(_^(R=R+j|0),7),L=jb(L^(O=O+A|0),16),A=jb(A^(B=B+L|0),12),L=jb(L^(O=O+A|0),8),A=jb(A^(B=B+L|0),7),L=jb(L^(k=k+x|0),16),x=jb(x^(R=R+L|0),12),L=jb(L^(k=k+x|0),8),x=jb(x^(R=R+L|0),7),C=jb(C^(I=I+_|0),16),_=jb(_^(B=B+C|0),12),C=jb(C^(I=I+_|0),8),_=jb(_^(B=B+C|0),7),U=jb(U^(S=S+A|0),16),A=jb(A^(T=T+U|0),12),U=jb(U^(S=S+A|0),8),A=jb(A^(T=T+U|0),7),j=jb(j^(O=O+P|0),16),P=jb(P^(N=N+j|0),12),j=jb(j^(O=O+P|0),8),P=jb(P^(N=N+j|0),7);var q=0;r[q++]=a+k|0,r[q++]=s+I|0,r[q++]=c+S|0,r[q++]=u+O|0,r[q++]=l+P|0,r[q++]=f+x|0,r[q++]=h+_|0,r[q++]=d+A|0,r[q++]=p+T|0,r[q++]=v+N|0,r[q++]=g+R|0,r[q++]=y+B|0,r[q++]=m+C|0,r[q++]=w+U|0,r[q++]=b+j|0,r[q++]=E+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),Fb=new Uint8Array(16),Kb=function(e,t){e.update(t);var n=t.length%16;n&&e.update(Fb.subarray(n))},Wb=new Uint8Array(32);function Gb(e,t,n,r,i){var o=e(t,n,Wb),a=Hb.create(o);i&&Kb(a,i),Kb(a,r);var s=new Uint8Array(16),c=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}(s);_b(c,0,BigInt(i?i.length:0),!0),_b(c,8,BigInt(r.length),!0),a.update(s);var u=a.digest();return Tb(o,s),u}!function(e,t){function n(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(kb(n),void 0!==e.nonceLength){var a=i[0];if(!a)throw new Error("nonce / iv required");e.varSizeNonce?kb(a):kb(a,e.nonceLength)}var s=e.tagLength;s&&void 0!==i[1]&&kb(i[1]);var c=t.apply(void 0,[n].concat(i)),u=function(e,t){if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");kb(t)}},l=!1;return{encrypt:function(e,t){if(l)throw new Error("cannot encrypt() twice with same key + nonce");return l=!0,kb(e),u(c.encrypt.length,t),c.encrypt(e,t)},decrypt:function(e,t){if(kb(e),s&&e.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return u(c.decrypt.length,t),c.decrypt(e,t)}}}Object.assign(n,e)}({blockSize:64,nonceLength:12,tagLength:16},function(e){return function(t,n,r){return{encrypt:function(i,o){var a=i.length;(o=xb(a+16,o,!1)).set(i);var s=o.subarray(0,-16);e(t,n,s,s,1);var c=Gb(e,t,n,s,r);return o.set(c,a),Tb(c),o},decrypt:function(i,o){o=xb(i.length-16,o,!1);var a=i.subarray(0,-16),s=i.subarray(-16),c=Gb(e,t,n,a,r);if(!function(e,t){if(e.length!==t.length)return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}(s,c))throw new Error("invalid tag");return o.set(i.subarray(0,-16)),e(t,n,o,o,1),Tb(c),o}}}}(Vb));var Zb=function(e){function t(e,n){var r;S(this,t),(r=y(this,t)).finished=!1,r.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");nw(e.outputLen),nw(e.blockLen)}(e);var i=vw(n);if(r.iHash=e.create(),"function"!=typeof r.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");r.blockLen=r.iHash.blockLen,r.outputLen=r.iHash.outputLen;var o=r.blockLen,a=new Uint8Array(o);a.set(i.length>o?e.create().update(i).digest():i);for(var s=0;s<a.length;s++)a[s]^=54;r.iHash.update(a),r.oHash=e.create();for(var c=0;c<a.length;c++)a[c]^=106;return r.oHash.update(a),a.fill(0),r}return k(t,e),P(t,[{key:"update",value:function(e){return iw(this),this.iHash.update(e),this}},{key:"digestInto",value:function(e){iw(this),rw(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}},{key:"digest",value:function(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}},{key:"_cloneInto",value:function(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,n=this.iHash,r=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}])}(yw),Yb=function(e,t,n){return new Zb(e,t).update(n).digest()};function Jb(e,t,n){return e&t^~e&n}function Qb(e,t,n){return e&t^e&n^t&n}Yb.create=function(e,t){return new Zb(e,t)};var Xb=function(e){function t(e,n,r,i){var o;return S(this,t),(o=y(this,t)).blockLen=e,o.outputLen=n,o.padOffset=r,o.isLE=i,o.finished=!1,o.length=0,o.pos=0,o.destroyed=!1,o.buffer=new Uint8Array(e),o.view=lw(o.buffer),o}return k(t,e),P(t,[{key:"update",value:function(e){iw(this);for(var t=this.view,n=this.buffer,r=this.blockLen,i=(e=vw(e)).length,o=0;o<i;){var a=Math.min(r-this.pos,i-o);if(a!==r)n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===r&&(this.process(t,0),this.pos=0);else for(var s=lw(e);r<=i-o;o+=r)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){iw(this),ow(e,this),this.finished=!0;var t=this.buffer,n=this.view,r=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(var a=o;a<r;a++)t[a]=0;(function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),s=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+u,s,r)})(n,r-8,BigInt(8*this.length),i),this.process(n,0);var s=lw(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(var f=0;f<u;f++)s.setUint32(4*f,l[f],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var n=e.slice(0,t);return this.destroy(),n}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,l(this.get()));var n=this.blockLen,r=this.buffer,i=this.length,o=this.finished,a=this.destroyed,s=this.pos;return e.length=i,e.pos=s,e.finished=o,e.destroyed=a,i%n&&e.buffer.set(r),e}}])}(yw),$b=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),eE=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tE=new Uint32Array(64),nE=function(e){function t(){var e;return S(this,t),(e=y(this,t,[64,32,8,!1])).A=0|eE[0],e.B=0|eE[1],e.C=0|eE[2],e.D=0|eE[3],e.E=0|eE[4],e.F=0|eE[5],e.G=0|eE[6],e.H=0|eE[7],e}return k(t,e),P(t,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(e,t,n,r,i,o,a,s){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|s}},{key:"process",value:function(e,t){for(var n=0;n<16;n++,t+=4)tE[n]=e.getUint32(t,!1);for(var r=16;r<64;r++){var i=tE[r-15],o=tE[r-2],a=fw(i,7)^fw(i,18)^i>>>3,s=fw(o,17)^fw(o,19)^o>>>10;tE[r]=s+tE[r-7]+a+tE[r-16]|0}for(var c=this.A,u=this.B,l=this.C,f=this.D,h=this.E,d=this.F,p=this.G,v=this.H,g=0;g<64;g++){var y=v+(fw(h,6)^fw(h,11)^fw(h,25))+Jb(h,d,p)+$b[g]+tE[g]|0,m=(fw(c,2)^fw(c,13)^fw(c,22))+Qb(c,u,l)|0;v=p,p=d,d=h,h=f+y|0,f=l,l=u,u=c,c=y+m|0}c=c+this.A|0,u=u+this.B|0,l=l+this.C|0,f=f+this.D|0,h=h+this.E|0,d=d+this.F|0,p=p+this.G|0,v=v+this.H|0,this.set(c,u,l,f,h,d,p,v)}},{key:"roundClean",value:function(){tE.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}])}(Xb),rE=mw(function(){return new nE}),iE=BigInt(0),oE=BigInt(1),aE=BigInt(2);function sE(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function cE(e){if(!sE(e))throw new Error("Uint8Array expected")}function uE(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}var lE=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function fE(e){cE(e);for(var t="",n=0;n<e.length;n++)t+=lE[e[n]];return t}function hE(e){var t=e.toString(16);return 1&t.length?"0"+t:t}function dE(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));return""===e?iE:BigInt("0x"+e)}var pE=48,vE=57,gE=65,yE=70,mE=97,wE=102;function bE(e){return e>=pE&&e<=vE?e-pE:e>=gE&&e<=yE?e-(gE-10):e>=mE&&e<=wE?e-(mE-10):void 0}function EE(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));var t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var r=new Uint8Array(n),i=0,o=0;i<n;i++,o+=2){var a=bE(e.charCodeAt(o)),s=bE(e.charCodeAt(o+1));if(void 0===a||void 0===s){var c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}r[i]=16*a+s}return r}function kE(e){return dE(fE(e))}function IE(e){return cE(e),dE(fE(Uint8Array.from(e).reverse()))}function SE(e,t){return EE(e.toString(16).padStart(2*t,"0"))}function OE(e,t){return SE(e,t).reverse()}function PE(e,t,n){var r;if("string"==typeof t)try{r=EE(t)}catch(jt){throw new Error(e+" must be hex string or Uint8Array, cause: "+jt)}else{if(!sE(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}var i=r.length;if("number"==typeof n&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function xE(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];cE(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r}var _E=function(e){return"bigint"==typeof e&&iE<=e};function AE(e,t,n){return _E(e)&&_E(t)&&_E(n)&&t<=e&&e<n}function TE(e,t,n,r){if(!AE(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function NE(e){var t;for(t=0;e>iE;e>>=oE,t+=1);return t}var RE=function(e){return(aE<<BigInt(e-1))-oE},BE=function(e){return new Uint8Array(e)},CE=function(e){return Uint8Array.from(e)};function UE(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");var r=BE(e),i=BE(e),o=0,a=function(){r.fill(1),i.fill(0),o=0},s=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.apply(void 0,[i,r].concat(t))},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BE();i=s(CE([0]),e),r=s(),0!==e.length&&(i=s(CE([1]),e),r=s())},u=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var e=0,n=[];e<t;){var i=(r=s()).slice();n.push(i),e+=r.length}return xE.apply(void 0,n)};return function(e,t){var n;for(a(),c(e);!(n=t(u()));)c();return a(),n}}var jE={bigint:function(e){return"bigint"==typeof e},function:function(e){return"function"==typeof e},boolean:function(e){return"boolean"==typeof e},string:function(e){return"string"==typeof e},stringOrUint8Array:function(e){return"string"==typeof e||sE(e)},isSafeInteger:function(e){return Number.isSafeInteger(e)},array:function(e){return Array.isArray(e)},field:function(e,t){return t.Fp.isValid(e)},hash:function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)}};function LE(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=function(t,n,r){var i=jE[n];if("function"!=typeof i)throw new Error("invalid validator function");var o=e[t];if(!(r&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)},o=0,a=Object.entries(t);o<a.length;o++){var s=r(a[o],2);i(s[0],s[1],!1)}for(var c=0,u=Object.entries(n);c<u.length;c++){var l=r(u[c],2);i(l[0],l[1],!0)}return e}function DE(e){var t=new WeakMap;return function(n){var r=t.get(n);if(void 0!==r)return r;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.apply(void 0,[n].concat(o));return t.set(n,s),s}}var qE=Object.freeze({__proto__:null,isBytes:sE,abytes:cE,abool:uE,bytesToHex:fE,numberToHexUnpadded:hE,hexToNumber:dE,hexToBytes:EE,bytesToNumberBE:kE,bytesToNumberLE:IE,numberToBytesBE:SE,numberToBytesLE:OE,numberToVarBytesBE:function(e){return EE(hE(e))},ensureBytes:PE,concatBytes:xE,equalBytes:function(e,t){if(e.length!==t.length)return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))},inRange:AE,aInRange:TE,bitLen:NE,bitGet:function(e,t){return e>>BigInt(t)&oE},bitSet:function(e,t,n){return e|(n?oE:iE)<<BigInt(t)},bitMask:RE,createHmacDrbg:UE,validateObject:LE,notImplemented:function(){throw new Error("not implemented")},memoized:DE}),ME=BigInt(0),zE=BigInt(1),HE=BigInt(2),VE=BigInt(3),FE=BigInt(4),KE=BigInt(5),WE=BigInt(8);function GE(e,t){var n=e%t;return n>=ME?n:t+n}function ZE(e,t,n){if(t<ME)throw new Error("invalid exponent, negatives unsupported");if(n<=ME)throw new Error("invalid modulus");if(n===zE)return ME;for(var r=zE;t>ME;)t&zE&&(r=r*e%n),e=e*e%n,t>>=zE;return r}function YE(e,t,n){for(var r=e;t-- >ME;)r*=r,r%=n;return r}function JE(e,t){if(e===ME)throw new Error("invert: expected non-zero number");if(t<=ME)throw new Error("invert: expected positive modulus, got "+t);for(var n=GE(e,t),r=t,i=ME,o=zE;n!==ME;){var a=r%n,s=i-o*(r/n);r=n,n=a,i=o,o=s}if(r!==zE)throw new Error("invert: does not exist");return GE(i,t)}function QE(e){if(e%FE===VE){var t=(e+zE)/FE;return function(e,n){var r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%WE===KE){var n=(e-KE)/WE;return function(e,t){var r=e.mul(t,HE),i=e.pow(r,n),o=e.mul(t,i),a=e.mul(e.mul(o,HE),i),s=e.mul(o,e.sub(a,e.ONE));if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}}return function(e){var t,n,r,i=(e-zE)/HE;for(t=e-zE,n=0;t%HE===ME;t/=HE,n++);for(r=HE;r<e&&ZE(r,i,e)!==e-zE;r++)if(r>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){var o=(e+zE)/FE;return function(e,t){var n=e.pow(t,o);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}}var a=(t+zE)/HE;return function(e,o){if(e.pow(o,i)===e.neg(e.ONE))throw new Error("Cannot find square root");for(var s=n,c=e.pow(e.mul(e.ONE,r),t),u=e.pow(o,a),l=e.pow(o,t);!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;for(var f=1,h=e.sqr(l);f<s&&!e.eql(h,e.ONE);f++)h=e.sqr(h);var d=e.pow(c,zE<<BigInt(s-f-1));c=e.sqr(d),u=e.mul(u,d),l=e.mul(l,c),s=f}return u}}(e)}var XE=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function $E(e,t){var n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function ek(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=ME)throw new Error("invalid field: expected ORDER > 0, got "+e);var i,o=$E(e,t),a=o.nBitLength,s=o.nByteLength;if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var c=Object.freeze({ORDER:e,isLE:n,BITS:a,BYTES:s,MASK:RE(a),ZERO:ME,ONE:zE,create:function(t){return GE(t,e)},isValid:function(t){if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+_(t));return ME<=t&&t<e},is0:function(e){return e===ME},isOdd:function(e){return(e&zE)===zE},neg:function(t){return GE(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return GE(t*t,e)},add:function(t,n){return GE(t+n,e)},sub:function(t,n){return GE(t-n,e)},mul:function(t,n){return GE(t*n,e)},pow:function(e,t){return function(e,t,n){if(n<ME)throw new Error("invalid exponent, negatives unsupported");if(n===ME)return e.ONE;if(n===zE)return t;for(var r=e.ONE,i=t;n>ME;)n&zE&&(r=e.mul(r,i)),i=e.sqr(i),n>>=zE;return r}(c,e,t)},div:function(t,n){return GE(t*JE(n,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return JE(t,e)},sqrt:r.sqrt||function(t){return i||(i=QE(e)),i(c,t)},invertBatch:function(e){return function(e,t){var n=new Array(t.length),r=t.reduce(function(t,r,i){return e.is0(r)?t:(n[i]=t,e.mul(t,r))},e.ONE),i=e.inv(r);return t.reduceRight(function(t,r,i){return e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))},i),n}(c,e)},cmov:function(e,t,n){return n?t:e},toBytes:function(e){return n?OE(e,s):SE(e,s)},fromBytes:function(e){if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return n?IE(e):kE(e)}});return Object.freeze(c)}function tk(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");var t=e.toString(2).length;return Math.ceil(t/8)}function nk(e){var t=tk(e);return t+Math.ceil(t/2)}var rk=BigInt(0),ik=BigInt(1);function ok(e,t){var n=t.negate();return e?n:t}function ak(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function sk(e,t){return ak(e,t),{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1)}}var ck=new WeakMap,uk=new WeakMap;function lk(e){return uk.get(e)||1}function fk(e,t,n,r){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(function(e,n){if(!(e instanceof t))throw new Error("invalid point at index "+n)})}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(function(e,n){if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");for(var i=e.ZERO,o=NE(BigInt(n.length)),a=o>12?o-3:o>4?o-2:o?2:1,s=(1<<a)-1,c=new Array(s+1).fill(i),u=i,l=Math.floor((t.BITS-1)/a)*a;l>=0;l-=a){c.fill(i);for(var f=0;f<r.length;f++){var h=r[f],d=Number(h>>BigInt(l)&BigInt(s));c[d]=c[d].add(n[f])}for(var p=i,v=c.length-1,g=i;v>0;v--)g=g.add(c[v]),p=p.add(g);if(u=u.add(p),0!==l)for(var y=0;y<a;y++)u=u.double()}return u}function hk(e){return function(e){var t=XE.reduce(function(e,t){return e[t]="function",e},{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});LE(e,t)}(e.Fp),LE(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(a(a(a({},$E(e.n,e.nBitLength)),e),{},{p:e.Fp.ORDER}))}BigInt(0),BigInt(1),BigInt(2),BigInt(8);BigInt(0),BigInt(1);var dk=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);var pk=BigInt(1),vk=BigInt(2),gk=BigInt(3),yk=BigInt(5);function mk(e){void 0!==e.lowS&&uE("lowS",e.lowS),void 0!==e.prehash&&uE("prehash",e.prehash)}BigInt(8),function(e){var t=function(e){return LE(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(a({},e))}(e),n=t.P,r=function(e){return GE(e,n)},i=t.montgomeryBits,o=Math.ceil(i/8),s=t.nByteLength,c=t.adjustScalarBytes||function(e){return e},u=t.powPminus2||function(e){return ZE(e,n-BigInt(2),n)};function l(e,t,n){var i=r(e*(t-n));return[r(t-i),r(n+i)]}var f=(t.a-BigInt(2))/BigInt(4);function h(e){return OE(r(e),o)}function d(e,t){var a=function(e){var t=PE("u coordinate",e,o);return 32===s&&(t[31]&=127),IE(t)}(t),d=function(e){var t=PE("scalar",e),n=t.length;if(n!==o&&n!==s)throw new Error("invalid scalar, expected "+o+" or "+s+" bytes, got "+n);return IE(c(t))}(e),p=function(e,t){TE("u",e,Ht$1,n),TE("scalar",t,Ht$1,n);for(var o,a=t,s=e,c=an$1,h=Ht$1,d=e,p=an$1,v=Ht$1,g=BigInt(i-1);g>=Ht$1;g--){var y=a>>g&an$1;l(v^=y,c,d)[0],o[1],l(v,h,p)[0],o[1];var m=c+h,w=r(m*m),b=c-h,E=r(b*b),k=w-E,I=d+p,S=r((d-p)*m),O=r(I*b),P=S+O,x=S-O;r(P*P),r(s*r(x*x)),r(w*E),r(k*(w+r(f*k)))}l(v,c,d)[0],o[1],l(v,h,p)[0],o[1];var _=u(h);return r(c*_)}(a,d);if(p===Ht$1)throw new Error("invalid private or public key received");return h(p)}var p=h(t.Gu);function v(e){return d(e,p)}}({P:dk,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:function(e){var t=dk,n=function(e){var t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),o=dk,a=e*e%o*e%o,s=YE(a,vk,o)*a%o,c=YE(s,pk,o)*e%o,u=YE(c,yk,o)*c%o,l=YE(u,t,o)*u%o,f=YE(l,n,o)*l%o,h=YE(f,r,o)*f%o,d=YE(h,i,o)*h%o,p=YE(d,i,o)*h%o,v=YE(p,t,o)*u%o;return{pow_p_5_8:YE(v,vk,o)*e%o,b2:a}}(e),r=n.pow_p_5_8,i=n.b2;return GE(YE(r,gk,t)*i,t)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:ww});var wk=qE.bytesToNumberBE,bk=qE.hexToBytes,Ek=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return S(this,t),y(this,t,[e])}return k(t,e),P(t)}(n(Error)),kk={Err:Ek,_tlv:{encode:function(e,t){var n=kk.Err;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");var r=t.length/2,i=hE(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");var o=r>127?hE(i.length/2|128):"";return hE(e)+o+i+t},decode:function(e,t){var n=kk.Err,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");var i=t[r++],o=0;if(!!(128&i)){var a=127&i;if(!a)throw new n("tlv.decode(long): indefinite length not supported");if(a>4)throw new n("tlv.decode(long): byte length is too big");var s=t.subarray(r,r+a);if(s.length!==a)throw new n("tlv.decode: length bytes not complete");if(0===s[0])throw new n("tlv.decode(long): zero leftmost byte");var c,l=u(s);try{for(l.s();!(c=l.n()).done;){o=o<<8|c.value}}catch(h){l.e(h)}finally{l.f()}if(r+=a,o<128)throw new n("tlv.decode(long): not minimal encoding")}else o=i;var f=t.subarray(r,r+o);if(f.length!==o)throw new n("tlv.decode: wrong value length");return{v:f,l:t.subarray(r+o)}}},_int:{encode:function(e){var t=kk.Err;if(e<Ik)throw new t("integer: negative integers are not allowed");var n=hE(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode:function(e){var t=kk.Err;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return wk(e)}},toSig:function(e){var t=kk.Err,n=kk._int,r=kk._tlv,i="string"==typeof e?bk(e):e;cE(i);var o=r.decode(48,i),a=o.v;if(o.l.length)throw new t("invalid signature: left bytes after parsing");var s=r.decode(2,a),c=s.v,u=s.l,l=r.decode(2,u),f=l.v;if(l.l.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(f)}},hexFromSig:function(e){var t=kk._tlv,n=kk._int,r=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,r)}},Ik=BigInt(0),Sk=BigInt(1);BigInt(2);var Ok=BigInt(3);function Pk(e){var t=function(e){var t=hk(e);LE(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var n=t.endo,r=t.Fp,i=t.a;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=_(n)||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze(a({},t))}(e),n=t.Fp,r=ek(t.n,t.nBitLength),i=t.toBytes||function(e,t,r){var i=t.toAffine();return xE(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))},o=t.fromBytes||function(e){var t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}};function s(e){var r=t.a,i=t.b,o=n.sqr(e),a=n.mul(o,e);return n.add(n.add(a,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function c(e){var n,r=t.allowedPrivateKeyLengths,i=t.nByteLength,o=t.wrapPrivateKey,a=t.n;if(r&&"bigint"!=typeof e){if(sE(e)&&(e=fE(e)),"string"!=typeof e||!r.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*i,"0")}try{n="bigint"==typeof e?e:kE(PE("private key",e,i))}catch(s){throw new Error("invalid private key, expected hex or "+i+" bytes, got "+_(e))}return o&&(n=GE(n,a)),TE("private key",n,Sk,a),n}function u(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}var l=DE(function(e,t){var r=e.px,i=e.py,o=e.pz;if(n.eql(o,n.ONE))return{x:r,y:i};var a=e.is0();null==t&&(t=a?n.ONE:n.inv(o));var s=n.mul(r,t),c=n.mul(i,t),u=n.mul(o,t);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:s,y:c}}),f=DE(function(e){if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}var r=e.toAffine(),i=r.x,o=r.y;if(!n.isValid(i)||!n.isValid(o))throw new Error("bad point: x or y not FE");var a=n.sqr(o),c=s(i);if(!n.eql(a,c))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}),h=function(){function e(t,r,i){if(S(this,e),this.px=t,this.py=r,this.pz=i,null==t||!n.isValid(t))throw new Error("x required");if(null==r||!n.isValid(r))throw new Error("y required");if(null==i||!n.isValid(i))throw new Error("z required");Object.freeze(this)}return P(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){p.setWindowSize(this,e)}},{key:"assertValidity",value:function(){f(this)}},{key:"hasEvenY",value:function(){var e=this.toAffine().y;if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(e){u(e);var t=this.px,r=this.py,i=this.pz,o=e.px,a=e.py,s=e.pz,c=n.eql(n.mul(t,s),n.mul(o,i)),l=n.eql(n.mul(r,s),n.mul(a,i));return c&&l}},{key:"negate",value:function(){return new e(this.px,n.neg(this.py),this.pz)}},{key:"double",value:function(){var r=t.a,i=t.b,o=n.mul(i,Ok),a=this.px,s=this.py,c=this.pz,u=n.ZERO,l=n.ZERO,f=n.ZERO,h=n.mul(a,a),d=n.mul(s,s),p=n.mul(c,c),v=n.mul(a,s);return v=n.add(v,v),f=n.mul(a,c),f=n.add(f,f),u=n.mul(r,f),l=n.mul(o,p),l=n.add(u,l),u=n.sub(d,l),l=n.add(d,l),l=n.mul(u,l),u=n.mul(v,u),f=n.mul(o,f),p=n.mul(r,p),v=n.sub(h,p),v=n.mul(r,v),v=n.add(v,f),f=n.add(h,h),h=n.add(f,h),h=n.add(h,p),h=n.mul(h,v),l=n.add(l,h),p=n.mul(s,c),p=n.add(p,p),h=n.mul(p,v),u=n.sub(u,h),f=n.mul(p,d),f=n.add(f,f),new e(u,l,f=n.add(f,f))}},{key:"add",value:function(r){u(r);var i=this.px,o=this.py,a=this.pz,s=r.px,c=r.py,l=r.pz,f=n.ZERO,h=n.ZERO,d=n.ZERO,p=t.a,v=n.mul(t.b,Ok),g=n.mul(i,s),y=n.mul(o,c),m=n.mul(a,l),w=n.add(i,o),b=n.add(s,c);w=n.mul(w,b),b=n.add(g,y),w=n.sub(w,b),b=n.add(i,a);var E=n.add(s,l);return b=n.mul(b,E),E=n.add(g,m),b=n.sub(b,E),E=n.add(o,a),f=n.add(c,l),E=n.mul(E,f),f=n.add(y,m),E=n.sub(E,f),d=n.mul(p,b),f=n.mul(v,m),d=n.add(f,d),f=n.sub(y,d),d=n.add(y,d),h=n.mul(f,d),y=n.add(g,g),y=n.add(y,g),m=n.mul(p,m),b=n.mul(v,b),y=n.add(y,m),m=n.sub(g,m),m=n.mul(p,m),b=n.add(b,m),g=n.mul(y,b),h=n.add(h,g),g=n.mul(E,b),f=n.mul(w,f),f=n.sub(f,g),g=n.mul(w,y),d=n.mul(E,d),new e(f,h,d=n.add(d,g))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"wNAF",value:function(t){return p.wNAFCached(this,t,e.normalizeZ)}},{key:"multiplyUnsafe",value:function(r){var i=t.endo,o=t.n;TE("scalar",r,Ik,o);var a=e.ZERO;if(r===Ik)return a;if(this.is0()||r===Sk)return this;if(!i||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,r,e.normalizeZ);for(var s=i.splitScalar(r),c=s.k1neg,u=s.k1,l=s.k2neg,f=s.k2,h=a,d=a,v=this;u>Ik||f>Ik;)u&Sk&&(h=h.add(v)),f&Sk&&(d=d.add(v)),v=v.double(),u>>=Sk,f>>=Sk;return c&&(h=h.negate()),l&&(d=d.negate()),d=new e(n.mul(d.px,i.beta),d.py,d.pz),h.add(d)}},{key:"multiply",value:function(r){var i,o,a=t.endo,s=t.n;if(TE("scalar",r,Sk,s),a){var c=a.splitScalar(r),u=c.k1neg,l=c.k1,f=c.k2neg,h=c.k2,d=this.wNAF(l),v=d.p,g=d.f,y=this.wNAF(h),m=y.p,w=y.f;v=p.constTimeNegate(u,v),m=p.constTimeNegate(f,m),m=new e(n.mul(m.px,a.beta),m.py,m.pz),i=v.add(m),o=g.add(w)}else{var b=this.wNAF(r);i=b.p,o=b.f}return e.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(t,n,r){var i=e.BASE,o=function(e,t){return t!==Ik&&t!==Sk&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t)},a=o(this,n).add(o(t,r));return a.is0()?void 0:a}},{key:"toAffine",value:function(e){return l(this,e)}},{key:"isTorsionFree",value:function(){var n=t.h,r=t.isTorsionFree;if(n===Sk)return!0;if(r)return r(e,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var n=t.h,r=t.clearCofactor;return n===Sk?this:r?r(e,this):this.multiplyUnsafe(t.h)}},{key:"toRawBytes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return uE("isCompressed",t),this.assertValidity(),i(e,this,t)}},{key:"toHex",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return uE("isCompressed",e),fE(this.toRawBytes(e))}}],[{key:"fromAffine",value:function(t){var r=t||{},i=r.x,o=r.y;if(!t||!n.isValid(i)||!n.isValid(o))throw new Error("invalid affine point");if(t instanceof e)throw new Error("projective point not allowed");var a=function(e){return n.eql(e,n.ZERO)};return a(i)&&a(o)?e.ZERO:new e(i,o,n.ONE)}},{key:"normalizeZ",value:function(t){var r=n.invertBatch(t.map(function(e){return e.pz}));return t.map(function(e,t){return e.toAffine(r[t])}).map(e.fromAffine)}},{key:"fromHex",value:function(t){var n=e.fromAffine(o(PE("pointHex",t)));return n.assertValidity(),n}},{key:"fromPrivateKey",value:function(t){return e.BASE.multiply(c(t))}},{key:"msm",value:function(t,n){return fk(e,r,t,n)}}])}();h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);var d=t.nBitLength,p=function(e,t){return{constTimeNegate:ok,hasPrecomputes:function(e){return 1!==lk(e)},unsafeLadder:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,i=t;n>rk;)n&ik&&(r=r.add(i)),i=i.double(),n>>=ik;return r},precomputeWindow:function(e,n){for(var r=sk(n,t),i=r.windows,o=r.windowSize,a=[],s=e,c=s,u=0;u<i;u++){c=s,a.push(c);for(var l=1;l<o;l++)c=c.add(s),a.push(c);s=c.double()}return a},wNAF:function(n,r,i){for(var o=sk(n,t),a=o.windows,s=o.windowSize,c=e.ZERO,u=e.BASE,l=BigInt(Math.pow(2,n)-1),f=Math.pow(2,n),h=BigInt(n),d=0;d<a;d++){var p=d*s,v=Number(i&l);i>>=h,v>s&&(v-=f,i+=ik);var g=p,y=p+Math.abs(v)-1,m=d%2!=0,w=v<0;0===v?u=u.add(ok(m,r[g])):c=c.add(ok(w,r[y]))}return{p:c,f:u}},wNAFUnsafe:function(n,r,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO,a=sk(n,t),s=a.windows,c=a.windowSize,u=BigInt(Math.pow(2,n)-1),l=Math.pow(2,n),f=BigInt(n),h=0;h<s;h++){var d=h*c;if(i===rk)break;var p=Number(i&u);if(i>>=f,p>c&&(p-=l,i+=ik),0!==p){var v=r[d+Math.abs(p)-1];p<0&&(v=v.negate()),o=o.add(v)}}return o},getPrecomputes:function(e,t,n){var r=ck.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&ck.set(t,n(r))),r},wNAFCached:function(e,t,n){var r=lk(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe:function(e,t,n,r){var i=lk(e);return 1===i?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize:function(e,n){ak(n,t),uk.set(e,n),ck.delete(e)}}}(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:function(e){return AE(e,Sk,t.n)}}}function xk(e){var t=function(e){var t=hk(e);return LE(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(a({lowS:!0},t))}(e),n=t.Fp,r=t.n,i=n.BYTES+1,o=2*n.BYTES+1;function s(e){return GE(e,r)}function c(e){return JE(e,r)}var u=Pk(a(a({},t),{},{toBytes:function(e,t,r){var i=t.toAffine(),o=n.toBytes(i.x),a=xE;return uE("isCompressed",r),r?a(Uint8Array.from([t.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes:function(e){var t=e.length,r=e[0],a=e.subarray(1);if(t!==i||2!==r&&3!==r){if(t===o&&4===r)return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))};throw new Error("invalid Point, expected length of "+i+", or uncompressed "+o+", got "+t)}var s=kE(a);if(!AE(s,Sk,n.ORDER))throw new Error("Point is not on curve");var c,u=h(s);try{c=n.sqrt(u)}catch(YA){var l=YA instanceof Error?": "+YA.message:"";throw new Error("Point is not on curve"+l)}return!(1&~r)!==((c&Sk)===Sk)&&(c=n.neg(c)),{x:s,y:c}}})),l=u.ProjectivePoint,f=u.normPrivateKeyToScalar,h=u.weierstrassEquation,d=u.isWithinCurveOrder,p=function(e){return fE(SE(e,t.nByteLength))};function v(e){return e>r>>Sk}var g=function(e,t,n){return kE(e.slice(t,n))},y=function(){function e(t,n,r){S(this,e),this.r=t,this.s=n,this.recovery=r,this.assertValidity()}return P(e,[{key:"assertValidity",value:function(){TE("r",this.r,Sk,r),TE("s",this.s,Sk,r)}},{key:"addRecoveryBit",value:function(t){return new e(this.r,this.s,t)}},{key:"recoverPublicKey",value:function(e){var r=this.r,i=this.s,o=this.recovery,a=E(PE("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var u=2===o||3===o?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=1&o?"03":"02",h=l.fromHex(f+p(u)),d=c(u),v=s(-a*d),g=s(i*d),y=l.BASE.multiplyAndAddUnsafe(h,v,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}},{key:"hasHighS",value:function(){return v(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return EE(this.toDERHex())}},{key:"toDERHex",value:function(){return kk.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return EE(this.toCompactHex())}},{key:"toCompactHex",value:function(){return p(this.r)+p(this.s)}}],[{key:"fromCompact",value:function(n){var r=t.nByteLength;return n=PE("compactSignature",n,2*r),new e(g(n,0,r),g(n,r,2*r))}},{key:"fromDER",value:function(t){var n=kk.toSig(PE("DER",t));return new e(n.r,n.s)}}])}(),m={isValidPrivateKey:function(e){try{return f(e),!0}catch(t){return!1}},normPrivateKeyToScalar:f,randomPrivateKey:function(){var e=nk(t.n);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.length,i=tk(t),o=nk(t);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);var a=GE(n?IE(e):kE(e),t-zE)+zE;return n?OE(a,i):SE(a,i)}(t.randomBytes(e),t.n)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function w(e){var t=sE(e),n="string"==typeof e,r=(t||n)&&e.length;return t?r===i||r===o:n?r===2*i||r===2*o:e instanceof l}var b=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");var n=kE(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},E=t.bits2int_modN||function(e){return s(b(e))},k=RE(t.nBitLength);function I(e){return TE("num < 2^"+t.nBitLength,e,Ik,k),SE(e,t.nByteLength)}function O(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x;if(["recovered","canonical"].some(function(e){return e in i}))throw new Error("sign() legacy options not supported");var o=t.hash,a=t.randomBytes,u=i.lowS,h=i.prehash,p=i.extraEntropy;null==u&&(u=!0),e=PE("msgHash",e),mk(i),h&&(e=PE("prehashed msgHash",o(e)));var g=E(e),m=f(r),w=[I(m),I(g)];if(null!=p&&!1!==p){var k=!0===p?a(n.BYTES):p;w.push(PE("extraEntropy",k))}var S=xE.apply(void 0,w),O=g;return{seed:S,k2sig:function(e){var t=b(e);if(d(t)){var n=c(t),r=l.BASE.multiply(t).toAffine(),i=s(r.x);if(i!==Ik){var o=s(n*s(O+i*m));if(o!==Ik){var a=(r.x===i?0:2)|Number(r.y&Sk),f=o;return u&&v(o)&&(f=function(e){return v(e)?s(-e):e}(o),a^=1),new y(i,f,a)}}}}}}var x={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(w(e))throw new Error("first arg must be private key");if(!w(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(f(e)).toRawBytes(n)},sign:function(e,n){var r=O(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:x),i=r.seed,o=r.k2sig,a=t;return UE(a.hash.outputLen,a.nByteLength,a.hmac)(i,o)},verify:function(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A,a=e;n=PE("msgHash",n),r=PE("publicKey",r);var u=o.lowS,f=o.prehash,h=o.format;if(mk(o),"strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw new Error("format must be compact or der");var d,p,v="string"==typeof a||sE(a),g=!v&&!h&&"object"==_(a)&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!v&&!g)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(g&&(d=new y(a.r,a.s)),v){try{"compact"!==h&&(d=y.fromDER(a))}catch(Vx){if(!(Vx instanceof kk.Err))throw Vx}!d&&"der"!==h&&(d=y.fromCompact(a))}p=l.fromHex(r)}catch(x){return!1}if(!d||u&&d.hasHighS())return!1;f&&(n=t.hash(n));var m=d,w=m.r,b=m.s,k=E(n),I=c(b),S=s(k*I),O=s(w*I),P=null===(i=l.BASE.multiplyAndAddUnsafe(p,S,O))||void 0===i?void 0:i.toAffine();return!!P&&s(P.x)===w},ProjectivePoint:l,Signature:y,utils:m}}function _k(e){return{hash:e,hmac:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Yb(e,t,gw.apply(void 0,r))},randomBytes:ww}}BigInt(4);var Ak=ek(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"));!function(e,t){var n=function(t){return xk(a(a({},e),_k(t)))};a(a({},n(t)),{},{create:n})}({a:Ak.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:Ak,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},rE);var Tk="base16",Nk="base64pad",Rk="base64url";function Bk(e){return Ka(rE(Fa(e,Tk)),Tk)}function Ck(e){return Ka(rE(Fa(e,"utf8")),Tk)}function Uk(e,t,n){return"".concat(e,"?wc_ev=").concat(n,"&topic=").concat(t)}var jk=Object.defineProperty,Lk=Object.defineProperties,Dk=Object.getOwnPropertyDescriptors,qk=Object.getOwnPropertySymbols,Mk=Object.prototype.hasOwnProperty,zk=Object.prototype.propertyIsEnumerable,Hk=function(e,t,n){return t in e?jk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Vk=function(e,t){for(var n in t||(t={}))Mk.call(t,n)&&Hk(e,n,t[n]);if(qk){var r,i=u(qk(t));try{for(i.s();!(r=i.n()).done;){n=r.value;zk.call(t,n)&&Hk(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},Fk=function(e,t){return Lk(e,Dk(t))};function Kk(e){var t=[];return e.forEach(function(e){var n=r(e.split(":"),2),i=n[0],o=n[1];t.push("".concat(i,":").concat(o))}),t}function Wk(e){return e.includes(":")}function Gk(e){return Wk(e)?e.split(":")[0]:e}function Zk(e){var t,n,i,o={};if(!nI(e))return o;for(var a=0,s=Object.entries(e);a<s.length;a++){var c=r(s[a],2),u=c[0],l=c[1],f=Wk(u)?[u]:l.chains,h=l.methods||[],d=l.events||[],p=Gk(u);o[p]=Fk(Vk({},o[p]),{chains:Gm(f,null==(t=o[p])?void 0:t.chains),methods:Gm(h,null==(n=o[p])?void 0:n.methods),events:Gm(d,null==(i=o[p])?void 0:i.events)})}return o}function Yk(e,t){t=t.map(function(e){return e.replace("did:pkh:","")});for(var n=function(e){var t={};return null!=e&&e.forEach(function(e){var n,i=r(e.split(":"),2),o=i[0],a=i[1];t[o]||(t[o]={accounts:[],chains:[],events:[],methods:[]}),t[o].accounts.push(e),null==(n=t[o].chains)||n.push("".concat(o,":").concat(a))}),t}(t),i=0,o=Object.entries(n);i<o.length;i++){var a=r(o[i],2),s=(a[0],a[1]);s.methods?s.methods=Gm(s.methods,e):s.methods=e,s.events=["chainChanged","accountsChanged"]}return n}function Jk(e,t){var n,r,i,o,a,s,c,l=Zk(e),f=Zk(t),h={},d=u(Object.keys(l).concat(Object.keys(f)));try{for(d.s();!(c=d.n()).done;){var p=c.value;h[p]={chains:Gm(null==(n=l[p])?void 0:n.chains,null==(r=f[p])?void 0:r.chains),methods:Gm(null==(i=l[p])?void 0:i.methods,null==(o=f[p])?void 0:o.methods),events:Gm(null==(a=l[p])?void 0:a.events,null==(s=f[p])?void 0:s.events)}}}catch(v){d.e(v)}finally{d.f()}return h}var Qk={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Xk={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function $k(e,t){var n=Xk[e],r=n.message,i=n.code;return{message:t?"".concat(r," ").concat(t):r,code:i}}function eI(e,t){var n=Qk[e],r=n.message,i=n.code;return{message:t?"".concat(r," ").concat(t):r,code:i}}function tI(e,t){return!!Array.isArray(e)}function nI(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function rI(e){return _(e)>"u"}function iI(e,t){return!(!t||!rI(e))||"string"==typeof e&&!!e.trim().length}function oI(e,t){return!(!t||!rI(e))||"number"==typeof e&&!isNaN(e)}function aI(e){return!(!iI(e,!1)||!e.includes(":"))&&2===e.split(":").length}function sI(e){var t=!0;return tI(e)?e.length&&(t=e.every(function(e){return iI(e,!1)})):t=!1,t}function cI(e,t,n){var i=null;return Object.entries(e).forEach(function(e){var o=r(e,2),a=o[0],s=o[1];if(!i){var c=function(e,t,n){var r=null;return tI(t)&&t.length?t.forEach(function(e){r||aI(e)||(r=eI("UNSUPPORTED_CHAINS","".concat(n,", chain ").concat(e,' should be a string and conform to "namespace:chainId" format')))}):aI(e)||(r=eI("UNSUPPORTED_CHAINS","".concat(n,', chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }'))),r}(a,Im(a,s),"".concat(t," ").concat(n));c&&(i=c)}}),i}function uI(e,t){var n=null;return tI(e)?e.forEach(function(e){n||function(e){if(iI(e,!1)&&e.includes(":")){var t=e.split(":");if(3===t.length){var n=t[0]+":"+t[1];return!!t[2]&&aI(n)}}return!1}(e)||(n=eI("UNSUPPORTED_ACCOUNTS","".concat(t,", account ").concat(e,' should be a string and conform to "namespace:chainId:address" format')))}):n=eI("UNSUPPORTED_ACCOUNTS","".concat(t,', accounts should be an array of strings conforming to "namespace:chainId:address" format')),n}function lI(e,t){var n=null;return Object.values(e).forEach(function(e){if(!n){var r=function(e,t){var n=null;return sI(null==e?void 0:e.methods)?sI(null==e?void 0:e.events)||(n=eI("UNSUPPORTED_EVENTS","".concat(t,", events should be an array of strings or empty array for no events"))):n=eI("UNSUPPORTED_METHODS","".concat(t,", methods should be an array of strings or empty array for no methods")),n}(e,"".concat(t,", namespace"));r&&(n=r)}}),n}function fI(e,t){var n=null;if(e&&nI(e)){var r=lI(e,t);r&&(n=r);var i=function(e,t){var n=null;return Object.values(e).forEach(function(e){if(!n){var r=uI(null==e?void 0:e.accounts,"".concat(t," namespace"));r&&(n=r)}}),n}(e,t);i&&(n=i)}else n=$k("MISSING_OR_INVALID","".concat(t,", namespaces should be an object with data"));return n}function hI(e){return iI(e.protocol,!0)}function dI(e,t){var n=!1;return e?e&&tI(e)&&e.length&&e.forEach(function(e){n=hI(e)}):n=!0,n}function pI(e){return"number"==typeof e}function vI(e){return _(e)<"u"&&null!==_(e)}function gI(e){return!!(e&&"object"==_(e)&&e.code&&oI(e.code,!1)&&e.message&&iI(e.message,!1))}function yI(e){return!(rI(e)||!iI(e.method,!1))}function mI(e){return!(rI(e)||rI(e.result)&&rI(e.error)||!oI(e.id,!1)||!iI(e.jsonrpc,!1))}function wI(e){return!(rI(e)||!iI(e.name,!1))}function bI(e,t){return!(!aI(t)||!function(e){var t=[];return Object.values(e).forEach(function(e){t.push.apply(t,l(Kk(e.accounts)))}),t}(e).includes(t))}function EI(e,t,n){return!!iI(n,!1)&&function(e,t){var n=[];return Object.values(e).forEach(function(e){Kk(e.accounts).includes(t)&&n.push.apply(n,l(e.methods))}),n}(e,t).includes(n)}function kI(e,t,n){return!!iI(n,!1)&&function(e,t){var n=[];return Object.values(e).forEach(function(e){Kk(e.accounts).includes(t)&&n.push.apply(n,l(e.events))}),n}(e,t).includes(n)}function II(e,t,n){var r=null,i=function(e){var t={};return Object.keys(e).forEach(function(n){var r;n.includes(":")?t[n]=e[n]:null==(r=e[n].chains)||r.forEach(function(r){t[r]={methods:e[n].methods,events:e[n].events}})}),t}(e),o=function(e){var t={};return Object.keys(e).forEach(function(n){if(n.includes(":"))t[n]=e[n];else{var r=Kk(e[n].accounts);null==r||r.forEach(function(r){t[r]={accounts:e[n].accounts.filter(function(e){return e.includes("".concat(r,":"))}),methods:e[n].methods,events:e[n].events}})}}),t}(t),a=Object.keys(i),s=Object.keys(o),c=SI(Object.keys(e)),u=SI(Object.keys(t)),l=c.filter(function(e){return!u.includes(e)});return l.length&&(r=$k("NON_CONFORMING_NAMESPACES","".concat(n," namespaces keys don't satisfy requiredNamespaces.\n      Required: ").concat(l.toString(),"\n      Received: ").concat(Object.keys(t).toString()))),zm(a,s)||(r=$k("NON_CONFORMING_NAMESPACES","".concat(n," namespaces chains don't satisfy required namespaces.\n      Required: ").concat(a.toString(),"\n      Approved: ").concat(s.toString()))),Object.keys(t).forEach(function(e){if(e.includes(":")&&!r){var i=Kk(t[e].accounts);i.includes(e)||(r=$k("NON_CONFORMING_NAMESPACES","".concat(n," namespaces accounts don't satisfy namespace accounts for ").concat(e,"\n        Required: ").concat(e,"\n        Approved: ").concat(i.toString())))}}),a.forEach(function(e){r||(zm(i[e].methods,o[e].methods)?zm(i[e].events,o[e].events)||(r=$k("NON_CONFORMING_NAMESPACES","".concat(n," namespaces events don't satisfy namespace events for ").concat(e))):r=$k("NON_CONFORMING_NAMESPACES","".concat(n," namespaces methods don't satisfy namespace methods for ").concat(e)))}),r}function SI(e){return l(new Set(e.map(function(e){return e.includes(":")?e.split(":")[0]:e})))}function OI(e,t){return oI(e,!1)&&e<=t.max&&e>=t.min}var PI,xI={},_I=function(){return P(function e(){S(this,e)},null,[{key:"get",value:function(e){return xI[e]}},{key:"set",value:function(e,t){xI[e]=t}},{key:"delete",value:function(e){delete xI[e]}}])}(),AI="client",TI="".concat("wc","@").concat(2,":").concat(AI,":"),NI=AI,RI="error",BI="WALLETCONNECT_DEEPLINK_CHOICE",CI="Proposal expired",UI=ue.SEVEN_DAYS,jI={wc_sessionPropose:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1114},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:ue.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:ue.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1119}}},LI={min:ue.FIVE_MINUTES,max:ue.SEVEN_DAYS},DI="IDLE",qI="ACTIVE",MI={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},zI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],HI="".concat("wc","@",1.5,":").concat("auth",":"),VI="".concat(HI,":PUB_KEY"),FI=Object.defineProperty,KI=Object.defineProperties,WI=Object.getOwnPropertyDescriptors,GI=Object.getOwnPropertySymbols,ZI=Object.prototype.hasOwnProperty,YI=Object.prototype.propertyIsEnumerable,JI=function(e,t,n){return t in e?FI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},QI=function(e,t){for(var n in t||(t={}))ZI.call(t,n)&&JI(e,n,t[n]);if(GI){var r,i=u(GI(t));try{for(i.s();!(r=i.n()).done;){n=r.value;YI.call(t,n)&&JI(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},XI=function(e,t){return KI(e,WI(t))},$I=function(e,t,n){return JI(e,"symbol"!=_(t)?t+"":t,n)},eS=function(e){function t(e){var n;return S(this,t),n=y(this,t,[e]),$I(w(n),"name","engine"),$I(w(n),"events",new R),$I(w(n),"initialized",!1),$I(w(n),"requestQueue",{state:DI,queue:[]}),$I(w(n),"sessionRequestQueue",{state:DI,queue:[]}),$I(w(n),"requestQueueDelay",ue.ONE_SECOND),$I(w(n),"expectedPairingMethodMap",new Map),$I(w(n),"recentlyDeletedMap",new Map),$I(w(n),"recentlyDeletedLimit",200),$I(w(n),"relayMessageCache",[]),$I(w(n),"pendingSessions",new Map),$I(w(n),"init",g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(n.initialized){e.n=3;break}return e.n=1,n.cleanup();case 1:return n.registerRelayerEvents(),n.registerExpirerEvents(),n.registerPairingEvents(),e.n=2,n.registerLinkModeListeners();case 2:n.client.core.pairing.register({methods:Object.keys(jI)}),n.initialized=!0,setTimeout(g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n.processPendingMessageEvents();case 1:n.sessionRequestQueue.queue=n.getPendingSessionRequests(),n.processSessionRequestQueue();case 2:return e.a(2)}},e)})),ue.toMiliseconds(n.requestQueueDelay));case 3:return e.a(2)}},e)}))),$I(w(n),"connect",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y,m,w,b,E,k,I,S,O,P,x,_,A,T;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return r=XI(QI({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}}),e.n=2,n.isValidConnect(r);case 2:r.optionalNamespaces=Jk(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={},i=r.pairingTopic,o=r.requiredNamespaces,a=r.optionalNamespaces,s=r.sessionProperties,c=r.scopedProperties,u=r.relays,l=i,h=!1,e.p=3,l&&(p=n.client.core.pairing.pairings.get(l),n.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=p.active),e.n=5;break;case 4:throw e.p=4,T=e.v,n.client.logger.error("connect() -> pairing.get(".concat(l,") failed")),T;case 5:if(l&&h){e.n=7;break}return e.n=6,n.client.core.pairing.create();case 6:v=e.v,g=v.topic,y=v.uri,l=g,f=y;case 7:if(l){e.n=8;break}throw m=$k("NO_MATCHING_KEY","connect() pairing topic: ".concat(l)),w=m.message,new Error(w);case 8:return e.n=9,n.client.core.crypto.generateKeyPair();case 9:return b=e.v,E=jI.wc_sessionPropose.req.ttl||ue.FIVE_MINUTES,k=Fm(E),I=XI(QI(QI({requiredNamespaces:o,optionalNamespaces:a,relays:null!=u?u:[{protocol:"irn"}],proposer:{publicKey:b,metadata:n.client.metadata},expiryTimestamp:k,pairingTopic:l},s&&{sessionProperties:s}),c&&{scopedProperties:c}),{id:Uf()}),S=Wm("session_connect",I.id),O=Hm(E,CI),P=O.reject,x=O.resolve,_=O.done,A=function(e){e.id===I.id&&(n.client.events.off("proposal_expire",A),n.pendingSessions.delete(I.id),n.events.emit(S,{error:{message:CI,code:0}}))},n.client.events.on("proposal_expire",A),n.events.once(S,function(e){var t=e.error,r=e.session;n.client.events.off("proposal_expire",A),t?P(t):r&&x(r)}),e.n=10,n.sendRequest({topic:l,method:"wc_sessionPropose",params:I,throwOnFailedPublish:!0,clientRpcId:I.id});case 10:return e.n=11,n.setProposal(I.id,I);case 11:return e.a(2,{uri:f,approval:_})}},e,null,[[3,4]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"pair",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return e.p=1,e.n=2,n.client.core.pairing.pair(t);case 2:return e.a(2,e.v);case 3:throw e.p=3,r=e.v,n.client.logger.error("pair() failed"),r;case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"approve",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y,m,w,b,E,k,I,S,O,P,x,_,A,T;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=n.client.core.eventClient.createEvent({properties:{topic:null==(r=null==t?void 0:t.id)?void 0:r.toString(),trace:[cd]}}),e.p=1,n.isInitialized(),e.n=2,n.confirmOnlineStateOrThrow();case 2:e.n=4;break;case 3:throw e.p=3,P=e.v,a.setError(yd),P;case 4:return e.p=4,e.n=5,n.isValidProposalId(null==t?void 0:t.id);case 5:e.n=7;break;case 6:throw e.p=6,x=e.v,n.client.logger.error("approve() -> proposal.get(".concat(null==t?void 0:t.id,") failed")),a.setError(Id),x;case 7:return e.p=7,e.n=8,n.isValidApprove(t);case 8:e.n=10;break;case 9:throw e.p=9,_=e.v,n.client.logger.error("approve() -> isValidApprove() failed"),a.setError(kd),_;case 10:return s=t.id,c=t.relayProtocol,u=t.namespaces,l=t.sessionProperties,f=t.scopedProperties,h=t.sessionConfig,p=n.client.proposal.get(s),n.client.core.eventClient.deleteEvent({eventId:a.eventId}),v=p.pairingTopic,g=p.proposer,y=p.requiredNamespaces,m=p.optionalNamespaces,(w=null==(i=n.client.core.eventClient)?void 0:i.getEvent({topic:v}))||(w=null==(o=n.client.core.eventClient)?void 0:o.createEvent({type:cd,properties:{topic:v,trace:[cd,ud]}})),e.n=11,n.client.core.crypto.generateKeyPair();case 11:return b=e.v,E=g.publicKey,e.n=12,n.client.core.crypto.generateSharedKey(b,E);case 12:return k=e.v,I=QI(QI(QI({relay:{protocol:null!=c?c:"irn"},namespaces:u,controller:{publicKey:b,metadata:n.client.metadata},expiry:Fm(UI)},l&&{sessionProperties:l}),f&&{scopedProperties:f}),h&&{sessionConfig:h}),S=Eh,w.addTrace(ld),e.p=13,e.n=14,n.client.core.relayer.subscribe(k,{transportType:S});case 14:e.n=16;break;case 15:throw e.p=15,A=e.v,w.setError(wd),A;case 16:return w.addTrace(fd),O=XI(QI({},I),{topic:k,requiredNamespaces:y,optionalNamespaces:m,pairingTopic:v,acknowledged:!1,self:I.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:b,transportType:Eh}),e.n=17,n.client.session.set(k,O);case 17:return w.addTrace(pd),e.p=18,w.addTrace(vd),e.n=19,n.sendRequest({topic:k,method:"wc_sessionSettle",params:I,throwOnFailedPublish:!0}).catch(function(e){var t;throw null!==(t=w)&&void 0!==t&&t.setError(Ed),e});case 19:return w.addTrace(gd),w.addTrace(hd),e.n=20,n.sendResult({id:s,topic:v,result:{relay:{protocol:null!=c?c:"irn"},responderPublicKey:b},throwOnFailedPublish:!0}).catch(function(e){var t;throw null!==(t=w)&&void 0!==t&&t.setError(bd),e});case 20:w.addTrace(dd),e.n=23;break;case 21:return e.p=21,T=e.v,n.client.logger.error(T),n.client.session.delete(k,eI("USER_DISCONNECTED")),e.n=22,n.client.core.relayer.unsubscribe(k);case 22:throw T;case 23:return n.client.core.eventClient.deleteEvent({eventId:w.eventId}),e.n=24,n.client.core.pairing.updateMetadata({topic:v,metadata:g.metadata});case 24:return e.n=25,n.client.proposal.delete(s,eI("USER_DISCONNECTED"));case 25:return e.n=26,n.client.core.pairing.activate({topic:v});case 26:return e.n=27,n.setExpiry(k,Fm(UI));case 27:return e.a(2,{topic:k,acknowledged:function(){return Promise.resolve(n.client.session.get(k))}})}},e,null,[[18,21],[13,15],[7,9],[4,6],[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"reject",function(){var e=g(d().m(function e(t){var r,i,o,a,s;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return e.p=1,e.n=2,n.isValidReject(t);case 2:e.n=4;break;case 3:throw e.p=3,a=e.v,n.client.logger.error("reject() -> isValidReject() failed"),a;case 4:r=t.id,i=t.reason,e.p=5,o=n.client.proposal.get(r).pairingTopic,e.n=7;break;case 6:throw e.p=6,s=e.v,n.client.logger.error("reject() -> proposal.get(".concat(r,") failed")),s;case 7:if(!o){e.n=9;break}return e.n=8,n.sendError({id:r,topic:o,error:i,rpcOpts:jI.wc_sessionPropose.reject});case 8:return e.n=9,n.client.proposal.delete(r,eI("USER_DISCONNECTED"));case 9:return e.a(2)}},e,null,[[5,6],[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"update",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return e.p=1,e.n=2,n.isValidUpdate(t);case 2:e.n=4;break;case 3:throw e.p=3,h=e.v,n.client.logger.error("update() -> isValidUpdate() failed"),h;case 4:return r=t.topic,i=t.namespaces,o=Hm(),a=o.done,s=o.resolve,c=o.reject,u=Uf(),l=jf().toString(),f=n.client.session.get(r).namespaces,n.events.once(Wm("session_update",u),function(e){var t=e.error;t?c(t):s()}),e.n=5,n.client.session.update(r,{namespaces:i});case 5:return e.n=6,n.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:u,relayRpcId:l}).catch(function(e){n.client.logger.error(e),n.client.session.update(r,{namespaces:f}),c(e)});case 6:return e.a(2,{acknowledged:a})}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"extend",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return e.p=1,e.n=2,n.isValidExtend(t);case 2:e.n=4;break;case 3:throw e.p=3,u=e.v,n.client.logger.error("extend() -> isValidExtend() failed"),u;case 4:return r=t.topic,i=Uf(),o=Hm(),a=o.done,s=o.resolve,c=o.reject,n.events.once(Wm("session_extend",i),function(e){var t=e.error;t?c(t):s()}),e.n=5,n.setExpiry(r,Fm(UI));case 5:return n.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(function(e){c(e)}),e.a(2,{acknowledged:a})}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"request",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,y,m,w,b,E;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.isInitialized(),e.p=1,e.n=2,n.isValidRequest(t);case 2:e.n=4;break;case 3:throw e.p=3,E=e.v,n.client.logger.error("request() -> isValidRequest() failed"),E;case 4:if(r=t.chainId,i=t.request,o=t.topic,a=t.expiry,s=void 0===a?jI.wc_sessionRequest.req.ttl:a,c=n.client.session.get(o),!((null==c?void 0:c.transportType)===Eh)){e.n=5;break}return e.n=5,n.confirmOnlineStateOrThrow();case 5:if(u=Uf(),l=jf().toString(),f=Hm(s,"Request expired. Please try again."),h=f.done,p=f.resolve,v=f.reject,n.events.once(Wm("session_request",u),function(e){var t=e.error,n=e.result;t?v(t):p(n)}),y="wc_sessionRequest",!(m=n.getAppLinkIfEnabled(c.peer.metadata,c.transportType))){e.n=8;break}return e.n=6,n.sendRequest({clientRpcId:u,relayRpcId:l,topic:o,method:y,params:{request:XI(QI({},i),{expiryTimestamp:Fm(s)}),chainId:r},expiry:s,throwOnFailedPublish:!0,appLink:m}).catch(function(e){return v(e)});case 6:return n.client.events.emit("session_request_sent",{topic:o,request:i,chainId:r,id:u}),e.n=7,h();case 7:case 9:return e.a(2,e.v);case 8:return w={request:XI(QI({},i),{expiryTimestamp:Fm(s)}),chainId:r},b=n.shouldSetTVF(y,w),e.n=9,Promise.all([new Promise(function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n.sendRequest(QI({clientRpcId:u,relayRpcId:l,topic:o,method:y,params:w,expiry:s,throwOnFailedPublish:!0},b&&{tvf:n.getTVFParams(u,w)})).catch(function(e){return v(e)});case 1:n.client.events.emit("session_request_sent",{topic:o,request:i,chainId:r,id:u}),t();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),new Promise(function(){var e=g(d().m(function e(t){var r,i;return d().w(function(e){for(;;)switch(e.n){case 0:if(null!=(r=c.sessionConfig)&&r.disableDeepLink){e.n=2;break}return e.n=1,Xm(n.client.core.storage,BI);case 1:return i=e.v,e.n=2,Zm({id:u,topic:o,wcDeepLink:i});case 2:t();case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),h()]).then(function(e){return e[2]})}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"respond",function(){var e=g(d().m(function e(t){var r,i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:return n.isInitialized(),e.n=1,n.isValidRespond(t);case 1:if(r=t.topic,i=t.response,o=i.id,a=n.client.session.get(r),!(a.transportType===Eh)){e.n=2;break}return e.n=2,n.confirmOnlineStateOrThrow();case 2:if(s=n.getAppLinkIfEnabled(a.peer.metadata,a.transportType),!Gf(i)){e.n=4;break}return e.n=3,n.sendResult({id:o,topic:r,result:i.result,throwOnFailedPublish:!0,appLink:s});case 3:e.n=5;break;case 4:if(!Zf(i)){e.n=5;break}return e.n=5,n.sendError({id:o,topic:r,error:i.error,appLink:s});case 5:n.cleanupAfterResponse(t);case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"ping",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return e.p=1,e.n=2,n.isValidPing(t);case 2:e.n=4;break;case 3:throw e.p=3,l=e.v,n.client.logger.error("ping() -> isValidPing() failed"),l;case 4:if(r=t.topic,!n.client.session.keys.includes(r)){e.n=6;break}return i=Uf(),o=jf().toString(),a=Hm(),s=a.done,c=a.resolve,u=a.reject,n.events.once(Wm("session_ping",i),function(e){var t=e.error;t?u(t):c()}),e.n=5,Promise.all([n.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:o}),s()]);case 5:e.n=7;break;case 6:if(!n.client.core.pairing.pairings.keys.includes(r)){e.n=7;break}return n.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),e.n=7,n.client.core.pairing.ping({topic:r});case 7:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"emit",function(){var e=g(d().m(function e(t){var r,i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return e.n=2,n.isValidEmit(t);case 2:return r=t.topic,i=t.event,o=t.chainId,a=jf().toString(),s=Uf(),e.n=3,n.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:i,chainId:o},throwOnFailedPublish:!0,relayRpcId:a,clientRpcId:s});case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"disconnect",function(){var e=g(d().m(function e(t){var r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:return n.isInitialized(),e.n=1,n.confirmOnlineStateOrThrow();case 1:return e.n=2,n.isValidDisconnect(t);case 2:if(r=t.topic,!n.client.session.keys.includes(r)){e.n=5;break}return e.n=3,n.sendRequest({topic:r,method:"wc_sessionDelete",params:eI("USER_DISCONNECTED"),throwOnFailedPublish:!0});case 3:return e.n=4,n.deleteSession({topic:r,emitEvent:!1});case 4:case 6:e.n=8;break;case 5:if(!n.client.core.pairing.pairings.keys.includes(r)){e.n=7;break}return e.n=6,n.client.core.pairing.disconnect({topic:r});case 7:throw i=$k("MISMATCHED_TOPIC","Session or pairing topic not found: ".concat(r)),o=i.message,new Error(o);case 8:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"find",function(e){return n.isInitialized(),n.client.session.getAll().filter(function(t){return function(e,t){var n=t.requiredNamespaces,r=Object.keys(e.namespaces),i=Object.keys(n),o=!0;return!!zm(i,r)&&(r.forEach(function(t){var r=e.namespaces[t],i=r.accounts,a=r.methods,s=r.events,c=Kk(i),u=n[t];zm(Im(t,u),c)&&zm(u.methods,a)&&zm(u.events,s)||(o=!1)}),o)}(t,e)})}),$I(w(n),"getPendingSessionRequests",function(){return n.client.pendingRequest.getAll()}),$I(w(n),"authenticate",function(){var e=g(d().m(function e(t,r){var i,o,a,s,c,f,h,p,v,y,m,w,b,E,k,I,S,O,P,x,_,A,T,N,R,B,C,U,j,L,D,q,M,z,H,V,F,K,W,G,Z;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.isInitialized(),n.isValidAuthenticate(t),o=r&&n.client.core.linkModeSupportedApps.includes(r)&&(null==(i=n.client.metadata.redirect)?void 0:i.linkMode),!((a=o?bh:Eh)===Eh)){e.n=1;break}return e.n=1,n.confirmOnlineStateOrThrow();case 1:return s=t.chains,c=t.statement,f=void 0===c?"":c,h=t.uri,p=t.domain,v=t.nonce,y=t.type,m=t.exp,w=t.nbf,b=t.methods,E=void 0===b?[]:b,k=t.expiry,I=l(t.resources||[]),e.n=2,n.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:a});case 2:return S=e.v,O=S.topic,P=S.uri,n.client.logger.info({message:"Generated new pairing",pairing:{topic:O,uri:P}}),e.n=3,n.client.core.crypto.generateKeyPair();case 3:return x=e.v,_=Bk(x),e.n=4,Promise.all([n.client.auth.authKeys.set(VI,{responseTopic:_,publicKey:x}),n.client.auth.pairingTopics.set(_,{topic:_,pairingTopic:O})]);case 4:return e.n=5,n.client.core.relayer.subscribe(_,{transportType:a});case 5:if(n.client.logger.info("sending request to new pairing topic: ".concat(O)),!(E.length>0)){e.n=6;break}A=km(s[0]),T=A.namespace,N=vb(T,"request",E),wb(I)&&(N=gb(N,I.pop())),I.push(N);case 6:if(R=k&&k>jI.wc_sessionAuthenticate.req.ttl?k:jI.wc_sessionAuthenticate.req.ttl,B={authPayload:{type:null!=y?y:"caip122",chains:s,statement:f,aud:h,domain:p,version:"1",nonce:v,iat:(new Date).toISOString(),exp:m,nbf:w,resources:I},requester:{publicKey:x,metadata:n.client.metadata},expiryTimestamp:Fm(R)},C={eip155:{chains:s,methods:l(new Set(["personal_sign"].concat(l(E)))),events:["chainChanged","accountsChanged"]}},U={requiredNamespaces:{},optionalNamespaces:C,relays:[{protocol:"irn"}],pairingTopic:O,proposer:{publicKey:x,metadata:n.client.metadata},expiryTimestamp:Fm(jI.wc_sessionPropose.req.ttl),id:Uf()},j=Hm(R,"Request expired"),L=j.done,D=j.resolve,q=j.reject,M=Uf(),z=Wm("session_connect",U.id),H=Wm("session_request",M),V=function(){var e=g(d().m(function e(t){var r,i;return d().w(function(e){for(;;)switch(e.n){case 0:r=t.error,i=t.session,n.events.off(H,F),r?q(r):i&&D({session:i});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=g(d().m(function e(t){var i,o,s,c,f,h,p,v,g,y,m,w,b,E,k,I,S,P,_,A,T,N,R,B;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,n.deletePendingAuthRequest(M,{message:"fulfilled",code:0});case 1:if(!t.error){e.n=2;break}return c=eI("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate"),e.a(2,t.error.code===c.code?void 0:(n.events.off(z,V),q(t.error.message)));case 2:return e.n=3,n.deleteProposal(U.id);case 3:n.events.off(z,V),f=t.result,h=f.cacaos,p=f.responder,v=[],g=[],y=u(h),e.p=4,y.s();case 5:if((m=y.n()).done){e.n=9;break}return w=m.value,e.n=6,cb({cacao:w,projectId:n.client.core.projectId});case 6:if(e.v){e.n=7;break}n.client.logger.error(w,"Signature verification failed"),q(eI("SESSION_SETTLEMENT_FAILED","Signature verification failed"));case 7:for(b=w.p,E=wb(b.resources),k=[ab(b.iss)],I=sb(b.iss),E&&(S=yb(E),P=mb(E),v.push.apply(v,l(S)),k.push.apply(k,l(P))),_=0,A=k;_<A.length;_++)T=A[_],g.push("".concat(T,":").concat(I));case 8:e.n=5;break;case 9:e.n=11;break;case 10:e.p=10,B=e.v,y.e(B);case 11:return e.p=11,y.f(),e.f(11);case 12:return e.n=13,n.client.core.crypto.generateSharedKey(x,p.publicKey);case 13:if(N=e.v,!(v.length>0)){e.n=17;break}return R={topic:N,acknowledged:!0,self:{publicKey:x,metadata:n.client.metadata},peer:p,controller:p.publicKey,expiry:Fm(UI),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:O,namespaces:Yk(l(new Set(v)),l(new Set(g))),transportType:a},e.n=14,n.client.core.relayer.subscribe(N,{transportType:a});case 14:return e.n=15,n.client.session.set(N,R);case 15:if(!O){e.n=16;break}return e.n=16,n.client.core.pairing.updateMetadata({topic:O,metadata:p.metadata});case 16:R=n.client.session.get(N);case 17:null!=(i=n.client.metadata.redirect)&&i.linkMode&&null!=(o=p.metadata.redirect)&&o.linkMode&&null!=(s=p.metadata.redirect)&&s.universal&&r&&(n.client.core.addLinkModeSupportedApp(p.metadata.redirect.universal),n.client.session.update(N,{transportType:bh})),D({auths:h,session:R});case 18:return e.a(2)}},e,null,[[4,10,11,12]])}));return function(t){return e.apply(this,arguments)}}(),n.events.once(z,V),n.events.once(H,F),e.p=7,!o){e.n=9;break}return W=Lf("wc_sessionAuthenticate",B,M),n.client.core.history.set(O,W),e.n=8,n.client.core.crypto.encode("",W,{type:2,encoding:Rk});case 8:G=e.v,K=Uk(r,O,G),e.n=10;break;case 9:return e.n=10,Promise.all([n.sendRequest({topic:O,method:"wc_sessionAuthenticate",params:B,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:M}),n.sendRequest({topic:O,method:"wc_sessionPropose",params:U,expiry:jI.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:U.id})]);case 10:e.n=12;break;case 11:throw e.p=11,Z=e.v,n.events.off(z,V),n.events.off(H,F),Z;case 12:return e.n=13,n.setProposal(U.id,U);case 13:return e.n=14,n.setAuthRequest(M,{request:XI(QI({},B),{verifyContext:{}}),pairingTopic:O,transportType:a});case 14:return e.a(2,{uri:null!=K?K:P,response:L})}},e,null,[[7,11]])}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"approveSessionAuthenticate",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,f,h,p,v,g,y,m,w,b,E,k,I,S,O,P,x,_,A,T,N,R,B,C,U;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:r=t.id,i=t.auths,o=n.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Sd]}}),e.p=1,n.isInitialized(),e.n=3;break;case 2:throw e.p=2,R=e.v,o.setError(Nd),R;case 3:if(a=n.getPendingAuthRequest(r)){e.n=4;break}throw o.setError(Ud),new Error("Could not find pending auth request with id ".concat(r));case 4:if(s=a.transportType||Eh,!(s===Eh)){e.n=5;break}return e.n=5,n.confirmOnlineStateOrThrow();case 5:return c=a.requester.publicKey,e.n=6,n.client.core.crypto.generateKeyPair();case 6:f=e.v,h=Bk(c),p={type:1,receiverPublicKey:c,senderPublicKey:f},v=[],g=[],y=u(i),e.p=7,y.s();case 8:if((m=y.n()).done){e.n=13;break}return w=m.value,e.n=9,cb({cacao:w,projectId:n.client.core.projectId});case 9:if(e.v){e.n=11;break}return o.setError(Rd),b=eI("SESSION_SETTLEMENT_FAILED","Signature verification failed"),e.n=10,n.sendError({id:r,topic:h,error:b,encodeOpts:p});case 10:throw new Error(b.message);case 11:for(o.addTrace(Pd),E=w.p,k=wb(E.resources),I=[ab(E.iss)],S=sb(E.iss),k&&(O=yb(k),P=mb(k),v.push.apply(v,l(O)),I.push.apply(I,l(P))),x=0,_=I;x<_.length;x++)A=_[x],g.push("".concat(A,":").concat(S));case 12:e.n=8;break;case 13:e.n=15;break;case 14:e.p=14,B=e.v,y.e(B);case 15:return e.p=15,y.f(),e.f(15);case 16:return e.n=17,n.client.core.crypto.generateSharedKey(f,c);case 17:if(T=e.v,o.addTrace(Od),!((null==v?void 0:v.length)>0)){e.n=23;break}return N={topic:T,acknowledged:!0,self:{publicKey:f,metadata:n.client.metadata},peer:{publicKey:c,metadata:a.requester.metadata},controller:c,expiry:Fm(UI),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:a.pairingTopic,namespaces:Yk(l(new Set(v)),l(new Set(g))),transportType:s},o.addTrace(_d),e.p=18,e.n=19,n.client.core.relayer.subscribe(T,{transportType:s});case 19:e.n=21;break;case 20:throw e.p=20,C=e.v,o.setError(Bd),C;case 21:return o.addTrace(Ad),e.n=22,n.client.session.set(T,N);case 22:return o.addTrace(xd),e.n=23,n.client.core.pairing.updateMetadata({topic:a.pairingTopic,metadata:a.requester.metadata});case 23:return o.addTrace(Td),e.p=24,e.n=25,n.sendResult({topic:h,id:r,result:{cacaos:i,responder:{publicKey:f,metadata:n.client.metadata}},encodeOpts:p,throwOnFailedPublish:!0,appLink:n.getAppLinkIfEnabled(a.requester.metadata,s)});case 25:e.n=27;break;case 26:throw e.p=26,U=e.v,o.setError(Cd),U;case 27:return e.n=28,n.client.auth.requests.delete(r,{message:"fulfilled",code:0});case 28:return e.n=29,n.client.core.pairing.activate({topic:a.pairingTopic});case 29:return n.client.core.eventClient.deleteEvent({eventId:o.eventId}),e.a(2,{session:N})}},e,null,[[24,26],[18,20],[7,14,15,16],[1,2]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"rejectSessionAuthenticate",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.n){case 0:if(n.isInitialized(),r=t.id,i=t.reason,o=n.getPendingAuthRequest(r)){e.n=1;break}throw new Error("Could not find pending auth request with id ".concat(r));case 1:if(!(o.transportType===Eh)){e.n=2;break}return e.n=2,n.confirmOnlineStateOrThrow();case 2:return a=o.requester.publicKey,e.n=3,n.client.core.crypto.generateKeyPair();case 3:return s=e.v,c=Bk(a),u={type:1,receiverPublicKey:a,senderPublicKey:s},e.n=4,n.sendError({id:r,topic:c,error:i,encodeOpts:u,rpcOpts:jI.wc_sessionAuthenticate.reject,appLink:n.getAppLinkIfEnabled(o.requester.metadata,o.transportType)});case 4:return e.n=5,n.client.auth.requests.delete(r,{message:"rejected",code:0});case 5:return e.n=6,n.client.proposal.delete(r,eI("USER_DISCONNECTED"));case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"formatAuthMessage",function(e){n.isInitialized();var t=e.request,r=e.iss;return lb(t,r)}),$I(w(n),"processRelayMessageCache",function(){setTimeout(g(d().m(function e(){var t,r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(0===n.relayMessageCache.length){e.n=6;break}case 1:if(!(n.relayMessageCache.length>0)){e.n=6;break}if(e.p=2,t=n.relayMessageCache.shift(),!t){e.n=3;break}return e.n=3,n.onRelayMessage(t);case 3:e.n=5;break;case 4:e.p=4,r=e.v,n.client.logger.error(r);case 5:e.n=1;break;case 6:return e.a(2)}},e,null,[[2,4]])})),50)}),$I(w(n),"cleanupDuplicatePairings",function(){var e=g(d().m(function e(t){var r,i,o;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!t.pairingTopic){e.n=5;break}if(e.p=1,r=n.client.core.pairing.pairings.get(t.pairingTopic),i=n.client.core.pairing.pairings.getAll().filter(function(e){var n,i;return(null==(n=e.peerMetadata)?void 0:n.url)&&(null==(i=e.peerMetadata)?void 0:i.url)===t.peer.metadata.url&&e.topic&&e.topic!==r.topic}),0!==i.length){e.n=2;break}return e.a(2);case 2:return n.client.logger.info("Cleaning up ".concat(i.length," duplicate pairing(s)")),e.n=3,Promise.all(i.map(function(e){return n.client.core.pairing.disconnect({topic:e.topic})}));case 3:n.client.logger.info("Duplicate pairings clean up finished"),e.n=5;break;case 4:e.p=4,o=e.v,n.client.logger.error(o);case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"deleteSession",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h;return d().w(function(e){for(;;)switch(e.n){case 0:return i=t.topic,o=t.expirerHasDeleted,a=void 0!==o&&o,s=t.emitEvent,c=void 0===s||s,u=t.id,l=void 0===u?0:u,f=n.client.session.get(i),h=f.self,e.n=1,n.client.core.relayer.unsubscribe(i);case 1:return e.n=2,n.client.session.delete(i,eI("USER_DISCONNECTED"));case 2:if(n.addToRecentlyDeleted(i,"session"),!n.client.core.crypto.keychain.has(h.publicKey)){e.n=3;break}return e.n=3,n.client.core.crypto.deleteKeyPair(h.publicKey);case 3:if(!n.client.core.crypto.keychain.has(i)){e.n=4;break}return e.n=4,n.client.core.crypto.deleteSymKey(i);case 4:a||n.client.core.expirer.del(i),n.client.core.storage.removeItem(BI).catch(function(e){return n.client.logger.warn(e)}),n.getPendingSessionRequests().forEach(function(e){e.topic===i&&n.deletePendingSessionRequest(e.id,eI("USER_DISCONNECTED"))}),i===(null==(r=n.sessionRequestQueue.queue[0])?void 0:r.topic)&&(n.sessionRequestQueue.state=DI),c&&n.client.events.emit("session_delete",{id:l,topic:i});case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"deleteProposal",function(){var e=g(d().m(function e(t,r){var i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(r)try{i=n.client.proposal.get(t),null==(o=n.client.core.eventClient.getEvent({topic:i.pairingTopic}))||o.setError(md)}catch(a){}return e.n=1,Promise.all([n.client.proposal.delete(t,eI("USER_DISCONNECTED")),r?Promise.resolve():n.client.core.expirer.del(t)]);case 1:n.addToRecentlyDeleted(t,"proposal");case 2:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"deletePendingSessionRequest",function(){var e=g(d().m(function e(t,r){var i,o=arguments;return d().w(function(e){for(;;)switch(e.n){case 0:return i=o.length>2&&void 0!==o[2]&&o[2],e.n=1,Promise.all([n.client.pendingRequest.delete(t,r),i?Promise.resolve():n.client.core.expirer.del(t)]);case 1:n.addToRecentlyDeleted(t,"request"),n.sessionRequestQueue.queue=n.sessionRequestQueue.queue.filter(function(e){return e.id!==t}),i&&(n.sessionRequestQueue.state=DI,n.client.events.emit("session_request_expire",{id:t}));case 2:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"deletePendingAuthRequest",function(){var e=g(d().m(function e(t,r){var i,o=arguments;return d().w(function(e){for(;;)switch(e.n){case 0:return i=o.length>2&&void 0!==o[2]&&o[2],e.n=1,Promise.all([n.client.auth.requests.delete(t,r),i?Promise.resolve():n.client.core.expirer.del(t)]);case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"setExpiry",function(){var e=g(d().m(function e(t,r){return d().w(function(e){for(;;)switch(e.n){case 0:if(!n.client.session.keys.includes(t)){e.n=1;break}return n.client.core.expirer.set(t,r),e.n=1,n.client.session.update(t,{expiry:r});case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"setProposal",function(){var e=g(d().m(function e(t,r){return d().w(function(e){for(;;)switch(e.n){case 0:return n.client.core.expirer.set(t,Fm(jI.wc_sessionPropose.req.ttl)),e.n=1,n.client.proposal.set(t,r);case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"setAuthRequest",function(){var e=g(d().m(function e(t,r){var i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:return i=r.request,o=r.pairingTopic,a=r.transportType,s=void 0===a?Eh:a,n.client.core.expirer.set(t,i.expiryTimestamp),e.n=1,n.client.auth.requests.set(t,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:t,pairingTopic:o,verifyContext:i.verifyContext,transportType:s});case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"setPendingSessionRequest",function(){var e=g(d().m(function e(t){var r,i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:return r=t.id,i=t.topic,o=t.params,a=t.verifyContext,s=o.request.expiryTimestamp||Fm(jI.wc_sessionRequest.req.ttl),n.client.core.expirer.set(r,s),e.n=1,n.client.pendingRequest.set(r,{id:r,topic:i,params:o,verifyContext:a});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"sendRequest",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y,m,w,b,E,k,I;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.topic,i=t.method,o=t.params,a=t.expiry,s=t.relayRpcId,c=t.clientRpcId,u=t.throwOnFailedPublish,l=t.appLink,f=t.tvf,h=Lf(i,o,c),v=!!l,e.p=1,g=v?Rk:Nk,e.n=2,n.client.core.crypto.encode(r,h,{encoding:g});case 2:p=e.v,e.n=5;break;case 3:return e.p=3,I=e.v,e.n=4,n.cleanup();case 4:throw n.client.logger.error("sendRequest() -> core.crypto.encode() for topic ".concat(r," failed")),I;case 5:if(!zI.includes(i)){e.n=7;break}return m=Ck(JSON.stringify(h)),w=Ck(p),e.n=6,n.client.core.verify.register({id:w,decryptedId:m});case 6:y=e.v;case 7:if((b=jI[i].req).attestation=y,a&&(b.ttl=a),s&&(b.id=s),n.client.core.history.set(r,h),!v){e.n=9;break}return E=Uk(l,r,p),e.n=8,global.Linking.openURL(E,n.client.name);case 8:e.n=12;break;case 9:if(k=jI[i].req,a&&(k.ttl=a),s&&(k.id=s),k.tvf=XI(QI({},f),{correlationId:h.id}),!u){e.n=11;break}return k.internal=XI(QI({},k.internal),{throwOnFailedPublish:!0}),e.n=10,n.client.core.relayer.publish(r,p,k);case 10:e.n=12;break;case 11:n.client.core.relayer.publish(r,p,k).catch(function(e){return n.client.logger.error(e)});case 12:return e.a(2,h.id)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"sendResult",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y,m,w,b,E;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.id,i=t.topic,o=t.result,a=t.throwOnFailedPublish,s=t.encodeOpts,c=t.appLink,u=Df(r,o),f=c&&_(null==global?void 0:global.Linking)<"u",e.p=1,h=f?Rk:Nk,e.n=2,n.client.core.crypto.encode(i,u,XI(QI({},s||{}),{encoding:h}));case 2:l=e.v,e.n=5;break;case 3:return e.p=3,b=e.v,e.n=4,n.cleanup();case 4:throw n.client.logger.error("sendResult() -> core.crypto.encode() for topic ".concat(i," failed")),b;case 5:return e.p=5,e.n=6,n.client.core.history.get(i,r);case 6:p=e.v,g=p.request;try{n.shouldSetTVF(g.method,g.params)&&(v=n.getTVFParams(r,g.params,o))}catch(w){n.client.logger.warn("sendResult() -> getTVFParams() failed",w)}e.n=8;break;case 7:throw e.p=7,E=e.v,n.client.logger.error("sendResult() -> history.get(".concat(i,", ").concat(r,") failed")),E;case 8:if(!f){e.n=10;break}return y=Uk(c,i,l),e.n=9,global.Linking.openURL(y,n.client.name);case 9:e.n=13;break;case 10:if(m=p.request.method,(w=jI[m].res).tvf=XI(QI({},v),{correlationId:r}),!a){e.n=12;break}return w.internal=XI(QI({},w.internal),{throwOnFailedPublish:!0}),e.n=11,n.client.core.relayer.publish(i,l,w);case 11:e.n=13;break;case 12:n.client.core.relayer.publish(i,l,w).catch(function(e){return n.client.logger.error(e)});case 13:return e.n=14,n.client.core.history.resolve(u);case 14:return e.a(2)}},e,null,[[5,7],[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"sendError",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y,m,w;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.id,i=t.topic,o=t.error,a=t.encodeOpts,s=t.rpcOpts,c=t.appLink,u=qf(r,o),f=c&&_(null==global?void 0:global.Linking)<"u",e.p=1,h=f?Rk:Nk,e.n=2,n.client.core.crypto.encode(i,u,XI(QI({},a||{}),{encoding:h}));case 2:l=e.v,e.n=5;break;case 3:return e.p=3,m=e.v,e.n=4,n.cleanup();case 4:throw n.client.logger.error("sendError() -> core.crypto.encode() for topic ".concat(i," failed")),m;case 5:return e.p=5,e.n=6,n.client.core.history.get(i,r);case 6:p=e.v,e.n=8;break;case 7:throw e.p=7,w=e.v,n.client.logger.error("sendError() -> history.get(".concat(i,", ").concat(r,") failed")),w;case 8:if(!f){e.n=10;break}return v=Uk(c,i,l),e.n=9,global.Linking.openURL(v,n.client.name);case 9:e.n=11;break;case 10:g=p.request.method,y=s||jI[g].res,n.client.core.relayer.publish(i,l,y);case 11:return e.n=12,n.client.core.history.resolve(u);case 12:return e.a(2)}},e,null,[[5,7],[1,3]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"cleanup",g(d().m(function e(){var t,r;return d().w(function(e){for(;;)switch(e.n){case 0:return t=[],r=[],n.client.session.getAll().forEach(function(e){var r=!1;Km(e.expiry)&&(r=!0),n.client.core.crypto.keychain.has(e.topic)||(r=!0),r&&t.push(e.topic)}),n.client.proposal.getAll().forEach(function(e){Km(e.expiryTimestamp)&&r.push(e.id)}),e.n=1,Promise.all([].concat(l(t.map(function(e){return n.deleteSession({topic:e})})),l(r.map(function(e){return n.deleteProposal(e)}))));case 1:return e.a(2)}},e)}))),$I(w(n),"onProviderMessageEvent",function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:if(n.initialized&&!(n.relayMessageCache.length>0)){e.n=1;break}n.relayMessageCache.push(t),e.n=2;break;case 1:return e.n=2,n.onRelayMessage(t);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"onRelayEventRequest",function(){var e=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:return n.requestQueue.queue.push(t),e.n=1,n.processRequestsQueue();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"processRequestsQueue",g(d().m(function e(){var t,r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.requestQueue.state!==qI){e.n=1;break}return n.client.logger.info("Request queue already active, skipping..."),e.a(2);case 1:n.client.logger.info("Request queue starting with ".concat(n.requestQueue.queue.length," requests"));case 2:if(!(n.requestQueue.queue.length>0)){e.n=7;break}if(n.requestQueue.state=qI,!(t=n.requestQueue.queue.shift())){e.n=6;break}return e.p=3,e.n=4,n.processRequest(t);case 4:e.n=6;break;case 5:e.p=5,r=e.v,n.client.logger.warn(r);case 6:e.n=2;break;case 7:n.requestQueue.state=DI;case 8:return e.a(2)}},e,null,[[3,5]])}))),$I(w(n),"processRequest",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.n){case 0:if(r=t.topic,i=t.payload,o=t.attestation,a=t.transportType,s=t.encryptedId,c=i.method,n.shouldIgnorePairingRequest({topic:r,requestMethod:c})){e.n=20;break}u=c,e.n="wc_sessionPropose"===u?1:"wc_sessionSettle"===u?3:"wc_sessionUpdate"===u?5:"wc_sessionExtend"===u?7:"wc_sessionPing"===u?9:"wc_sessionDelete"===u?11:"wc_sessionRequest"===u?13:"wc_sessionEvent"===u?15:"wc_sessionAuthenticate"===u?17:19;break;case 1:return e.n=2,n.onSessionProposeRequest({topic:r,payload:i,attestation:o,encryptedId:s});case 2:case 4:case 6:case 8:case 10:case 12:case 14:case 16:case 18:return e.a(2,e.v);case 3:return e.n=4,n.onSessionSettleRequest(r,i);case 5:return e.n=6,n.onSessionUpdateRequest(r,i);case 7:return e.n=8,n.onSessionExtendRequest(r,i);case 9:return e.n=10,n.onSessionPingRequest(r,i);case 11:return e.n=12,n.onSessionDeleteRequest(r,i);case 13:return e.n=14,n.onSessionRequest({topic:r,payload:i,attestation:o,encryptedId:s,transportType:a});case 15:return e.n=16,n.onSessionEventRequest(r,i);case 17:return e.n=18,n.onSessionAuthenticateRequest({topic:r,payload:i,attestation:o,encryptedId:s,transportType:a});case 19:return e.a(2,n.client.logger.info("Unsupported request method ".concat(c)));case 20:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"onRelayEventResponse",function(){var e=g(d().m(function e(t){var r,i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:return r=t.topic,i=t.payload,o=t.transportType,e.n=1,n.client.core.history.get(r,i.id);case 1:a=e.v.request.method,s=a,e.n="wc_sessionPropose"===s?2:"wc_sessionSettle"===s?3:"wc_sessionUpdate"===s?4:"wc_sessionExtend"===s?5:"wc_sessionPing"===s?6:"wc_sessionRequest"===s?7:"wc_sessionAuthenticate"===s?8:9;break;case 2:return e.a(2,n.onSessionProposeResponse(r,i,o));case 3:return e.a(2,n.onSessionSettleResponse(r,i));case 4:return e.a(2,n.onSessionUpdateResponse(r,i));case 5:return e.a(2,n.onSessionExtendResponse(r,i));case 6:return e.a(2,n.onSessionPingResponse(r,i));case 7:return e.a(2,n.onSessionRequestResponse(r,i));case 8:return e.a(2,n.onSessionAuthenticateResponse(r,i));case 9:return e.a(2,n.client.logger.info("Unsupported response method ".concat(a)));case 10:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"onRelayEventUnknownPayload",function(e){var t=e.topic,n=$k("MISSING_OR_INVALID","Decoded payload on topic ".concat(t," is not identifiable as a JSON-RPC request or a response.")).message;throw new Error(n)}),$I(w(n),"shouldIgnorePairingRequest",function(e){var t=e.topic,r=e.requestMethod,i=n.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&n.client.events.listenerCount("session_authenticate")>0)}),$I(w(n),"onSessionProposeRequest",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.topic,i=t.payload,o=t.attestation,a=t.encryptedId,s=i.params,c=i.id,e.p=1,u=n.client.core.eventClient.getEvent({topic:r}),0===n.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),null!=u&&u.setError(sd)),n.isValidConnect(QI({},i.params)),l=s.expiryTimestamp||Fm(jI.wc_sessionPropose.req.ttl),f=QI({id:c,pairingTopic:r,expiryTimestamp:l},s),e.n=2,n.setProposal(c,f);case 2:return e.n=3,n.getVerifyContext({attestationId:o,hash:Ck(JSON.stringify(i)),encryptedId:a,metadata:f.proposer.metadata});case 3:h=e.v,null!=u&&u.addTrace(td),n.client.events.emit("session_proposal",{id:c,params:f,verifyContext:h}),e.n=6;break;case 4:return e.p=4,p=e.v,e.n=5,n.sendError({id:c,topic:r,error:p,rpcOpts:jI.wc_sessionPropose.autoReject});case 5:n.client.logger.error(p);case 6:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"onSessionProposeResponse",function(){var e=g(d().m(function e(t,r,i){var o,a,s,c,u,l,f,h;return d().w(function(e){for(;;)switch(e.n){case 0:if(o=r.id,!Gf(r)){e.n=4;break}return a=r.result,n.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:a}),s=n.client.proposal.get(o),n.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:s}),c=s.proposer.publicKey,n.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c}),u=a.responderPublicKey,n.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u}),e.n=1,n.client.core.crypto.generateSharedKey(c,u);case 1:return l=e.v,n.pendingSessions.set(o,{sessionTopic:l,pairingTopic:t,proposalId:o,publicKey:c}),e.n=2,n.client.core.relayer.subscribe(l,{transportType:i});case 2:return f=e.v,n.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),e.n=3,n.client.core.pairing.activate({topic:t});case 3:e.n=7;break;case 4:if(!Zf(r)){e.n=7;break}return e.n=5,n.client.proposal.delete(o,eI("USER_DISCONNECTED"));case 5:if(h=Wm("session_connect",o),0!==n.events.listenerCount(h)){e.n=6;break}throw new Error("emitting ".concat(h," without any listeners, 954"));case 6:n.events.emit(h,{error:r.error});case 7:return e.a(2)}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()),$I(w(n),"onSessionSettleRequest",function(){var e=g(d().m(function e(t,r){var i,o,a,s,c,u,f,h,p,v,g,y,m,w;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=r.id,o=r.params,e.p=1,n.isValidSessionSettleRequest(o),a=r.params,s=a.relay,c=a.controller,u=a.expiry,f=a.namespaces,h=a.sessionProperties,p=a.scopedProperties,v=a.sessionConfig,g=l(n.pendingSessions.values()).find(function(e){return e.sessionTopic===t}),g){e.n=2;break}return e.a(2,n.client.logger.error("Pending session not found for topic ".concat(t)));case 2:return y=n.client.proposal.get(g.proposalId),m=XI(QI(QI(QI({topic:t,relay:s,expiry:u,namespaces:f,acknowledged:!0,pairingTopic:g.pairingTopic,requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces,controller:c.publicKey,self:{publicKey:g.publicKey,metadata:n.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},h&&{sessionProperties:h}),p&&{scopedProperties:p}),v&&{sessionConfig:v}),{transportType:Eh}),e.n=3,n.client.session.set(m.topic,m);case 3:return e.n=4,n.setExpiry(m.topic,m.expiry);case 4:return e.n=5,n.client.core.pairing.updateMetadata({topic:g.pairingTopic,metadata:m.peer.metadata});case 5:return n.client.events.emit("session_connect",{session:m}),n.events.emit(Wm("session_connect",g.proposalId),{session:m}),n.pendingSessions.delete(g.proposalId),n.deleteProposal(g.proposalId,!1),n.cleanupDuplicatePairings(m),e.n=6,n.sendResult({id:r.id,topic:t,result:!0,throwOnFailedPublish:!0});case 6:e.n=9;break;case 7:return e.p=7,w=e.v,e.n=8,n.sendError({id:i,topic:t,error:w});case 8:n.client.logger.error(w);case 9:return e.a(2)}},e,null,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"onSessionSettleResponse",function(){var e=g(d().m(function e(t,r){var i;return d().w(function(e){for(;;)switch(e.n){case 0:if(i=r.id,!Gf(r)){e.n=2;break}return e.n=1,n.client.session.update(t,{acknowledged:!0});case 1:n.events.emit(Wm("session_approve",i),{}),e.n=4;break;case 2:if(!Zf(r)){e.n=4;break}return e.n=3,n.client.session.delete(t,eI("USER_DISCONNECTED"));case 3:n.events.emit(Wm("session_approve",i),{error:r.error});case 4:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"onSessionUpdateRequest",function(){var e=g(d().m(function e(t,r){var i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=r.params,o=r.id,e.p=1,a="".concat(t,"_session_update"),!(s=_I.get(a))||!n.isRequestOutOfSync(s,o)){e.n=2;break}return n.client.logger.warn("Discarding out of sync request - ".concat(o)),n.sendError({id:o,topic:t,error:eI("INVALID_UPDATE_REQUEST")}),e.a(2);case 2:return n.isValidUpdate(QI({topic:t},i)),e.p=3,_I.set(a,o),e.n=4,n.client.session.update(t,{namespaces:i.namespaces});case 4:return e.n=5,n.sendResult({id:o,topic:t,result:!0,throwOnFailedPublish:!0});case 5:e.n=7;break;case 6:throw e.p=6,c=e.v,_I.delete(a),c;case 7:n.client.events.emit("session_update",{id:o,topic:t,params:i}),e.n=10;break;case 8:return e.p=8,u=e.v,e.n=9,n.sendError({id:o,topic:t,error:u});case 9:n.client.logger.error(u);case 10:return e.a(2)}},e,null,[[3,6],[1,8]])}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"isRequestOutOfSync",function(e,t){return t.toString().slice(0,-3)<e.toString().slice(0,-3)}),$I(w(n),"onSessionUpdateResponse",function(e,t){var r=t.id,i=Wm("session_update",r);if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners"));Gf(t)?n.events.emit(Wm("session_update",r),{}):Zf(t)&&n.events.emit(Wm("session_update",r),{error:t.error})}),$I(w(n),"onSessionExtendRequest",function(){var e=g(d().m(function e(t,r){var i,o;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=r.id,e.p=1,n.isValidExtend({topic:t}),e.n=2,n.setExpiry(t,Fm(UI));case 2:return e.n=3,n.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0});case 3:n.client.events.emit("session_extend",{id:i,topic:t}),e.n=6;break;case 4:return e.p=4,o=e.v,e.n=5,n.sendError({id:i,topic:t,error:o});case 5:n.client.logger.error(o);case 6:return e.a(2)}},e,null,[[1,4]])}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"onSessionExtendResponse",function(e,t){var r=t.id,i=Wm("session_extend",r);if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners"));Gf(t)?n.events.emit(Wm("session_extend",r),{}):Zf(t)&&n.events.emit(Wm("session_extend",r),{error:t.error})}),$I(w(n),"onSessionPingRequest",function(){var e=g(d().m(function e(t,r){var i,o;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=r.id,e.p=1,n.isValidPing({topic:t}),e.n=2,n.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0});case 2:n.client.events.emit("session_ping",{id:i,topic:t}),e.n=5;break;case 3:return e.p=3,o=e.v,e.n=4,n.sendError({id:i,topic:t,error:o});case 4:n.client.logger.error(o);case 5:return e.a(2)}},e,null,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"onSessionPingResponse",function(e,t){var r=t.id,i=Wm("session_ping",r);setTimeout(function(){if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners 2176"));Gf(t)?n.events.emit(Wm("session_ping",r),{}):Zf(t)&&n.events.emit(Wm("session_ping",r),{error:t.error})},500)}),$I(w(n),"onSessionDeleteRequest",function(){var e=g(d().m(function e(t,r){var i;return d().w(function(e){for(;;)switch(e.n){case 0:i=r.id;try{n.isValidDisconnect({topic:t,reason:r.params}),Promise.all([new Promise(function(e){n.client.core.relayer.once(ph,g(d().m(function r(){var o;return d().w(function(r){for(;;)switch(r.n){case 0:return o=e,r.n=1,n.deleteSession({topic:t,id:i});case 1:o(r.v);case 2:return r.a(2)}},r)})))}),n.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),n.cleanupPendingSentRequestsForTopic({topic:t,error:eI("USER_DISCONNECTED")})]).catch(function(e){return n.client.logger.error(e)})}catch(jt){n.client.logger.error(jt)}case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"onSessionRequest",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=t.topic,s=t.payload,c=t.attestation,u=t.encryptedId,l=t.transportType,f=s.id,h=s.params,e.p=1,e.n=2,n.isValidRequest(QI({topic:a},h));case 2:return p=n.client.session.get(a),e.n=3,n.getVerifyContext({attestationId:c,hash:Ck(JSON.stringify(Lf("wc_sessionRequest",h,f))),encryptedId:u,metadata:p.peer.metadata,transportType:l});case 3:return v=e.v,g={id:f,topic:a,params:h,verifyContext:v},e.n=4,n.setPendingSessionRequest(g);case 4:l===bh&&null!=(r=p.peer.metadata.redirect)&&r.universal&&n.client.core.addLinkModeSupportedApp(null==(i=p.peer.metadata.redirect)?void 0:i.universal),null!=(o=n.client.signConfig)&&o.disableRequestQueue?n.emitSessionRequest(g):(n.addSessionRequestToSessionRequestQueue(g),n.processSessionRequestQueue()),e.n=7;break;case 5:return e.p=5,y=e.v,e.n=6,n.sendError({id:f,topic:a,error:y});case 6:n.client.logger.error(y);case 7:return e.a(2)}},e,null,[[1,5]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"onSessionRequestResponse",function(e,t){var r=t.id,i=Wm("session_request",r);if(0===n.events.listenerCount(i))throw new Error("emitting ".concat(i," without any listeners"));Gf(t)?n.events.emit(Wm("session_request",r),{result:t.result}):Zf(t)&&n.events.emit(Wm("session_request",r),{error:t.error})}),$I(w(n),"onSessionEventRequest",function(){var e=g(d().m(function e(t,r){var i,o,a,s,c;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=r.id,o=r.params,e.p=1,a="".concat(t,"_session_event_").concat(o.event.name),!(s=_I.get(a))||!n.isRequestOutOfSync(s,i)){e.n=2;break}return n.client.logger.info("Discarding out of sync request - ".concat(i)),e.a(2);case 2:n.isValidEmit(QI({topic:t},o)),n.client.events.emit("session_event",{id:i,topic:t,params:o}),_I.set(a,i),e.n=5;break;case 3:return e.p=3,c=e.v,e.n=4,n.sendError({id:i,topic:t,error:c});case 4:n.client.logger.error(c);case 5:return e.a(2)}},e,null,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()),$I(w(n),"onSessionAuthenticateResponse",function(e,t){var r=t.id;n.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),Gf(t)?n.events.emit(Wm("session_request",r),{result:t.result}):Zf(t)&&n.events.emit(Wm("session_request",r),{error:t.error})}),$I(w(n),"onSessionAuthenticateRequest",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y,m,w,b;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=t.topic,o=t.payload,a=t.attestation,s=t.encryptedId,c=t.transportType,e.p=1,u=o.params,l=u.requester,f=u.authPayload,h=u.expiryTimestamp,e.n=2,n.getVerifyContext({attestationId:a,hash:Ck(JSON.stringify(o)),encryptedId:s,metadata:l.metadata,transportType:c});case 2:return p=e.v,v={requester:l,pairingTopic:i,id:o.id,authPayload:f,verifyContext:p,expiryTimestamp:h},e.n=3,n.setAuthRequest(o.id,{request:v,pairingTopic:i,transportType:c});case 3:c===bh&&null!=(r=l.metadata.redirect)&&r.universal&&n.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),n.client.events.emit("session_authenticate",{topic:i,params:o.params,id:o.id,verifyContext:p}),e.n=6;break;case 4:return e.p=4,b=e.v,n.client.logger.error(b),g=o.params.requester.publicKey,e.n=5,n.client.core.crypto.generateKeyPair();case 5:return y=e.v,m=n.getAppLinkIfEnabled(o.params.requester.metadata,c),w={type:1,receiverPublicKey:g,senderPublicKey:y},e.n=6,n.sendError({id:o.id,topic:i,error:b,encodeOpts:w,rpcOpts:jI.wc_sessionAuthenticate.autoReject,appLink:m});case 6:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"addSessionRequestToSessionRequestQueue",function(e){n.sessionRequestQueue.queue.push(e)}),$I(w(n),"cleanupAfterResponse",function(e){n.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(function(){n.sessionRequestQueue.state=DI,n.processSessionRequestQueue()},ue.toMiliseconds(n.requestQueueDelay))}),$I(w(n),"cleanupPendingSentRequestsForTopic",function(e){var t=e.topic,r=e.error,i=n.client.core.history.pending;i.length>0&&i.filter(function(e){return e.topic===t&&"wc_sessionRequest"===e.request.method}).forEach(function(e){var t=Wm("session_request",e.request.id);if(0===n.events.listenerCount(t))throw new Error("emitting ".concat(t," without any listeners"));n.events.emit(Wm("session_request",e.request.id),{error:r})})}),$I(w(n),"processSessionRequestQueue",function(){if(n.sessionRequestQueue.state!==qI){var e=n.sessionRequestQueue.queue[0];if(e)try{n.sessionRequestQueue.state=qI,n.emitSessionRequest(e)}catch(Gs){n.client.logger.error(Gs)}else n.client.logger.info("session request queue is empty.")}else n.client.logger.info("session request queue is already active.")}),$I(w(n),"emitSessionRequest",function(e){n.client.events.emit("session_request",e)}),$I(w(n),"onPairingCreated",function(e){if(e.methods&&n.expectedPairingMethodMap.set(e.topic,e.methods),!e.active){var t=n.client.proposal.getAll().find(function(t){return t.pairingTopic===e.topic});t&&n.onSessionProposeRequest({topic:e.topic,payload:Lf("wc_sessionPropose",XI(QI({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id)})}}),$I(w(n),"isValidConnect",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","connect() params: ".concat(JSON.stringify(t))),i=r.message,new Error(i);case 1:if(o=t.pairingTopic,a=t.requiredNamespaces,s=t.optionalNamespaces,c=t.sessionProperties,u=t.scopedProperties,l=t.relays,rI(o)){e.n=2;break}return e.n=2,n.isValidPairingTopic(o);case 2:if(dI(l)){e.n=3;break}throw f=$k("MISSING_OR_INVALID","connect() relays: ".concat(l)),h=f.message,new Error(h);case 3:if(rI(a)||0===nI(a)||(p="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces",["fatal","error","silent"].includes(n.client.logger.level)?console.warn(p):n.client.logger.warn(p),n.validateNamespaces(a,"requiredNamespaces")),!rI(s)&&0!==nI(s)&&n.validateNamespaces(s,"optionalNamespaces"),rI(c)||n.validateSessionProps(c,"sessionProperties"),rI(u)){e.n=4;break}if(n.validateSessionProps(u,"scopedProperties"),v=Object.keys(a||{}).concat(Object.keys(s||{})),Object.keys(u).every(function(e){return v.includes(e)})){e.n=4;break}throw new Error("Scoped properties must be a subset of required/optional namespaces, received: ".concat(JSON.stringify(u),", required/optional namespaces: ").concat(JSON.stringify(v)));case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"validateNamespaces",function(e,t){var n=function(e,t,n){var r=null;if(e&&nI(e)){var i=lI(e,t);i&&(r=i);var o=cI(e,t,n);o&&(r=o)}else r=$k("MISSING_OR_INVALID","".concat(t,", ").concat(n," should be an object with data"));return r}(e,"connect()",t);if(n)throw new Error(n.message)}),$I(w(n),"isValidApprove",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw new Error($k("MISSING_OR_INVALID","approve() params: ".concat(t)).message);case 1:return r=t.id,i=t.namespaces,o=t.relayProtocol,a=t.sessionProperties,s=t.scopedProperties,n.checkRecentlyDeleted(r),e.n=2,n.isValidProposalId(r);case 2:if(c=n.client.proposal.get(r),!(u=fI(i,"approve()"))){e.n=3;break}throw new Error(u.message);case 3:if(!(l=II(c.requiredNamespaces,i,"approve()"))){e.n=4;break}throw new Error(l.message);case 4:if(iI(o,!0)){e.n=5;break}throw f=$k("MISSING_OR_INVALID","approve() relayProtocol: ".concat(o)),h=f.message,new Error(h);case 5:if(rI(a)||n.validateSessionProps(a,"sessionProperties"),rI(s)){e.n=6;break}if(n.validateSessionProps(s,"scopedProperties"),p=new Set(Object.keys(i)),Object.keys(s).every(function(e){return p.has(e)})){e.n=6;break}throw new Error("Scoped properties must be a subset of approved namespaces, received: ".concat(JSON.stringify(s),", approved namespaces: ").concat(Array.from(p).join(", ")));case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidReject",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","reject() params: ".concat(t)),i=r.message,new Error(i);case 1:return o=t.id,a=t.reason,n.checkRecentlyDeleted(o),e.n=2,n.isValidProposalId(o);case 2:if(gI(a)){e.n=3;break}throw s=$k("MISSING_OR_INVALID","reject() reason: ".concat(JSON.stringify(a))),c=s.message,new Error(c);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidSessionSettleRequest",function(e){if(!vI(e)){var t=$k("MISSING_OR_INVALID","onSessionSettleRequest() params: ".concat(e)).message;throw new Error(t)}var n=e.relay,r=e.controller,i=e.namespaces,o=e.expiry;if(!hI(n)){var a=$k("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string").message;throw new Error(a)}var s=function(e,t){var n=null;return iI(null==e?void 0:e.publicKey,!1)||(n=$k("MISSING_OR_INVALID","".concat(t," controller public key should be a string"))),n}(r,"onSessionSettleRequest()");if(s)throw new Error(s.message);var c=fI(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Km(o)){var u=$k("EXPIRED","onSessionSettleRequest()").message;throw new Error(u)}}),$I(w(n),"isValidUpdate",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","update() params: ".concat(t)),i=r.message,new Error(i);case 1:return o=t.topic,a=t.namespaces,n.checkRecentlyDeleted(o),e.n=2,n.isValidSessionTopic(o);case 2:if(s=n.client.session.get(o),!(c=fI(a,"update()"))){e.n=3;break}throw new Error(c.message);case 3:if(!(u=II(s.requiredNamespaces,a,"update()"))){e.n=4;break}throw new Error(u.message);case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidExtend",function(){var e=g(d().m(function e(t){var r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","extend() params: ".concat(t)),i=r.message,new Error(i);case 1:return o=t.topic,n.checkRecentlyDeleted(o),e.n=2,n.isValidSessionTopic(o);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidRequest",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g,y,m,w;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","request() params: ".concat(t)),i=r.message,new Error(i);case 1:return o=t.topic,a=t.request,s=t.chainId,c=t.expiry,n.checkRecentlyDeleted(o),e.n=2,n.isValidSessionTopic(o);case 2:if(u=n.client.session.get(o),bI(l=u.namespaces,s)){e.n=3;break}throw f=$k("MISSING_OR_INVALID","request() chainId: ".concat(s)),h=f.message,new Error(h);case 3:if(yI(a)){e.n=4;break}throw p=$k("MISSING_OR_INVALID","request() ".concat(JSON.stringify(a))),v=p.message,new Error(v);case 4:if(EI(l,s,a.method)){e.n=5;break}throw g=$k("MISSING_OR_INVALID","request() method: ".concat(a.method)),y=g.message,new Error(y);case 5:if(!c||OI(c,LI)){e.n=6;break}throw m=$k("MISSING_OR_INVALID","request() expiry: ".concat(c,". Expiry must be a number (in seconds) between ").concat(LI.min," and ").concat(LI.max)),w=m.message,new Error(w);case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidRespond",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(vI(t)){e.n=1;break}throw i=$k("MISSING_OR_INVALID","respond() params: ".concat(t)),o=i.message,new Error(o);case 1:return a=t.topic,s=t.response,e.p=2,e.n=3,n.isValidSessionTopic(a);case 3:e.n=5;break;case 4:throw e.p=4,l=e.v,null!=(r=null==t?void 0:t.response)&&r.id&&n.cleanupAfterResponse(t),l;case 5:if(mI(s)){e.n=6;break}throw c=$k("MISSING_OR_INVALID","respond() response: ".concat(JSON.stringify(s))),u=c.message,new Error(u);case 6:return e.a(2)}},e,null,[[2,4]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidPing",function(){var e=g(d().m(function e(t){var r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","ping() params: ".concat(t)),i=r.message,new Error(i);case 1:return o=t.topic,e.n=2,n.isValidSessionOrPairingTopic(o);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidEmit",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f,h,p,v,g;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","emit() params: ".concat(t)),i=r.message,new Error(i);case 1:return o=t.topic,a=t.event,s=t.chainId,e.n=2,n.isValidSessionTopic(o);case 2:if(c=n.client.session.get(o),bI(u=c.namespaces,s)){e.n=3;break}throw l=$k("MISSING_OR_INVALID","emit() chainId: ".concat(s)),f=l.message,new Error(f);case 3:if(wI(a)){e.n=4;break}throw h=$k("MISSING_OR_INVALID","emit() event: ".concat(JSON.stringify(a))),p=h.message,new Error(p);case 4:if(kI(u,s,a.name)){e.n=5;break}throw v=$k("MISSING_OR_INVALID","emit() event: ".concat(JSON.stringify(a))),g=v.message,new Error(g);case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidDisconnect",function(){var e=g(d().m(function e(t){var r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(vI(t)){e.n=1;break}throw r=$k("MISSING_OR_INVALID","disconnect() params: ".concat(t)),i=r.message,new Error(i);case 1:return o=t.topic,e.n=2,n.isValidSessionOrPairingTopic(o);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"isValidAuthenticate",function(e){var t=e.chains,n=e.uri,r=e.domain,i=e.nonce;if(!Array.isArray(t)||0===t.length)throw new Error("chains is required and must be a non-empty array");if(!iI(n,!1))throw new Error("uri is required parameter");if(!iI(r,!1))throw new Error("domain is required parameter");if(!iI(i,!1))throw new Error("nonce is required parameter");if(l(new Set(t.map(function(e){return km(e).namespace}))).length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");if("eip155"!==km(t[0]).namespace)throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),$I(w(n),"getVerifyContext",function(){var e=g(d().m(function e(t){var r,i,o,a,s,c,u,l,f;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=t.attestationId,i=t.hash,o=t.encryptedId,a=t.metadata,s=t.transportType,c={verified:{verifyUrl:a.verifyUrl||Vh,validation:"UNKNOWN",origin:a.url||""}},e.p=1,s!==bh){e.n=2;break}return u=n.getAppLinkIfEnabled(a,s),e.a(2,(c.verified.validation=u&&new URL(u).origin===new URL(a.url).origin?"VALID":"INVALID",c));case 2:return e.n=3,n.client.core.verify.resolve({attestationId:r,hash:i,encryptedId:o,verifyUrl:a.verifyUrl});case 3:(l=e.v)&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(a.url).origin?"VALID":"INVALID"),e.n=5;break;case 4:e.p=4,f=e.v,n.client.logger.warn(f);case 5:return e.a(2,(n.client.logger.debug("Verify context: ".concat(JSON.stringify(c))),c))}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}()),$I(w(n),"validateSessionProps",function(e,t){Object.values(e).forEach(function(n,r){if(null==n){var i=$k("MISSING_OR_INVALID","".concat(t," must contain an existing value for each key. Received: ").concat(n," for key ").concat(Object.keys(e)[r])).message;throw new Error(i)}})}),$I(w(n),"getPendingAuthRequest",function(e){var t=n.client.auth.requests.get(e);return"object"==_(t)?t:void 0}),$I(w(n),"addToRecentlyDeleted",function(e,t){if(n.recentlyDeletedMap.set(e,t),n.recentlyDeletedMap.size>=n.recentlyDeletedLimit){var r,i=0,o=n.recentlyDeletedLimit/2,a=u(n.recentlyDeletedMap.keys());try{for(a.s();!(r=a.n()).done;){var s=r.value;if(i++>=o)break;n.recentlyDeletedMap.delete(s)}}catch(c){a.e(c)}finally{a.f()}}}),$I(w(n),"checkRecentlyDeleted",function(e){var t=n.recentlyDeletedMap.get(e);if(t){var r=$k("MISSING_OR_INVALID","Record was recently deleted - ".concat(t,": ").concat(e)).message;throw new Error(r)}}),$I(w(n),"isLinkModeEnabled",function(e,t){var r,i,o,a,s,c,u,l,f;return!(!e||t!==bh)&&(!0===(null==(i=null==(r=n.client.metadata)?void 0:r.redirect)?void 0:i.linkMode)&&void 0!==(null==(a=null==(o=n.client.metadata)?void 0:o.redirect)?void 0:a.universal)&&""!==(null==(c=null==(s=n.client.metadata)?void 0:s.redirect)?void 0:c.universal)&&void 0!==(null==(u=null==e?void 0:e.redirect)?void 0:u.universal)&&""!==(null==(l=null==e?void 0:e.redirect)?void 0:l.universal)&&!0===(null==(f=null==e?void 0:e.redirect)?void 0:f.linkMode)&&n.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&_(null==global?void 0:global.Linking)<"u")}),$I(w(n),"getAppLinkIfEnabled",function(e,t){var r;return n.isLinkModeEnabled(e,t)?null==(r=null==e?void 0:e.redirect)?void 0:r.universal:void 0}),$I(w(n),"handleLinkModeMessage",function(e){var t=e.url;if(t&&t.includes("wc_ev")&&t.includes("topic")){var r=ew(t,"topic")||"",i=decodeURIComponent(ew(t,"wc_ev")||""),o=n.client.session.keys.includes(r);o&&n.client.session.update(r,{transportType:bh}),n.client.core.dispatchEnvelope({topic:r,message:i,sessionExists:o})}}),$I(w(n),"registerLinkModeListeners",g(d().m(function e(){var t,r,i;return d().w(function(e){for(;;)switch(e.n){case 0:if(!(tw()||Lm()&&null!=(t=n.client.metadata.redirect)&&t.linkMode)){e.n=2;break}if(!(_(r=null==global?void 0:global.Linking)<"u")){e.n=2;break}return r.addEventListener("url",n.handleLinkModeMessage,n.client.name),e.n=1,r.getInitialURL();case 1:(i=e.v)&&setTimeout(function(){n.handleLinkModeMessage({url:i})},50);case 2:return e.a(2)}},e)}))),$I(w(n),"shouldSetTVF",function(e,t){if(!t||"wc_sessionRequest"!==e)return!1;var n=t.request;return Object.keys(MI).includes(n.method)}),$I(w(n),"getTVFParams",function(e,t,r){var i,o;try{var a=t.request.method,s=n.extractTxHashesFromResult(a,r);return XI(QI({correlationId:e,rpcMethods:[a],chainId:t.chainId},n.isValidContractData(t.request.params)&&{contractAddresses:[null==(o=null==(i=t.request.params)?void 0:i[0])?void 0:o.to]}),{txHashes:s})}catch(vS){n.client.logger.warn("Error getting TVF params",vS)}return{}}),$I(w(n),"isValidContractData",function(e){var t;if(!e)return!1;try{var n=(null==e?void 0:e.data)||(null==(t=null==e?void 0:e[0])?void 0:t.data);if(!n.startsWith("0x"))return!1;var r=n.slice(2);return!!/^[0-9a-fA-F]*$/.test(r)&&r.length%2==0}catch(i){}return!1}),$I(w(n),"extractTxHashesFromResult",function(e,t){try{var r;if("string"==typeof t)return[t];var i=t[MI[e].key];if(tI(i))return"solana_signAllTransactions"===e?i.map(function(e){return function(e){for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);var i=n[0];if(0===i)throw new Error("No signatures found");var o=1+64*i;if(n.length<o)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");var a=Buffer.from(e,"base64").slice(1,65);return bm.encode(a)}(e)}):i;if("string"==typeof i)return[i]}catch(r){n.client.logger.warn("Error extracting tx hashes from result",r)}return[]}),n}return k(t,e),P(t,[{key:"processPendingMessageEvents",value:(c=g(d().m(function e(){var t,n,i,o,a,s,c,l,f,h,p,v;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,t=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(t),i=0,o=Object.entries(n);case 1:if(!(i<o.length)){e.n=12;break}a=r(o[i],2),s=a[0],c=a[1],l=u(c),e.p=2,l.s();case 3:if((f=l.n()).done){e.n=8;break}return h=f.value,e.p=4,e.n=5,this.onProviderMessageEvent({topic:s,message:h,publishedAt:Date.now()});case 5:e.n=7;break;case 6:e.p=6,e.v,this.client.logger.warn("Error processing pending message event for topic: ".concat(s,", message: ").concat(h));case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,p=e.v,l.e(p);case 10:return e.p=10,l.f(),e.f(10);case 11:i++,e.n=1;break;case 12:e.n=14;break;case 13:e.p=13,v=e.v,this.client.logger.warn("processPendingMessageEvents failed",v);case 14:return e.a(2)}},e,this,[[4,6],[2,9,10,11],[0,13]])})),function(){return c.apply(this,arguments)})},{key:"isInitialized",value:function(){if(!this.initialized){var e=$k("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"confirmOnlineStateOrThrow",value:(s=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.client.core.relayer.confirmOnlineStateOrThrow();case 1:return e.a(2)}},e,this)})),function(){return s.apply(this,arguments)})},{key:"registerRelayerEvents",value:function(){var e=this;this.client.core.relayer.on(ch,function(t){e.onProviderMessageEvent(t)})}},{key:"onRelayMessage",value:(a=g(d().m(function e(t){var n,r,i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t.topic,r=t.message,i=t.attestation,o=t.transportType,a=this.client.auth.authKeys.keys.includes(VI)?this.client.auth.authKeys.get(VI):{publicKey:void 0},s=a.publicKey,e.p=1,e.n=2,this.client.core.crypto.decode(n,r,{receiverPublicKey:s,encoding:o===bh?Rk:Nk});case 2:if(!Kf(c=e.v)){e.n=4;break}return this.client.core.history.set(n,c),e.n=3,this.onRelayEventRequest({topic:n,payload:c,attestation:i,transportType:o,encryptedId:Ck(r)});case 3:e.n=8;break;case 4:if(!Wf(c)){e.n=7;break}return e.n=5,this.client.core.history.resolve(c);case 5:return e.n=6,this.onRelayEventResponse({topic:n,payload:c,transportType:o});case 6:this.client.core.history.delete(n,c.id),e.n=8;break;case 7:return e.n=8,this.onRelayEventUnknownPayload({topic:n,payload:c,transportType:o});case 8:return e.n=9,this.client.core.relayer.messages.ack(n,r);case 9:e.n=11;break;case 10:e.p=10,u=e.v,this.client.logger.error(u);case 11:return e.a(2)}},e,this,[[1,10]])})),function(e){return a.apply(this,arguments)})},{key:"registerExpirerEvents",value:function(){var e=this;this.client.core.expirer.on(Mh,function(){var t=g(d().m(function t(n){var r,i,o;return d().w(function(t){for(;;)switch(t.n){case 0:if(r=Vm(n.target),i=r.topic,!(o=r.id)||!e.client.pendingRequest.keys.includes(o)){t.n=2;break}return t.n=1,e.deletePendingSessionRequest(o,$k("EXPIRED"),!0);case 1:return t.a(2,t.v);case 2:if(!o||!e.client.auth.requests.keys.includes(o)){t.n=4;break}return t.n=3,e.deletePendingAuthRequest(o,$k("EXPIRED"),!0);case 3:return t.a(2,t.v);case 4:if(!i){t.n=7;break}if(!e.client.session.keys.includes(i)){t.n=6;break}return t.n=5,e.deleteSession({topic:i,expirerHasDeleted:!0});case 5:e.client.events.emit("session_expire",{topic:i});case 6:t.n=9;break;case 7:if(!o){t.n=9;break}return t.n=8,e.deleteProposal(o,!0);case 8:e.client.events.emit("proposal_expire",{id:o});case 9:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"registerPairingEvents",value:function(){var e=this;this.client.core.pairing.events.on(Th,function(t){return e.onPairingCreated(t)}),this.client.core.pairing.events.on(Rh,function(t){e.addToRecentlyDeleted(t.topic,"pairing")})}},{key:"isValidPairingTopic",value:function(e){if(!iI(e,!1)){var t=$k("MISSING_OR_INVALID","pairing topic should be a string: ".concat(e)).message;throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){var n=$k("NO_MATCHING_KEY","pairing topic doesn't exist: ".concat(e)).message;throw new Error(n)}if(Km(this.client.core.pairing.pairings.get(e).expiry)){var r=$k("EXPIRED","pairing topic: ".concat(e)).message;throw new Error(r)}}},{key:"isValidSessionTopic",value:(o=g(d().m(function e(t){var n,r,i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.n){case 0:if(iI(t,!1)){e.n=1;break}throw n=$k("MISSING_OR_INVALID","session topic should be a string: ".concat(t)),r=n.message,new Error(r);case 1:if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t)){e.n=2;break}throw i=$k("NO_MATCHING_KEY","session topic doesn't exist: ".concat(t)),o=i.message,new Error(o);case 2:if(!Km(this.client.session.get(t).expiry)){e.n=4;break}return e.n=3,this.deleteSession({topic:t});case 3:throw a=$k("EXPIRED","session topic: ".concat(t)),s=a.message,new Error(s);case 4:if(this.client.core.crypto.keychain.has(t)){e.n=6;break}return c=$k("MISSING_OR_INVALID","session topic does not exist in keychain: ".concat(t)),u=c.message,e.n=5,this.deleteSession({topic:t});case 5:throw new Error(u);case 6:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"isValidSessionOrPairingTopic",value:(i=g(d().m(function e(t){var n,r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){e.n=2;break}return e.n=1,this.isValidSessionTopic(t);case 1:e.n=5;break;case 2:if(!this.client.core.pairing.pairings.keys.includes(t)){e.n=3;break}this.isValidPairingTopic(t),e.n=5;break;case 3:if(!iI(t,!1)){e.n=4;break}throw n=$k("NO_MATCHING_KEY","session or pairing topic doesn't exist: ".concat(t)),r=n.message,new Error(r);case 4:throw i=$k("MISSING_OR_INVALID","session or pairing topic should be a string: ".concat(t)),o=i.message,new Error(o);case 5:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"isValidProposalId",value:(n=g(d().m(function e(t){var n,r,i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:if(pI(t)){e.n=1;break}throw n=$k("MISSING_OR_INVALID","proposal id should be a number: ".concat(t)),r=n.message,new Error(r);case 1:if(this.client.proposal.keys.includes(t)){e.n=2;break}throw i=$k("NO_MATCHING_KEY","proposal id doesn't exist: ".concat(t)),o=i.message,new Error(o);case 2:if(!Km(this.client.proposal.get(t).expiryTimestamp)){e.n=4;break}return e.n=3,this.deleteProposal(t);case 3:throw a=$k("EXPIRED","proposal id: ".concat(t)),s=a.message,new Error(s);case 4:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})}]);var n,i,o,a,s,c}(Dt),tS=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n,"proposal",TI])).core=e,r.logger=n,r}return k(t,e),P(t)}(Og),nS=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n,"session",TI])).core=e,r.logger=n,r}return k(t,e),P(t)}(Og),rS=function(e){function t(e,n){var r;return S(this,t),r=y(this,t,[e,n,"request",TI,function(e){return e.id}]),r.core=e,r.logger=n,r}return k(t,e),P(t)}(Og),iS=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n,"authKeys",HI,function(){return VI}])).core=e,r.logger=n,r}return k(t,e),P(t)}(Og),oS=function(e){function t(e,n){var r;return S(this,t),(r=y(this,t,[e,n,"pairingTopics",HI])).core=e,r.logger=n,r}return k(t,e),P(t)}(Og),aS=function(e){function t(e,n){var r;return S(this,t),r=y(this,t,[e,n,"requests",HI,function(e){return e.id}]),r.core=e,r.logger=n,r}return k(t,e),P(t)}(Og),sS=Object.defineProperty,cS=function(e,t,n){return function(e,t,n){return t in e?sS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},uS=function(){return P(function e(t,n){S(this,e),this.core=t,this.logger=n,cS(this,"authKeys"),cS(this,"pairingTopics"),cS(this,"requests"),this.authKeys=new iS(this.core,this.logger),this.pairingTopics=new oS(this.core,this.logger),this.requests=new aS(this.core,this.logger)},[{key:"init",value:(e=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.authKeys.init();case 1:return e.n=2,this.pairingTopics.init();case 2:return e.n=3,this.requests.init();case 3:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})}]);var e}(),lS=Object.defineProperty,fS=function(e,t,n){return function(e,t,n){return t in e?lS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},hS=function(e){function t(e){var n;S(this,t),n=y(this,t,[e]),fS(w(n),"protocol","wc"),fS(w(n),"version",2),fS(w(n),"name",NI),fS(w(n),"metadata"),fS(w(n),"core"),fS(w(n),"logger"),fS(w(n),"events",new N.EventEmitter),fS(w(n),"engine"),fS(w(n),"session"),fS(w(n),"proposal"),fS(w(n),"pendingRequest"),fS(w(n),"auth"),fS(w(n),"signConfig"),fS(w(n),"on",function(e,t){return n.events.on(e,t)}),fS(w(n),"once",function(e,t){return n.events.once(e,t)}),fS(w(n),"off",function(e,t){return n.events.off(e,t)}),fS(w(n),"removeListener",function(e,t){return n.events.removeListener(e,t)}),fS(w(n),"removeAllListeners",function(e){return n.events.removeAllListeners(e)}),fS(w(n),"connect",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.connect(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"pair",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.pair(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"approve",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.approve(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"reject",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.reject(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"update",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.update(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"extend",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.extend(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"request",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.request(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"respond",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.respond(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"ping",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.ping(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"emit",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.emit(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"disconnect",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.disconnect(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"find",function(e){try{return n.engine.find(e)}catch(he){throw n.logger.error(he.message),he}}),fS(w(n),"getPendingSessionRequests",function(){try{return n.engine.getPendingSessionRequests()}catch(Gs){throw n.logger.error(Gs.message),Gs}}),fS(w(n),"authenticate",function(){var e=g(d().m(function e(t,r){var i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.authenticate(t,r);case 1:return e.a(2,e.v);case 2:throw e.p=2,i=e.v,n.logger.error(i.message),i;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t,n){return e.apply(this,arguments)}}()),fS(w(n),"formatAuthMessage",function(e){try{return n.engine.formatAuthMessage(e)}catch(he){throw n.logger.error(he.message),he}}),fS(w(n),"approveSessionAuthenticate",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.approveSessionAuthenticate(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),fS(w(n),"rejectSessionAuthenticate",function(){var e=g(d().m(function e(t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.engine.rejectSessionAuthenticate(t);case 1:return e.a(2,e.v);case 2:throw e.p=2,r=e.v,n.logger.error(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),n.name=(null==e?void 0:e.name)||NI,n.metadata=Mm(null==e?void 0:e.metadata),n.signConfig=null==e?void 0:e.signConfig;var r=_(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:Xe(gt({level:(null==e?void 0:e.logger)||RI}));return n.core=(null==e?void 0:e.core)||new ry(e),n.logger=mt(r,n.name),n.session=new nS(n.core,n.logger),n.proposal=new tS(n.core,n.logger),n.pendingRequest=new rS(n.core,n.logger),n.engine=new eS(n),n.auth=new uS(n.core,n.logger),n}return k(t,e),P(t,[{key:"context",get:function(){return yt(this.logger)}},{key:"pairing",get:function(){return this.core.pairing.pairings}},{key:"initialize",value:(r=g(d().m(function e(){var t,n=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.logger.trace("Initialized"),e.p=1,e.n=2,this.core.start();case 2:return e.n=3,this.session.init();case 3:return e.n=4,this.proposal.init();case 4:return e.n=5,this.pendingRequest.init();case 5:return e.n=6,this.auth.init();case 6:return e.n=7,this.engine.init();case 7:this.logger.info("SignClient Initialization Success"),setTimeout(function(){n.engine.processRelayMessageCache()},ue.toMiliseconds(ue.ONE_SECOND)),e.n=9;break;case 8:throw e.p=8,t=e.v,this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t;case 9:return e.a(2)}},e,this,[[1,8]])})),function(){return r.apply(this,arguments)})}],[{key:"init",value:(n=g(d().m(function e(n){var r;return d().w(function(e){for(;;)switch(e.n){case 0:return r=new t(n),e.n=1,r.initialize();case 1:return e.a(2,r)}},e)})),function(e){return n.apply(this,arguments)})}]);var n,r}(Lt),dS={exports:{}};var pS=(PI||(PI=1,function(e,t){var n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==p&&p,r=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n=void 0!==e&&e||"undefined"!=typeof self&&self||void 0!==p&&p||{},r="URLSearchParams"in n,i="Symbol"in n&&"iterator"in Symbol,o="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(rO){return!1}}(),a="FormData"in n,s="ArrayBuffer"in n;if(s)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function v(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function g(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function y(e){var t=new FileReader,n=g(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=v(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=v(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(o)return this.blob().then(y);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,n,r,i,o=v(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=g(t),r=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=r?r[1]:"utf-8",t.readAsText(e,i),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=l(e),t=f(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d.prototype.delete=function(e){delete this.map[l(e)]},d.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},d.prototype.set=function(e,t){this.map[l(e)]=f(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),h(e)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),h(e)},d.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),h(e)},i&&(d.prototype[Symbol.iterator]=d.prototype.entries);var b=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function E(e,t){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,i,o=(t=t||{}).body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(r=t.method||this.method||"GET",i=r.toUpperCase(),b.indexOf(i)>-1?i:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in n)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var a=/([?&])_=[^&]*/;a.test(this.url)?this.url=this.url.replace(a,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function k(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function I(e,t){if(!(this instanceof I))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},w.call(E.prototype),w.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},I.error=function(){var e=new I(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var S=[301,302,303,307,308];I.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new I(null,{status:t,headers:{location:e}})},t.DOMException=n.DOMException;try{new t.DOMException}catch(P){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function O(e,r){return new Promise(function(i,a){var c=new E(e,r);if(c.signal&&c.signal.aborted)return a(new t.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function h(){u.abort()}if(u.onload=function(){var e,t,n={statusText:u.statusText,headers:(e=u.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i)}catch(o){console.warn("Response "+o.message)}}}),t)};0===c.url.indexOf("file://")&&(u.status<200||u.status>599)?n.status=200:n.status=u.status,n.url="responseURL"in u?u.responseURL:n.headers.get("X-Request-URL");var r="response"in u?u.response:u.responseText;setTimeout(function(){i(new I(r,n))},0)},u.onerror=function(){setTimeout(function(){a(new TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){a(new TypeError("Network request timed out"))},0)},u.onabort=function(){setTimeout(function(){a(new t.DOMException("Aborted","AbortError"))},0)},u.open(c.method,function(e){try{return""===e&&n.location.href?n.location.href:e}catch(rO){return e}}(c.url),!0),"include"===c.credentials?u.withCredentials=!0:"omit"===c.credentials&&(u.withCredentials=!1),"responseType"in u&&(o?u.responseType="blob":s&&(u.responseType="arraybuffer")),r&&"object"===_(r.headers)&&!(r.headers instanceof d||n.Headers&&r.headers instanceof n.Headers)){var p=[];Object.getOwnPropertyNames(r.headers).forEach(function(e){p.push(l(e)),u.setRequestHeader(e,f(r.headers[e]))}),c.headers.forEach(function(e,t){-1===p.indexOf(t)&&u.setRequestHeader(t,e)})}else c.headers.forEach(function(e,t){u.setRequestHeader(t,e)});c.signal&&(c.signal.addEventListener("abort",h),u.onreadystatechange=function(){4===u.readyState&&c.signal.removeEventListener("abort",h)}),u.send(void 0===c._bodyInit?null:c._bodyInit)})}O.polyfill=!0,n.fetch||(n.fetch=O,n.Headers=d,n.Request=E,n.Response=I),t.Headers=d,t.Request=E,t.Response=I,t.fetch=O,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=n.fetch?n:r;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t}(dS,dS.exports)),dS.exports),vS=f(pS),gS=Object.defineProperty,yS=Object.defineProperties,mS=Object.getOwnPropertyDescriptors,wS=Object.getOwnPropertySymbols,bS=Object.prototype.hasOwnProperty,ES=Object.prototype.propertyIsEnumerable,kS=function(e,t,n){return t in e?gS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},IS=function(e,t){for(var n in t||(t={}))bS.call(t,n)&&kS(e,n,t[n]);if(wS){var r,i=u(wS(t));try{for(i.s();!(r=i.n()).done;){n=r.value;ES.call(t,n)&&kS(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},SS=function(e,t){return yS(e,mS(t))},OS={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},PS=function(){return P(function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(S(this,e),this.url=t,this.disableProviderPing=n,this.events=new N.EventEmitter,this.isAvailable=!1,this.registering=!1,!Hf(t))throw new Error("Provided URL is not compatible with HTTP connection: ".concat(t));this.url=t,this.disableProviderPing=n},[{key:"connected",get:function(){return this.isAvailable}},{key:"connecting",get:function(){return this.registering}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"open",value:(r=g(d().m(function e(){var t,n=arguments;return d().w(function(e){for(;;)switch(e.n){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.url,e.n=1,this.register(t);case 1:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"close",value:(n=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.isAvailable){e.n=1;break}throw new Error("Connection already closed");case 1:this.onClose();case 2:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"send",value:(t=g(d().m(function e(t){var n,r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isAvailable){e.n=1;break}return e.n=1,this.register();case 1:return e.p=1,n=Le(t),e.n=2,vS(this.url,SS(IS({},OS),{body:n}));case 2:return e.n=3,e.v.json();case 3:r=e.v,this.onPayload({data:r}),e.n=5;break;case 4:e.p=4,i=e.v,this.onError(t.id,i);case 5:return e.a(2)}},e,this,[[1,4]])})),function(e){return t.apply(this,arguments)})},{key:"register",value:(e=g(d().m(function e(){var t,n,r,i,o,a=this,s=arguments;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Hf(t=s.length>0&&void 0!==s[0]?s[0]:this.url)){e.n=1;break}throw new Error("Provided URL is not compatible with HTTP connection: ".concat(t));case 1:if(!this.registering){e.n=2;break}return n=this.events.getMaxListeners(),e.a(2,((this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise(function(e,t){a.events.once("register_error",function(e){a.resetMaxListeners(),t(e)}),a.events.once("open",function(){if(a.resetMaxListeners(),_(a.isAvailable)>"u")return t(new Error("HTTP connection is missing or invalid"));e()})})));case 2:if(this.url=t,this.registering=!0,e.p=3,this.disableProviderPing){e.n=4;break}return r=Le({id:1,jsonrpc:"2.0",method:"test",params:[]}),e.n=4,vS(t,SS(IS({},OS),{body:r}));case 4:this.onOpen(),e.n=6;break;case 5:throw e.p=5,o=e.v,i=this.parseError(o),this.events.emit("register_error",i),this.onClose(),i;case 6:return e.a(2)}},e,this,[[3,5]])})),function(){return e.apply(this,arguments)})},{key:"onOpen",value:function(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}},{key:"onClose",value:function(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}},{key:"onPayload",value:function(e){if(!(_(e.data)>"u")){var t="string"==typeof e.data?je(e.data):e.data;this.events.emit("payload",t)}}},{key:"onError",value:function(e,t){var n=this.parseError(t),r=qf(e,n.message||n.toString());this.events.emit("payload",r)}},{key:"parseError",value:function(e){return bf(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url,"HTTP")}},{key:"resetMaxListeners",value:function(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}]);var e,t,n,r}();t("V",PS);!function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=r}var a=e.length,s=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var n=0,r=0,i=0;e[n]===s;)0;for(var o=(e.length-n)*c+1>>>0,u=new Uint8Array(o);n<e.length;){var l=e.charCodeAt(n);if(l>255)return;var f=t[l];if(255===f)return;for(var h=0,d=o-1;(0!==f||h<i)&&-1!==d;h++)a*u[d]>>>0,u[d]=f%256>>>0;if(0!==f)throw new Error("Non-zero carry");0}for(var p=o-i;p!==o&&0===u[p];)0;for(var v=new Uint8Array(r+(o-p)),g=r;p!==o;)v[g++]=u[p++];return v}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");function xS(e){var t=r(e.split(":"),2);return{namespace:t[0],reference:t[1]}}function _S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return Object.keys(e).forEach(function(r){if(!t.length||t.includes(r)){var i=e[r];n.push.apply(n,l(i.accounts))}}),n}function AS(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return l(new Set([].concat(l(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),l(e))))}function TS(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function NS(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function RS(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function BS(e,t){NS(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var CS=BigInt(Math.pow(2,32)-1),US=BigInt(32);function jS(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&CS),l:Number(e>>US&CS)}:{h:0|Number(e>>US&CS),l:0|Number(e&CS)}}var LS="object"==("undefined"==typeof globalThis?"undefined":_(globalThis))&&"crypto"in globalThis?globalThis.crypto:void 0;function DS(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function qS(e,t){return e<<32-t|e>>>t}var MS=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function zS(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function HS(e){for(var t=0;t<e.length;t++)e[t]=zS(e[t])}function VS(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+_(e));return new Uint8Array((new TextEncoder).encode(e))}(e)),NS(e),e}function FS(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];NS(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r}var KS=function(){return P(function e(){S(this,e)},[{key:"clone",value:function(){return this._cloneInto()}}])}();function WS(e){var t=function(t){return e().update(VS(t)).digest()},n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(){return e()},t}function GS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(LS&&"function"==typeof LS.getRandomValues)return LS.getRandomValues(new Uint8Array(e));if(LS&&"function"==typeof LS.randomBytes)return LS.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}for(var ZS=[],YS=[],JS=[],QS=BigInt(0),XS=BigInt(1),$S=BigInt(2),eO=BigInt(7),tO=BigInt(256),nO=BigInt(113),rO=(Gs=0,XS),iO=1,oO=0;Gs<24;Gs++){var aO;iO=(aO=[oO,(2*iO+3*oO)%5])[0],oO=aO[1],ZS.push(2*(5*oO+iO)),YS.push((Gs+1)*(Gs+2)/2%64);var sO=QS;for(jt=0;jt<7;jt++)(rO=(rO<<XS^(rO>>eO)*nO)%tO)&$S&&(sO^=XS<<(XS<<BigInt(jt))-XS);JS.push(sO)}var cO=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length),i=0;i<e.length;i++){var o=jS(e[i],t),a=[o.h,o.l];n[i]=a[0],r[i]=a[1]}return[n,r]}(JS,!0),uO=r(cO,2),lO=uO[0],fO=uO[1],hO=function(e,t,n){return n>32?function(e,t,n){return t<<n-32|e>>>64-n}(e,t,n):function(e,t,n){return e<<n|t>>>32-n}(e,t,n)},dO=function(e,t,n){return n>32?function(e,t,n){return e<<n-32|t>>>64-n}(e,t,n):function(e,t,n){return t<<n|e>>>32-n}(e,t,n)};var pO=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(S(this,t),(i=y(this,t)).blockLen=e,i.suffix=n,i.outputLen=r,i.enableXOF=o,i.rounds=a,i.pos=0,i.posOut=0,i.finished=!1,i.destroyed=!1,TS(r),0>=i.blockLen||i.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");return i.state=new Uint8Array(200),i.state32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}(i.state),i}return k(t,e),P(t,[{key:"keccak",value:function(){MS||HS(this.state32),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,n=new Uint32Array(10),r=24-t;r<24;r++){for(var i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(var o=0;o<10;o+=2)for(var a=(o+8)%10,s=(o+2)%10,c=n[s],u=n[s+1],l=hO(c,u,1)^n[a],f=dO(c,u,1)^n[a+1],h=0;h<50;h+=10)e[o+h]^=l,e[o+h+1]^=f;for(var d=e[2],p=e[3],v=0;v<24;v++){var g=YS[v],y=hO(d,p,g),m=dO(d,p,g),w=ZS[v];d=e[w],p=e[w+1],e[w]=y,e[w+1]=m}for(var b=0;b<50;b+=10){for(var E=0;E<10;E++)n[E]=e[b+E];for(var k=0;k<10;k++)e[b+k]^=~n[(k+2)%10]&n[(k+4)%10]}e[0]^=lO[r],e[1]^=fO[r]}n.fill(0)}(this.state32,this.rounds),MS||HS(this.state32),this.posOut=0,this.pos=0}},{key:"update",value:function(e){RS(this);for(var t=this.blockLen,n=this.state,r=(e=VS(e)).length,i=0;i<r;){for(var o=Math.min(t-this.pos,r-i),a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}},{key:"finish",value:function(){if(!this.finished){this.finished=!0;var e=this.state,t=this.suffix,n=this.pos,r=this.blockLen;e[n]^=t,!!(128&t)&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}}},{key:"writeInto",value:function(e){RS(this,!1),NS(e),this.finish();for(var t=this.state,n=this.blockLen,r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();var o=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}},{key:"xofInto",value:function(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}},{key:"xof",value:function(e){return TS(e),this.xofInto(new Uint8Array(e))}},{key:"digestInto",value:function(e){if(BS(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}},{key:"digest",value:function(){return this.digestInto(new Uint8Array(this.outputLen))}},{key:"destroy",value:function(){this.destroyed=!0,this.state.fill(0)}},{key:"_cloneInto",value:function(e){var n=this.blockLen,r=this.suffix,i=this.outputLen,o=this.rounds,a=this.enableXOF;return e||(e=new t(n,r,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}])}(KS);function vO(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function gO(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function yO(e){if(!gO(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function mO(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function wO(e){if("boolean"!=typeof e)throw new Error("boolean expected, not ".concat(e))}!function(e,t,n){WS(function(){return new pO(t,e,n)})}(1,136,32);var bO=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function EO(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!gO(e))throw new Error("Uint8Array expected, got "+_(e));e=SO(e)}return e}function kO(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function IO(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),s=Number(n&o);e.setUint32(t+4,a,r),e.setUint32(t+0,s,r)}function SO(e){return Uint8Array.from(e)}function OO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)t[r].fill(0)}var PO=function(e){return Uint8Array.from(e.split("").map(function(e){return e.charCodeAt(0)}))},xO=PO("expand 16-byte k"),_O=PO("expand 32-byte k"),AO=bO(xO),TO=bO(_O);function NO(e,t){return e<<t|e>>>32-t}function RO(e){return e.byteOffset%4==0}var BO=Math.pow(2,32)-1,CO=new Uint32Array;var UO=function(e,t){return 255&e[t++]|(255&e[t++])<<8},jO=function(){return P(function e(t){S(this,e),this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,yO(t=EO(t),32);var n=UO(t,0),r=UO(t,2),i=UO(t,4),o=UO(t,6),a=UO(t,8),s=UO(t,10),c=UO(t,12),u=UO(t,14);this.r[0]=8191&n,this.r[1]=8191&(n>>>13|r<<3),this.r[2]=7939&(r>>>10|i<<6),this.r[3]=8191&(i>>>7|o<<9),this.r[4]=255&(o>>>4|a<<12),this.r[5]=a>>>1&8190,this.r[6]=8191&(a>>>14|s<<2),this.r[7]=8065&(s>>>11|c<<5),this.r[8]=8191&(c>>>8|u<<8),this.r[9]=u>>>5&127;for(var l=0;l<8;l++)this.pad[l]=UO(t,16+2*l)},[{key:"process",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,r=this.h,i=this.r,o=i[0],a=i[1],s=i[2],c=i[3],u=i[4],l=i[5],f=i[6],h=i[7],d=i[8],p=i[9],v=UO(e,t+0),g=UO(e,t+2),y=UO(e,t+4),m=UO(e,t+6),w=UO(e,t+8),b=UO(e,t+10),E=UO(e,t+12),k=UO(e,t+14),I=r[0]+(8191&v),S=r[1]+(8191&(v>>>13|g<<3)),O=r[2]+(8191&(g>>>10|y<<6)),P=r[3]+(8191&(y>>>7|m<<9)),x=r[4]+(8191&(m>>>4|w<<12)),_=r[5]+(w>>>1&8191),A=r[6]+(8191&(w>>>14|b<<2)),T=r[7]+(8191&(b>>>11|E<<5)),N=r[8]+(8191&(E>>>8|k<<8)),R=r[9]+(k>>>5|n),B=0,C=B+I*o+S*(5*p)+O*(5*d)+P*(5*h)+x*(5*f);B=C>>>13,C&=8191;var U=(B+=(C+=_*(5*l)+A*(5*u)+T*(5*c)+N*(5*s)+R*(5*a))>>>13)+I*a+S*o+O*(5*p)+P*(5*d)+x*(5*h);B=U>>>13,U&=8191,B+=(U+=_*(5*f)+A*(5*l)+T*(5*u)+N*(5*c)+R*(5*s))>>>13,U&=8191;var j=B+I*s+S*a+O*o+P*(5*p)+x*(5*d);B=j>>>13,j&=8191,B+=(j+=_*(5*h)+A*(5*f)+T*(5*l)+N*(5*u)+R*(5*c))>>>13,j&=8191;var L=B+I*c+S*s+O*a+P*o+x*(5*p);B=L>>>13,L&=8191,B+=(L+=_*(5*d)+A*(5*h)+T*(5*f)+N*(5*l)+R*(5*u))>>>13,L&=8191;var D=B+I*u+S*c+O*s+P*a+x*o;B=D>>>13,D&=8191,B+=(D+=_*(5*p)+A*(5*d)+T*(5*h)+N*(5*f)+R*(5*l))>>>13,D&=8191;var q=B+I*l+S*u+O*c+P*s+x*a;B=q>>>13,q&=8191,B+=(q+=_*o+A*(5*p)+T*(5*d)+N*(5*h)+R*(5*f))>>>13,q&=8191;var M=B+I*f+S*l+O*u+P*c+x*s;B=M>>>13,M&=8191,B+=(M+=_*a+A*o+T*(5*p)+N*(5*d)+R*(5*h))>>>13,M&=8191;var z=B+I*h+S*f+O*l+P*u+x*c;B=z>>>13,z&=8191,B+=(z+=_*s+A*a+T*o+N*(5*p)+R*(5*d))>>>13,z&=8191;var H=B+I*d+S*h+O*f+P*l+x*u;B=H>>>13,H&=8191,B+=(H+=_*c+A*s+T*a+N*o+R*(5*p))>>>13,H&=8191;var V=B+I*p+S*d+O*h+P*f+x*l;B=V>>>13,V&=8191,B+=(V+=_*u+A*c+T*s+N*a+R*o)>>>13,V&=8191,C=8191&(B=(B=(B<<2)+B|0)+(C&=8191)|0),U+=B>>>=13,r[0]=C,r[1]=U,r[2]=j,r[3]=L,r[4]=D,r[5]=q,r[6]=M,r[7]=z,r[8]=H,r[9]=V}},{key:"finalize",value:function(){var e=this.h,t=this.pad,n=new Uint16Array(10),r=e[1]>>>13;e[1]&=8191;for(var i=2;i<10;i++)e[i]+=r,r=e[i]>>>13,e[i]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,n[0]=e[0]+5,r=n[0]>>>13,n[0]&=8191;for(var o=1;o<10;o++)n[o]=e[o]+r,r=n[o]>>>13,n[o]&=8191;n[9]-=8192;for(var a=(1^r)-1,s=0;s<10;s++)n[s]&=a;a=~a;for(var c=0;c<10;c++)e[c]=e[c]&a|n[c];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);var u=e[0]+t[0];e[0]=65535&u;for(var l=1;l<8;l++)u=(e[l]+t[l]|0)+(u>>>16)|0,e[l]=65535&u;OO(n)}},{key:"update",value:function(e){mO(this);for(var t=this.buffer,n=this.blockLen,r=(e=EO(e)).length,i=0;i<r;){var o=Math.min(n-this.pos,r-i);if(o!==n)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=r-i;i+=n)this.process(e,i)}return this}},{key:"destroy",value:function(){OO(this.h,this.r,this.buffer,this.pad)}},{key:"digestInto",value:function(e){mO(this),function(e,t){yO(e);var n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;var t=this.buffer,n=this.h,r=this.pos;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();for(var i=0,o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var n=e.slice(0,t);return this.destroy(),n}}])}();var LO=function(e){var t=function(t,n){return e(n).update(EO(t)).digest()},n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=function(t){return e(t)},t}(function(e){return new jO(e)});var DO=function(e,t){var n=function(e,t){if(null==t||"object"!=_(t))throw new Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t),r=n.allowShortKeys,i=n.extendNonceFn,o=n.counterLength,a=n.counterRight,s=n.rounds;if("function"!=typeof e)throw new Error("core must be a function");return vO(o),vO(s),wO(a),wO(r),function(t,n,c,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;yO(t),yO(n),yO(c);var f=c.length;if(void 0===u&&(u=new Uint8Array(f)),yO(u),vO(l),l<0||l>=BO)throw new Error("arx: counter overflow");if(u.length<f)throw new Error("arx: output (".concat(u.length,") is shorter than data (").concat(f,")"));var h,d,p=[],v=t.length;if(32===v)p.push(h=SO(t)),d=TO;else{if(16!==v||!r)throw new Error("arx: invalid 32-byte key, got length=".concat(v));(h=new Uint8Array(32)).set(t),h.set(t,16),d=AO,p.push(h)}RO(n)||p.push(n=SO(n));var g=bO(h);if(i){if(24!==n.length)throw new Error("arx: extended nonce must be 24 bytes");i(d,g,bO(n.subarray(0,16)),g),n=n.subarray(16)}var y=16-o;if(y!==n.length)throw new Error("arx: nonce must be ".concat(y," or 16 bytes"));if(12!==y){var m=new Uint8Array(12);m.set(n,a?0:12-n.length),n=m,p.push(n)}var w=bO(n);return function(e,t,n,r,i,o,a,s){for(var c=i.length,u=new Uint8Array(64),l=bO(u),f=RO(i)&&RO(o),h=f?bO(i):CO,d=f?bO(o):CO,p=0;p<c;a++){if(e(t,n,r,l,a,s),a>=BO)throw new Error("arx: counter overflow");var v=Math.min(64,c-p);if(f&&64===v){var g=p/4;if(p%4!=0)throw new Error("arx: invalid block position");for(var y,m=0;m<16;m++)d[y=g+m]=h[y]^l[m];p+=64}else{for(var w,b=0;b<v;b++)o[w=p+b]=i[w]^u[b];p+=v}}}(e,d,g,w,c,u,l,s),OO.apply(void 0,p),u}}(function(e,t,n,r,i){for(var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,a=e[0],s=e[1],c=e[2],u=e[3],l=t[0],f=t[1],h=t[2],d=t[3],p=t[4],v=t[5],g=t[6],y=t[7],m=i,w=n[0],b=n[1],E=n[2],k=a,I=s,S=c,O=u,P=l,x=f,_=h,A=d,T=p,N=v,R=g,B=y,C=m,U=w,j=b,L=E,D=0;D<o;D+=2)C=NO(C^(k=k+P|0),16),P=NO(P^(T=T+C|0),12),C=NO(C^(k=k+P|0),8),P=NO(P^(T=T+C|0),7),U=NO(U^(I=I+x|0),16),x=NO(x^(N=N+U|0),12),U=NO(U^(I=I+x|0),8),x=NO(x^(N=N+U|0),7),j=NO(j^(S=S+_|0),16),_=NO(_^(R=R+j|0),12),j=NO(j^(S=S+_|0),8),_=NO(_^(R=R+j|0),7),L=NO(L^(O=O+A|0),16),A=NO(A^(B=B+L|0),12),L=NO(L^(O=O+A|0),8),A=NO(A^(B=B+L|0),7),L=NO(L^(k=k+x|0),16),x=NO(x^(R=R+L|0),12),L=NO(L^(k=k+x|0),8),x=NO(x^(R=R+L|0),7),C=NO(C^(I=I+_|0),16),_=NO(_^(B=B+C|0),12),C=NO(C^(I=I+_|0),8),_=NO(_^(B=B+C|0),7),U=NO(U^(S=S+A|0),16),A=NO(A^(T=T+U|0),12),U=NO(U^(S=S+A|0),8),A=NO(A^(T=T+U|0),7),j=NO(j^(O=O+P|0),16),P=NO(P^(N=N+j|0),12),j=NO(j^(O=O+P|0),8),P=NO(P^(N=N+j|0),7);var q=0;r[q++]=a+k|0,r[q++]=s+I|0,r[q++]=c+S|0,r[q++]=u+O|0,r[q++]=l+P|0,r[q++]=f+x|0,r[q++]=h+_|0,r[q++]=d+A|0,r[q++]=p+T|0,r[q++]=v+N|0,r[q++]=g+R|0,r[q++]=y+B|0,r[q++]=m+C|0,r[q++]=w+U|0,r[q++]=b+j|0,r[q++]=E+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),qO=new Uint8Array(16),MO=function(e,t){e.update(t);var n=t.length%16;n&&e.update(qO.subarray(n))},zO=new Uint8Array(32);function HO(e,t,n,r,i){var o=e(t,n,zO),a=LO.create(o);i&&MO(a,i),MO(a,r);var s=new Uint8Array(16),c=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}(s);IO(c,0,BigInt(i?i.length:0),!0),IO(c,8,BigInt(r.length),!0),a.update(s);var u=a.digest();return OO(o,s),u}!function(e,t){function n(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(yO(n),void 0!==e.nonceLength){var a=i[0];if(!a)throw new Error("nonce / iv required");e.varSizeNonce?yO(a):yO(a,e.nonceLength)}var s=e.tagLength;s&&void 0!==i[1]&&yO(i[1]);var c=t.apply(void 0,[n].concat(i)),u=function(e,t){if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");yO(t)}},l=!1;return{encrypt:function(e,t){if(l)throw new Error("cannot encrypt() twice with same key + nonce");return l=!0,yO(e),u(c.encrypt.length,t),c.encrypt(e,t)},decrypt:function(e,t){if(yO(e),s&&e.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return u(c.decrypt.length,t),c.decrypt(e,t)}}}Object.assign(n,e)}({blockSize:64,nonceLength:12,tagLength:16},function(e){return function(t,n,r){return{encrypt:function(i,o){var a=i.length;(o=kO(a+16,o,!1)).set(i);var s=o.subarray(0,-16);e(t,n,s,s,1);var c=HO(e,t,n,s,r);return o.set(c,a),OO(c),o},decrypt:function(i,o){o=kO(i.length-16,o,!1);var a=i.subarray(0,-16),s=i.subarray(-16),c=HO(e,t,n,a,r);if(!function(e,t){if(e.length!==t.length)return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}(s,c))throw new Error("invalid tag");return o.set(i.subarray(0,-16)),e(t,n,o,o,1),OO(c),o}}}}(DO));var VO=function(e){function t(e,n){var r;S(this,t),(r=y(this,t)).finished=!1,r.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");TS(e.outputLen),TS(e.blockLen)}(e);var i=VS(n);if(r.iHash=e.create(),"function"!=typeof r.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");r.blockLen=r.iHash.blockLen,r.outputLen=r.iHash.outputLen;var o=r.blockLen,a=new Uint8Array(o);a.set(i.length>o?e.create().update(i).digest():i);for(var s=0;s<a.length;s++)a[s]^=54;r.iHash.update(a),r.oHash=e.create();for(var c=0;c<a.length;c++)a[c]^=106;return r.oHash.update(a),a.fill(0),r}return k(t,e),P(t,[{key:"update",value:function(e){return RS(this),this.iHash.update(e),this}},{key:"digestInto",value:function(e){RS(this),NS(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}},{key:"digest",value:function(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}},{key:"_cloneInto",value:function(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,n=this.iHash,r=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}])}(KS),FO=function(e,t,n){return new VO(e,t).update(n).digest()};function KO(e,t,n){return e&t^~e&n}function WO(e,t,n){return e&t^e&n^t&n}FO.create=function(e,t){return new VO(e,t)};var GO=function(e){function t(e,n,r,i){var o;return S(this,t),(o=y(this,t)).blockLen=e,o.outputLen=n,o.padOffset=r,o.isLE=i,o.finished=!1,o.length=0,o.pos=0,o.destroyed=!1,o.buffer=new Uint8Array(e),o.view=DS(o.buffer),o}return k(t,e),P(t,[{key:"update",value:function(e){RS(this);for(var t=this.view,n=this.buffer,r=this.blockLen,i=(e=VS(e)).length,o=0;o<i;){var a=Math.min(r-this.pos,i-o);if(a!==r)n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===r&&(this.process(t,0),this.pos=0);else for(var s=DS(e);r<=i-o;o+=r)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){RS(this),BS(e,this),this.finished=!0;var t=this.buffer,n=this.view,r=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(var a=o;a<r;a++)t[a]=0;(function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),s=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+u,s,r)})(n,r-8,BigInt(8*this.length),i),this.process(n,0);var s=DS(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(var f=0;f<u;f++)s.setUint32(4*f,l[f],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var n=e.slice(0,t);return this.destroy(),n}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,l(this.get()));var n=this.blockLen,r=this.buffer,i=this.length,o=this.finished,a=this.destroyed,s=this.pos;return e.length=i,e.pos=s,e.finished=o,e.destroyed=a,i%n&&e.buffer.set(r),e}}])}(KS),ZO=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),YO=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),JO=new Uint32Array(64),QO=function(e){function t(){var e;return S(this,t),(e=y(this,t,[64,32,8,!1])).A=0|YO[0],e.B=0|YO[1],e.C=0|YO[2],e.D=0|YO[3],e.E=0|YO[4],e.F=0|YO[5],e.G=0|YO[6],e.H=0|YO[7],e}return k(t,e),P(t,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(e,t,n,r,i,o,a,s){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|s}},{key:"process",value:function(e,t){for(var n=0;n<16;n++,t+=4)JO[n]=e.getUint32(t,!1);for(var r=16;r<64;r++){var i=JO[r-15],o=JO[r-2],a=qS(i,7)^qS(i,18)^i>>>3,s=qS(o,17)^qS(o,19)^o>>>10;JO[r]=s+JO[r-7]+a+JO[r-16]|0}for(var c=this.A,u=this.B,l=this.C,f=this.D,h=this.E,d=this.F,p=this.G,v=this.H,g=0;g<64;g++){var y=v+(qS(h,6)^qS(h,11)^qS(h,25))+KO(h,d,p)+ZO[g]+JO[g]|0,m=(qS(c,2)^qS(c,13)^qS(c,22))+WO(c,u,l)|0;v=p,p=d,d=h,h=f+y|0,f=l,l=u,u=c,c=y+m|0}c=c+this.A|0,u=u+this.B|0,l=l+this.C|0,f=f+this.D|0,h=h+this.E|0,d=d+this.F|0,p=p+this.G|0,v=v+this.H|0,this.set(c,u,l,f,h,d,p,v)}},{key:"roundClean",value:function(){JO.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}])}(GO),XO=WS(function(){return new QO}),$O=BigInt(0),eP=BigInt(1),tP=BigInt(2);function nP(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function rP(e){if(!nP(e))throw new Error("Uint8Array expected")}function iP(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}var oP=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function aP(e){rP(e);for(var t="",n=0;n<e.length;n++)t+=oP[e[n]];return t}function sP(e){var t=e.toString(16);return 1&t.length?"0"+t:t}function cP(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));return""===e?$O:BigInt("0x"+e)}var uP=48,lP=57,fP=65,hP=70,dP=97,pP=102;function vP(e){return e>=uP&&e<=lP?e-uP:e>=fP&&e<=hP?e-(fP-10):e>=dP&&e<=pP?e-(dP-10):void 0}function gP(e){if("string"!=typeof e)throw new Error("hex string expected, got "+_(e));var t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var r=new Uint8Array(n),i=0,o=0;i<n;i++,o+=2){var a=vP(e.charCodeAt(o)),s=vP(e.charCodeAt(o+1));if(void 0===a||void 0===s){var c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}r[i]=16*a+s}return r}function yP(e){return cP(aP(e))}function mP(e){return rP(e),cP(aP(Uint8Array.from(e).reverse()))}function wP(e,t){return gP(e.toString(16).padStart(2*t,"0"))}function bP(e,t){return wP(e,t).reverse()}function EP(e,t,n){var r;if("string"==typeof t)try{r=gP(t)}catch(jt){throw new Error(e+" must be hex string or Uint8Array, cause: "+jt)}else{if(!nP(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}var i=r.length;if("number"==typeof n&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function kP(){for(var e=0,t=0;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];rP(n),e+=n.length}for(var r=new Uint8Array(e),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];r.set(a,o),o+=a.length}return r}var IP=function(e){return"bigint"==typeof e&&$O<=e};function SP(e,t,n){return IP(e)&&IP(t)&&IP(n)&&t<=e&&e<n}function OP(e,t,n,r){if(!SP(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function PP(e){var t;for(t=0;e>$O;e>>=eP,t+=1);return t}var xP=function(e){return(tP<<BigInt(e-1))-eP},_P=function(e){return new Uint8Array(e)},AP=function(e){return Uint8Array.from(e)};function TP(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");var r=_P(e),i=_P(e),o=0,a=function(){r.fill(1),i.fill(0),o=0},s=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.apply(void 0,[i,r].concat(t))},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_P();i=s(AP([0]),e),r=s(),0!==e.length&&(i=s(AP([1]),e),r=s())},u=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var e=0,n=[];e<t;){var i=(r=s()).slice();n.push(i),e+=r.length}return kP.apply(void 0,n)};return function(e,t){var n;for(a(),c(e);!(n=t(u()));)c();return a(),n}}var NP={bigint:function(e){return"bigint"==typeof e},function:function(e){return"function"==typeof e},boolean:function(e){return"boolean"==typeof e},string:function(e){return"string"==typeof e},stringOrUint8Array:function(e){return"string"==typeof e||nP(e)},isSafeInteger:function(e){return Number.isSafeInteger(e)},array:function(e){return Array.isArray(e)},field:function(e,t){return t.Fp.isValid(e)},hash:function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)}};function RP(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=function(t,n,r){var i=NP[n];if("function"!=typeof i)throw new Error("invalid validator function");var o=e[t];if(!(r&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)},o=0,a=Object.entries(t);o<a.length;o++){var s=r(a[o],2);i(s[0],s[1],!1)}for(var c=0,u=Object.entries(n);c<u.length;c++){var l=r(u[c],2);i(l[0],l[1],!0)}return e}function BP(e){var t=new WeakMap;return function(n){var r=t.get(n);if(void 0!==r)return r;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.apply(void 0,[n].concat(o));return t.set(n,s),s}}var CP=Object.freeze({__proto__:null,isBytes:nP,abytes:rP,abool:iP,bytesToHex:aP,numberToHexUnpadded:sP,hexToNumber:cP,hexToBytes:gP,bytesToNumberBE:yP,bytesToNumberLE:mP,numberToBytesBE:wP,numberToBytesLE:bP,numberToVarBytesBE:function(e){return gP(sP(e))},ensureBytes:EP,concatBytes:kP,equalBytes:function(e,t){if(e.length!==t.length)return!1;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))},inRange:SP,aInRange:OP,bitLen:PP,bitGet:function(e,t){return e>>BigInt(t)&eP},bitSet:function(e,t,n){return e|(n?eP:$O)<<BigInt(t)},bitMask:xP,createHmacDrbg:TP,validateObject:RP,notImplemented:function(){throw new Error("not implemented")},memoized:BP}),UP=BigInt(0),jP=BigInt(1),LP=BigInt(2),DP=BigInt(3),qP=BigInt(4),MP=BigInt(5),zP=BigInt(8);function HP(e,t){var n=e%t;return n>=UP?n:t+n}function VP(e,t,n){if(t<UP)throw new Error("invalid exponent, negatives unsupported");if(n<=UP)throw new Error("invalid modulus");if(n===jP)return UP;for(var r=jP;t>UP;)t&jP&&(r=r*e%n),e=e*e%n,t>>=jP;return r}function FP(e,t,n){for(var r=e;t-- >UP;)r*=r,r%=n;return r}function KP(e,t){if(e===UP)throw new Error("invert: expected non-zero number");if(t<=UP)throw new Error("invert: expected positive modulus, got "+t);for(var n=HP(e,t),r=t,i=UP,o=jP;n!==UP;){var a=r%n,s=i-o*(r/n);r=n,n=a,i=o,o=s}if(r!==jP)throw new Error("invert: does not exist");return HP(i,t)}function WP(e){if(e%qP===DP){var t=(e+jP)/qP;return function(e,n){var r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%zP===MP){var n=(e-MP)/zP;return function(e,t){var r=e.mul(t,LP),i=e.pow(r,n),o=e.mul(t,i),a=e.mul(e.mul(o,LP),i),s=e.mul(o,e.sub(a,e.ONE));if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}}return function(e){var t,n,r,i=(e-jP)/LP;for(t=e-jP,n=0;t%LP===UP;t/=LP,n++);for(r=LP;r<e&&VP(r,i,e)!==e-jP;r++)if(r>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){var o=(e+jP)/qP;return function(e,t){var n=e.pow(t,o);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}}var a=(t+jP)/LP;return function(e,o){if(e.pow(o,i)===e.neg(e.ONE))throw new Error("Cannot find square root");for(var s=n,c=e.pow(e.mul(e.ONE,r),t),u=e.pow(o,a),l=e.pow(o,t);!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;for(var f=1,h=e.sqr(l);f<s&&!e.eql(h,e.ONE);f++)h=e.sqr(h);var d=e.pow(c,jP<<BigInt(s-f-1));c=e.sqr(d),u=e.mul(u,d),l=e.mul(l,c),s=f}return u}}(e)}var GP=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ZP(e,t){var n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function YP(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=UP)throw new Error("invalid field: expected ORDER > 0, got "+e);var i,o=ZP(e,t),a=o.nBitLength,s=o.nByteLength;if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var c=Object.freeze({ORDER:e,isLE:n,BITS:a,BYTES:s,MASK:xP(a),ZERO:UP,ONE:jP,create:function(t){return HP(t,e)},isValid:function(t){if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+_(t));return UP<=t&&t<e},is0:function(e){return e===UP},isOdd:function(e){return(e&jP)===jP},neg:function(t){return HP(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return HP(t*t,e)},add:function(t,n){return HP(t+n,e)},sub:function(t,n){return HP(t-n,e)},mul:function(t,n){return HP(t*n,e)},pow:function(e,t){return function(e,t,n){if(n<UP)throw new Error("invalid exponent, negatives unsupported");if(n===UP)return e.ONE;if(n===jP)return t;for(var r=e.ONE,i=t;n>UP;)n&jP&&(r=e.mul(r,i)),i=e.sqr(i),n>>=jP;return r}(c,e,t)},div:function(t,n){return HP(t*KP(n,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return KP(t,e)},sqrt:r.sqrt||function(t){return i||(i=WP(e)),i(c,t)},invertBatch:function(e){return function(e,t){var n=new Array(t.length),r=t.reduce(function(t,r,i){return e.is0(r)?t:(n[i]=t,e.mul(t,r))},e.ONE),i=e.inv(r);return t.reduceRight(function(t,r,i){return e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))},i),n}(c,e)},cmov:function(e,t,n){return n?t:e},toBytes:function(e){return n?bP(e,s):wP(e,s)},fromBytes:function(e){if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return n?mP(e):yP(e)}});return Object.freeze(c)}function JP(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");var t=e.toString(2).length;return Math.ceil(t/8)}function QP(e){var t=JP(e);return t+Math.ceil(t/2)}var XP=BigInt(0),$P=BigInt(1);function ex(e,t){var n=t.negate();return e?n:t}function tx(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function nx(e,t){return tx(e,t),{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1)}}var rx=new WeakMap,ix=new WeakMap;function ox(e){return ix.get(e)||1}function ax(e,t,n,r){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(function(e,n){if(!(e instanceof t))throw new Error("invalid point at index "+n)})}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(function(e,n){if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");for(var i=e.ZERO,o=PP(BigInt(n.length)),a=o>12?o-3:o>4?o-2:o?2:1,s=(1<<a)-1,c=new Array(s+1).fill(i),u=i,l=Math.floor((t.BITS-1)/a)*a;l>=0;l-=a){c.fill(i);for(var f=0;f<r.length;f++){var h=r[f],d=Number(h>>BigInt(l)&BigInt(s));c[d]=c[d].add(n[f])}for(var p=i,v=c.length-1,g=i;v>0;v--)g=g.add(c[v]),p=p.add(g);if(u=u.add(p),0!==l)for(var y=0;y<a;y++)u=u.double()}return u}function sx(e){return function(e){var t=GP.reduce(function(e,t){return e[t]="function",e},{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});RP(e,t)}(e.Fp),RP(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(a(a(a({},ZP(e.n,e.nBitLength)),e),{},{p:e.Fp.ORDER}))}BigInt(0),BigInt(1),BigInt(2),BigInt(8);BigInt(0),BigInt(1);var cx=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);var ux=BigInt(1),lx=BigInt(2),fx=BigInt(3),hx=BigInt(5);function dx(e){void 0!==e.lowS&&iP("lowS",e.lowS),void 0!==e.prehash&&iP("prehash",e.prehash)}BigInt(8),function(e){var t=function(e){return RP(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(a({},e))}(e),n=t.P,r=function(e){return HP(e,n)},i=t.montgomeryBits,o=Math.ceil(i/8),s=t.nByteLength,c=t.adjustScalarBytes||function(e){return e},u=t.powPminus2||function(e){return VP(e,n-BigInt(2),n)};function l(e,t,n){var i=r(e*(t-n));return[r(t-i),r(n+i)]}var f=(t.a-BigInt(2))/BigInt(4);function h(e){return bP(r(e),o)}function d(e,t){var a=function(e){var t=EP("u coordinate",e,o);return 32===s&&(t[31]&=127),mP(t)}(t),d=function(e){var t=EP("scalar",e),n=t.length;if(n!==o&&n!==s)throw new Error("invalid scalar, expected "+o+" or "+s+" bytes, got "+n);return mP(c(t))}(e),p=function(e,t){OP("u",e,Ht,n),OP("scalar",t,Ht,n);for(var o,a=t,s=e,c=an,h=Ht,d=e,p=an,v=Ht,g=BigInt(i-1);g>=Ht;g--){var y=a>>g&an;l(v^=y,c,d)[0],o[1],l(v,h,p)[0],o[1];var m=c+h,w=r(m*m),b=c-h,E=r(b*b),k=w-E,I=d+p,S=r((d-p)*m),O=r(I*b),P=S+O,x=S-O;r(P*P),r(s*r(x*x)),r(w*E),r(k*(w+r(f*k)))}l(v,c,d)[0],o[1],l(v,h,p)[0],o[1];var _=u(h);return r(c*_)}(a,d);if(p===Ht)throw new Error("invalid private or public key received");return h(p)}var p=h(t.Gu);function v(e){return d(e,p)}}({P:cx,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:function(e){var t=cx,n=function(e){var t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),o=cx,a=e*e%o*e%o,s=FP(a,lx,o)*a%o,c=FP(s,ux,o)*e%o,u=FP(c,hx,o)*c%o,l=FP(u,t,o)*u%o,f=FP(l,n,o)*l%o,h=FP(f,r,o)*f%o,d=FP(h,i,o)*h%o,p=FP(d,i,o)*h%o,v=FP(p,t,o)*u%o;return{pow_p_5_8:FP(v,lx,o)*e%o,b2:a}}(e),r=n.pow_p_5_8,i=n.b2;return HP(FP(r,fx,t)*i,t)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:GS});var px=CP.bytesToNumberBE,vx=CP.hexToBytes,gx=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return S(this,t),y(this,t,[e])}return k(t,e),P(t)}(n(Error)),yx={Err:gx,_tlv:{encode:function(e,t){var n=yx.Err;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");var r=t.length/2,i=sP(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");var o=r>127?sP(i.length/2|128):"";return sP(e)+o+i+t},decode:function(e,t){var n=yx.Err,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");var i=t[r++],o=0;if(!!(128&i)){var a=127&i;if(!a)throw new n("tlv.decode(long): indefinite length not supported");if(a>4)throw new n("tlv.decode(long): byte length is too big");var s=t.subarray(r,r+a);if(s.length!==a)throw new n("tlv.decode: length bytes not complete");if(0===s[0])throw new n("tlv.decode(long): zero leftmost byte");var c,l=u(s);try{for(l.s();!(c=l.n()).done;){o=o<<8|c.value}}catch(h){l.e(h)}finally{l.f()}if(r+=a,o<128)throw new n("tlv.decode(long): not minimal encoding")}else o=i;var f=t.subarray(r,r+o);if(f.length!==o)throw new n("tlv.decode: wrong value length");return{v:f,l:t.subarray(r+o)}}},_int:{encode:function(e){var t=yx.Err;if(e<mx)throw new t("integer: negative integers are not allowed");var n=sP(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode:function(e){var t=yx.Err;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return px(e)}},toSig:function(e){var t=yx.Err,n=yx._int,r=yx._tlv,i="string"==typeof e?vx(e):e;rP(i);var o=r.decode(48,i),a=o.v;if(o.l.length)throw new t("invalid signature: left bytes after parsing");var s=r.decode(2,a),c=s.v,u=s.l,l=r.decode(2,u),f=l.v;if(l.l.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(f)}},hexFromSig:function(e){var t=yx._tlv,n=yx._int,r=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,r)}},mx=BigInt(0),wx=BigInt(1);BigInt(2);var bx=BigInt(3);function Ex(e){var t=function(e){var t=sx(e);RP(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var n=t.endo,r=t.Fp,i=t.a;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=_(n)||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze(a({},t))}(e),n=t.Fp,r=YP(t.n,t.nBitLength),i=t.toBytes||function(e,t,r){var i=t.toAffine();return kP(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))},o=t.fromBytes||function(e){var t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}};function s(e){var r=t.a,i=t.b,o=n.sqr(e),a=n.mul(o,e);return n.add(n.add(a,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function c(e){var n,r=t.allowedPrivateKeyLengths,i=t.nByteLength,o=t.wrapPrivateKey,a=t.n;if(r&&"bigint"!=typeof e){if(nP(e)&&(e=aP(e)),"string"!=typeof e||!r.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*i,"0")}try{n="bigint"==typeof e?e:yP(EP("private key",e,i))}catch(s){throw new Error("invalid private key, expected hex or "+i+" bytes, got "+_(e))}return o&&(n=HP(n,a)),OP("private key",n,wx,a),n}function u(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}var l=BP(function(e,t){var r=e.px,i=e.py,o=e.pz;if(n.eql(o,n.ONE))return{x:r,y:i};var a=e.is0();null==t&&(t=a?n.ONE:n.inv(o));var s=n.mul(r,t),c=n.mul(i,t),u=n.mul(o,t);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:s,y:c}}),f=BP(function(e){if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}var r=e.toAffine(),i=r.x,o=r.y;if(!n.isValid(i)||!n.isValid(o))throw new Error("bad point: x or y not FE");var a=n.sqr(o),c=s(i);if(!n.eql(a,c))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}),h=function(){function e(t,r,i){if(S(this,e),this.px=t,this.py=r,this.pz=i,null==t||!n.isValid(t))throw new Error("x required");if(null==r||!n.isValid(r))throw new Error("y required");if(null==i||!n.isValid(i))throw new Error("z required");Object.freeze(this)}return P(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){p.setWindowSize(this,e)}},{key:"assertValidity",value:function(){f(this)}},{key:"hasEvenY",value:function(){var e=this.toAffine().y;if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(e){u(e);var t=this.px,r=this.py,i=this.pz,o=e.px,a=e.py,s=e.pz,c=n.eql(n.mul(t,s),n.mul(o,i)),l=n.eql(n.mul(r,s),n.mul(a,i));return c&&l}},{key:"negate",value:function(){return new e(this.px,n.neg(this.py),this.pz)}},{key:"double",value:function(){var r=t.a,i=t.b,o=n.mul(i,bx),a=this.px,s=this.py,c=this.pz,u=n.ZERO,l=n.ZERO,f=n.ZERO,h=n.mul(a,a),d=n.mul(s,s),p=n.mul(c,c),v=n.mul(a,s);return v=n.add(v,v),f=n.mul(a,c),f=n.add(f,f),u=n.mul(r,f),l=n.mul(o,p),l=n.add(u,l),u=n.sub(d,l),l=n.add(d,l),l=n.mul(u,l),u=n.mul(v,u),f=n.mul(o,f),p=n.mul(r,p),v=n.sub(h,p),v=n.mul(r,v),v=n.add(v,f),f=n.add(h,h),h=n.add(f,h),h=n.add(h,p),h=n.mul(h,v),l=n.add(l,h),p=n.mul(s,c),p=n.add(p,p),h=n.mul(p,v),u=n.sub(u,h),f=n.mul(p,d),f=n.add(f,f),new e(u,l,f=n.add(f,f))}},{key:"add",value:function(r){u(r);var i=this.px,o=this.py,a=this.pz,s=r.px,c=r.py,l=r.pz,f=n.ZERO,h=n.ZERO,d=n.ZERO,p=t.a,v=n.mul(t.b,bx),g=n.mul(i,s),y=n.mul(o,c),m=n.mul(a,l),w=n.add(i,o),b=n.add(s,c);w=n.mul(w,b),b=n.add(g,y),w=n.sub(w,b),b=n.add(i,a);var E=n.add(s,l);return b=n.mul(b,E),E=n.add(g,m),b=n.sub(b,E),E=n.add(o,a),f=n.add(c,l),E=n.mul(E,f),f=n.add(y,m),E=n.sub(E,f),d=n.mul(p,b),f=n.mul(v,m),d=n.add(f,d),f=n.sub(y,d),d=n.add(y,d),h=n.mul(f,d),y=n.add(g,g),y=n.add(y,g),m=n.mul(p,m),b=n.mul(v,b),y=n.add(y,m),m=n.sub(g,m),m=n.mul(p,m),b=n.add(b,m),g=n.mul(y,b),h=n.add(h,g),g=n.mul(E,b),f=n.mul(w,f),f=n.sub(f,g),g=n.mul(w,y),d=n.mul(E,d),new e(f,h,d=n.add(d,g))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"wNAF",value:function(t){return p.wNAFCached(this,t,e.normalizeZ)}},{key:"multiplyUnsafe",value:function(r){var i=t.endo,o=t.n;OP("scalar",r,mx,o);var a=e.ZERO;if(r===mx)return a;if(this.is0()||r===wx)return this;if(!i||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,r,e.normalizeZ);for(var s=i.splitScalar(r),c=s.k1neg,u=s.k1,l=s.k2neg,f=s.k2,h=a,d=a,v=this;u>mx||f>mx;)u&wx&&(h=h.add(v)),f&wx&&(d=d.add(v)),v=v.double(),u>>=wx,f>>=wx;return c&&(h=h.negate()),l&&(d=d.negate()),d=new e(n.mul(d.px,i.beta),d.py,d.pz),h.add(d)}},{key:"multiply",value:function(r){var i,o,a=t.endo,s=t.n;if(OP("scalar",r,wx,s),a){var c=a.splitScalar(r),u=c.k1neg,l=c.k1,f=c.k2neg,h=c.k2,d=this.wNAF(l),v=d.p,g=d.f,y=this.wNAF(h),m=y.p,w=y.f;v=p.constTimeNegate(u,v),m=p.constTimeNegate(f,m),m=new e(n.mul(m.px,a.beta),m.py,m.pz),i=v.add(m),o=g.add(w)}else{var b=this.wNAF(r);i=b.p,o=b.f}return e.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(t,n,r){var i=e.BASE,o=function(e,t){return t!==mx&&t!==wx&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t)},a=o(this,n).add(o(t,r));return a.is0()?void 0:a}},{key:"toAffine",value:function(e){return l(this,e)}},{key:"isTorsionFree",value:function(){var n=t.h,r=t.isTorsionFree;if(n===wx)return!0;if(r)return r(e,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var n=t.h,r=t.clearCofactor;return n===wx?this:r?r(e,this):this.multiplyUnsafe(t.h)}},{key:"toRawBytes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return iP("isCompressed",t),this.assertValidity(),i(e,this,t)}},{key:"toHex",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return iP("isCompressed",e),aP(this.toRawBytes(e))}}],[{key:"fromAffine",value:function(t){var r=t||{},i=r.x,o=r.y;if(!t||!n.isValid(i)||!n.isValid(o))throw new Error("invalid affine point");if(t instanceof e)throw new Error("projective point not allowed");var a=function(e){return n.eql(e,n.ZERO)};return a(i)&&a(o)?e.ZERO:new e(i,o,n.ONE)}},{key:"normalizeZ",value:function(t){var r=n.invertBatch(t.map(function(e){return e.pz}));return t.map(function(e,t){return e.toAffine(r[t])}).map(e.fromAffine)}},{key:"fromHex",value:function(t){var n=e.fromAffine(o(EP("pointHex",t)));return n.assertValidity(),n}},{key:"fromPrivateKey",value:function(t){return e.BASE.multiply(c(t))}},{key:"msm",value:function(t,n){return ax(e,r,t,n)}}])}();h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);var d=t.nBitLength,p=function(e,t){return{constTimeNegate:ex,hasPrecomputes:function(e){return 1!==ox(e)},unsafeLadder:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,i=t;n>XP;)n&$P&&(r=r.add(i)),i=i.double(),n>>=$P;return r},precomputeWindow:function(e,n){for(var r=nx(n,t),i=r.windows,o=r.windowSize,a=[],s=e,c=s,u=0;u<i;u++){c=s,a.push(c);for(var l=1;l<o;l++)c=c.add(s),a.push(c);s=c.double()}return a},wNAF:function(n,r,i){for(var o=nx(n,t),a=o.windows,s=o.windowSize,c=e.ZERO,u=e.BASE,l=BigInt(Math.pow(2,n)-1),f=Math.pow(2,n),h=BigInt(n),d=0;d<a;d++){var p=d*s,v=Number(i&l);i>>=h,v>s&&(v-=f,i+=$P);var g=p,y=p+Math.abs(v)-1,m=d%2!=0,w=v<0;0===v?u=u.add(ex(m,r[g])):c=c.add(ex(w,r[y]))}return{p:c,f:u}},wNAFUnsafe:function(n,r,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO,a=nx(n,t),s=a.windows,c=a.windowSize,u=BigInt(Math.pow(2,n)-1),l=Math.pow(2,n),f=BigInt(n),h=0;h<s;h++){var d=h*c;if(i===XP)break;var p=Number(i&u);if(i>>=f,p>c&&(p-=l,i+=$P),0!==p){var v=r[d+Math.abs(p)-1];p<0&&(v=v.negate()),o=o.add(v)}}return o},getPrecomputes:function(e,t,n){var r=rx.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&rx.set(t,n(r))),r},wNAFCached:function(e,t,n){var r=ox(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe:function(e,t,n,r){var i=ox(e);return 1===i?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize:function(e,n){tx(n,t),ix.set(e,n),rx.delete(e)}}}(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:function(e){return SP(e,wx,t.n)}}}function kx(e){var t=function(e){var t=sx(e);return RP(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(a({lowS:!0},t))}(e),n=t.Fp,r=t.n,i=n.BYTES+1,o=2*n.BYTES+1;function s(e){return HP(e,r)}function c(e){return KP(e,r)}var u=Ex(a(a({},t),{},{toBytes:function(e,t,r){var i=t.toAffine(),o=n.toBytes(i.x),a=kP;return iP("isCompressed",r),r?a(Uint8Array.from([t.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes:function(e){var t=e.length,r=e[0],a=e.subarray(1);if(t!==i||2!==r&&3!==r){if(t===o&&4===r)return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))};throw new Error("invalid Point, expected length of "+i+", or uncompressed "+o+", got "+t)}var s=yP(a);if(!SP(s,wx,n.ORDER))throw new Error("Point is not on curve");var c,u=h(s);try{c=n.sqrt(u)}catch(YA){var l=YA instanceof Error?": "+YA.message:"";throw new Error("Point is not on curve"+l)}return!(1&~r)!==((c&wx)===wx)&&(c=n.neg(c)),{x:s,y:c}}})),l=u.ProjectivePoint,f=u.normPrivateKeyToScalar,h=u.weierstrassEquation,d=u.isWithinCurveOrder,p=function(e){return aP(wP(e,t.nByteLength))};function v(e){return e>r>>wx}var g=function(e,t,n){return yP(e.slice(t,n))},y=function(){function e(t,n,r){S(this,e),this.r=t,this.s=n,this.recovery=r,this.assertValidity()}return P(e,[{key:"assertValidity",value:function(){OP("r",this.r,wx,r),OP("s",this.s,wx,r)}},{key:"addRecoveryBit",value:function(t){return new e(this.r,this.s,t)}},{key:"recoverPublicKey",value:function(e){var r=this.r,i=this.s,o=this.recovery,a=E(EP("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var u=2===o||3===o?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=1&o?"03":"02",h=l.fromHex(f+p(u)),d=c(u),v=s(-a*d),g=s(i*d),y=l.BASE.multiplyAndAddUnsafe(h,v,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}},{key:"hasHighS",value:function(){return v(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return gP(this.toDERHex())}},{key:"toDERHex",value:function(){return yx.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return gP(this.toCompactHex())}},{key:"toCompactHex",value:function(){return p(this.r)+p(this.s)}}],[{key:"fromCompact",value:function(n){var r=t.nByteLength;return n=EP("compactSignature",n,2*r),new e(g(n,0,r),g(n,r,2*r))}},{key:"fromDER",value:function(t){var n=yx.toSig(EP("DER",t));return new e(n.r,n.s)}}])}(),m={isValidPrivateKey:function(e){try{return f(e),!0}catch(t){return!1}},normPrivateKeyToScalar:f,randomPrivateKey:function(){var e=QP(t.n);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.length,i=JP(t),o=QP(t);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);var a=HP(n?mP(e):yP(e),t-jP)+jP;return n?bP(a,i):wP(a,i)}(t.randomBytes(e),t.n)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function w(e){var t=nP(e),n="string"==typeof e,r=(t||n)&&e.length;return t?r===i||r===o:n?r===2*i||r===2*o:e instanceof l}var b=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");var n=yP(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},E=t.bits2int_modN||function(e){return s(b(e))},k=xP(t.nBitLength);function I(e){return OP("num < 2^"+t.nBitLength,e,mx,k),wP(e,t.nByteLength)}function O(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x;if(["recovered","canonical"].some(function(e){return e in i}))throw new Error("sign() legacy options not supported");var o=t.hash,a=t.randomBytes,u=i.lowS,h=i.prehash,p=i.extraEntropy;null==u&&(u=!0),e=EP("msgHash",e),dx(i),h&&(e=EP("prehashed msgHash",o(e)));var g=E(e),m=f(r),w=[I(m),I(g)];if(null!=p&&!1!==p){var k=!0===p?a(n.BYTES):p;w.push(EP("extraEntropy",k))}var S=kP.apply(void 0,w),O=g;return{seed:S,k2sig:function(e){var t=b(e);if(d(t)){var n=c(t),r=l.BASE.multiply(t).toAffine(),i=s(r.x);if(i!==mx){var o=s(n*s(O+i*m));if(o!==mx){var a=(r.x===i?0:2)|Number(r.y&wx),f=o;return u&&v(o)&&(f=function(e){return v(e)?s(-e):e}(o),a^=1),new y(i,f,a)}}}}}}var x={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(w(e))throw new Error("first arg must be private key");if(!w(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(f(e)).toRawBytes(n)},sign:function(e,n){var r=O(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:x),i=r.seed,o=r.k2sig,a=t;return TP(a.hash.outputLen,a.nByteLength,a.hmac)(i,o)},verify:function(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A,a=e;n=EP("msgHash",n),r=EP("publicKey",r);var u=o.lowS,f=o.prehash,h=o.format;if(dx(o),"strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw new Error("format must be compact or der");var d,p,v="string"==typeof a||nP(a),g=!v&&!h&&"object"==_(a)&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!v&&!g)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(g&&(d=new y(a.r,a.s)),v){try{"compact"!==h&&(d=y.fromDER(a))}catch(Vx){if(!(Vx instanceof yx.Err))throw Vx}!d&&"der"!==h&&(d=y.fromCompact(a))}p=l.fromHex(r)}catch(x){return!1}if(!d||u&&d.hasHighS())return!1;f&&(n=t.hash(n));var m=d,w=m.r,b=m.s,k=E(n),I=c(b),S=s(k*I),O=s(w*I),P=null===(i=l.BASE.multiplyAndAddUnsafe(p,S,O))||void 0===i?void 0:i.toAffine();return!!P&&s(P.x)===w},ProjectivePoint:l,Signature:y,utils:m}}function Ix(e){return{hash:e,hmac:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return FO(e,t,FS.apply(void 0,r))},randomBytes:GS}}BigInt(4);var Sx=YP(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"));function Ox(e){return e.includes(":")}function Px(e){return Ox(e)?e.split(":")[0]:e}!function(e,t){var n=function(t){return kx(a(a({},e),Ix(t)))};a(a({},n(t)),{},{create:n})}({a:Sx.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:Sx,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},XO);var xx={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function _x(e,t){var n=xx[e];return{message:n.message,code:n.code}}function Ax(e,t){return!!Array.isArray(e)}function Tx(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}var Nx="error",Rx="".concat("wc","@2:").concat("universal_provider",":"),Bx="https://rpc.walletconnect.org/v1/",Cx="generic",Ux="".concat(Bx,"bundler"),jx="default_chain_changed";function Lx(){}function Dx(e){return null==e||"object"!=_(e)&&"function"!=typeof e}function qx(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Mx(e){return"object"==_(e)&&null!==e}function zx(e){return Object.getOwnPropertySymbols(e).filter(function(t){return Object.prototype.propertyIsEnumerable.call(e,t)})}function Hx(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var Vx="[object RegExp]",Fx="[object String]",Kx="[object Number]",Wx="[object Boolean]",Gx="[object Arguments]",Zx="[object Symbol]",Yx="[object Date]",Jx="[object Map]",Qx="[object Set]",Xx="[object Array]",$x="[object ArrayBuffer]",e_="[object Object]",t_="[object DataView]",n_="[object Uint8Array]",r_="[object Uint8ClampedArray]",i_="[object Uint16Array]",o_="[object Uint32Array]",a_="[object Int8Array]",s_="[object Int16Array]",c_="[object Int32Array]",u_="[object Float32Array]",l_="[object Float64Array]";function f_(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,a=null==o?void 0:o(e,t,n,i);if(null!=a)return a;if(Dx(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){var s=new Array(e.length);i.set(e,s);for(var c=0;c<e.length;c++)s[c]=f_(e[c],c,n,i,o);return Object.hasOwn(e,"index")&&(s.index=e.index),Object.hasOwn(e,"input")&&(s.input=e.input),s}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){var l=new RegExp(e.source,e.flags);return l.lastIndex=e.lastIndex,l}if(e instanceof Map){var f=new Map;i.set(e,f);var h,d=u(e);try{for(d.s();!(h=d.n()).done;){var p=r(h.value,2),v=p[0],g=p[1];f.set(v,f_(g,v,n,i,o))}}catch(A){d.e(A)}finally{d.f()}return f}if(e instanceof Set){var y=new Set;i.set(e,y);var m,w=u(e);try{for(w.s();!(m=w.n()).done;){var b=m.value;y.add(f_(b,void 0,n,i,o))}}catch(A){w.e(A)}finally{w.f()}return y}if(("undefined"==typeof Buffer?"undefined":_(Buffer))<"u"&&Buffer.isBuffer(e))return e.subarray();if(qx(e)){var E=new(Object.getPrototypeOf(e).constructor)(e.length);i.set(e,E);for(var k=0;k<e.length;k++)E[k]=f_(e[k],k,n,i,o);return E}if(e instanceof ArrayBuffer||("undefined"==typeof SharedArrayBuffer?"undefined":_(SharedArrayBuffer))<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){var I=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,I),h_(I,e,n,i,o),I}if(("undefined"==typeof File?"undefined":_(File))<"u"&&e instanceof File){var S=new File([e],e.name,{type:e.type});return i.set(e,S),h_(S,e,n,i,o),S}if(e instanceof Blob){var O=new Blob([e],{type:e.type});return i.set(e,O),h_(O,e,n,i,o),O}if(e instanceof Error){var P=new e.constructor;return i.set(e,P),P.message=e.message,P.name=e.name,P.stack=e.stack,P.cause=e.cause,h_(P,e,n,i,o),P}if("object"==_(e)&&function(e){switch(Hx(e)){case Gx:case Xx:case $x:case t_:case Wx:case Yx:case u_:case l_:case a_:case s_:case c_:case Jx:case Kx:case e_:case Vx:case Qx:case Fx:case Zx:case n_:case r_:case i_:case o_:return!0;default:return!1}}(e)){var x=Object.create(Object.getPrototypeOf(e));return i.set(e,x),h_(x,e,n,i,o),x}return e}function h_(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=[].concat(l(Object.keys(t)),l(zx(t))),a=0;a<o.length;a++){var s=o[a],c=Object.getOwnPropertyDescriptor(e,s);(null==c||c.writable)&&(e[s]=f_(t[s],s,n,r,i))}}function d_(e,t){return function(e,t){return f_(e,void 0,e,new Map,t)}(e,function(t,n,r,i){if("object"==_(e))switch(Object.prototype.toString.call(e)){case Kx:case Fx:case Wx:var o=new e.constructor(null==e?void 0:e.valueOf());return h_(o,e),o;case Gx:var a={};return h_(a,e),a.length=e.length,a[Symbol.iterator]=e[Symbol.iterator],a;default:return}})}function p_(e){return d_(e)}function v_(e){return null!==e&&"object"==_(e)&&"[object Arguments]"===Hx(e)}function g_(e){return qx(e)}function y_(e){if("object"!=_(e)||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){var t,n=e[Symbol.toStringTag];return!(null==n||null===(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))||void 0===t||!t.writable)&&e.toString()==="[object ".concat(n,"]")}for(var r=e;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}function m_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=n.slice(0,-1),o=n[n.length-1],a=e,s=0;s<i.length;s++){a=w_(a,i[s],o,new Map)}return a}function w_(e,t,n,r){if(Dx(e)&&(e=Object(e)),null==t||"object"!=_(t))return e;if(r.has(t))return function(e){if(Dx(e))return e;if(Array.isArray(e)||qx(e)||e instanceof ArrayBuffer||("undefined"==typeof SharedArrayBuffer?"undefined":_(SharedArrayBuffer))<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);var t=Object.getPrototypeOf(e),n=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new n(e);if(e instanceof RegExp){var r=new n(e);return r.lastIndex=e.lastIndex,r}if(e instanceof DataView)return new n(e.buffer.slice(0));if(e instanceof Error){var i=new n(e.message);return i.stack=e.stack,i.name=e.name,i.cause=e.cause,i}if(("undefined"==typeof File?"undefined":_(File))<"u"&&e instanceof File)return new n([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==_(e)){var o=Object.create(t);return Object.assign(o,e)}return e}(r.get(t));if(r.set(t,e),Array.isArray(t)){t=t.slice();for(var i=0;i<t.length;i++){var o;t[i]=null!==(o=t[i])&&void 0!==o?o:void 0}}for(var s=[].concat(l(Object.keys(t)),l(zx(t))),c=0;c<s.length;c++){var u=s[c],f=t[u],h=e[u];if(v_(f)&&(f=a({},f)),v_(h)&&(h=a({},h)),("undefined"==typeof Buffer?"undefined":_(Buffer))<"u"&&Buffer.isBuffer(f)&&(f=p_(f)),Array.isArray(f))if("object"==_(h)&&null!=h){for(var d=[],p=Reflect.ownKeys(h),v=0;v<p.length;v++){var g=p[v];d[g]=h[g]}h=d}else h=[];var y=n(h,f,u,e,t,r);null!=y?e[u]=y:Array.isArray(f)||Mx(h)&&Mx(f)?e[u]=w_(h,f,n,r):null==h&&y_(f)?e[u]=w_({},f,n,r):null==h&&g_(f)?e[u]=p_(f):(void 0===h||void 0!==f)&&(e[u]=f)}return e}function b_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return m_.apply(void 0,[e].concat(n,[Lx]))}var E_=Object.defineProperty,k_=Object.defineProperties,I_=Object.getOwnPropertyDescriptors,S_=Object.getOwnPropertySymbols,O_=Object.prototype.hasOwnProperty,P_=Object.prototype.propertyIsEnumerable,x_=function(e,t,n){return t in e?E_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},__=function(e,t){for(var n in t||(t={}))O_.call(t,n)&&x_(e,n,t[n]);if(S_){var r,i=u(S_(t));try{for(i.s();!(r=i.n()).done;){n=r.value;P_.call(t,n)&&x_(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},A_=function(e,t){return k_(e,I_(t))};function T_(e,t,n){var r,i=xS(e);return(null==(r=t.rpcMap)?void 0:r[i.reference])||"".concat(Bx,"?chainId=").concat(i.namespace,":").concat(i.reference,"&projectId=").concat(n)}function N_(e){return e.includes(":")?e.split(":")[1]:e}function R_(e){return e.map(function(e){return"".concat(e.split(":")[0],":").concat(e.split(":")[1])})}function B_(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b_(C_(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),C_(e))}function C_(e){var t,n,i,o,a,s={};if(!Tx(e))return s;for(var c=0,u=Object.entries(e);c<u.length;c++){var l=r(u[c],2),f=l[0],h=l[1],d=Ox(f)?[f]:h.chains,p=h.methods||[],v=h.events||[],g=h.rpcMap||{},y=Px(f);s[y]=A_(__(__({},s[y]),h),{chains:AS(d,null==(t=s[y])?void 0:t.chains),methods:AS(p,null==(n=s[y])?void 0:n.methods),events:AS(v,null==(i=s[y])?void 0:i.events)}),(Tx(g)||Tx((null==(o=s[y])?void 0:o.rpcMap)||{}))&&(s[y].rpcMap=__(__({},g),null==(a=s[y])?void 0:a.rpcMap))}return s}function U_(e){return e.includes(":")?e.split(":")[2]:e}function j_(e){for(var t={},n=0,i=Object.entries(e);n<i.length;n++){var o=r(i[n],2),a=o[0],s=o[1],c=s.methods||[],u=s.events||[],l=s.accounts||[],f=Ox(a)?[a]:s.chains?s.chains:R_(s.accounts);t[a]={chains:f,methods:c,events:u,accounts:l}}return t}function L_(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}var D_={},q_=function(e){return D_[e]},M_=function(e,t){D_[e]=t},z_=Object.defineProperty,H_=function(e,t,n){return function(e,t,n){return t in e?z_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},V_=function(){return P(function e(t){S(this,e),H_(this,"name","polkadot"),H_(this,"client"),H_(this,"httpProviders"),H_(this,"events"),H_(this,"namespace"),H_(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(e))}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t&&t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]})||[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r,i=N_(n);t[i]=e.createHttpProvider(i,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}}])}(),F_=Object.defineProperty,K_=Object.defineProperties,W_=Object.getOwnPropertyDescriptors,G_=Object.getOwnPropertySymbols,Z_=Object.prototype.hasOwnProperty,Y_=Object.prototype.propertyIsEnumerable,J_=function(e,t,n){return t in e?F_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Q_=function(e,t){for(var n in t||(t={}))Z_.call(t,n)&&J_(e,n,t[n]);if(G_){var r,i=u(G_(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Y_.call(t,n)&&J_(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},X_=function(e,t){return K_(e,W_(t))},$_=function(e,t,n){return J_(e,"symbol"!=_(t)?t+"":t,n)},eA=function(){return P(function e(t){S(this,e),$_(this,"name","eip155"),$_(this,"client"),$_(this,"chainId"),$_(this,"namespace"),$_(this,"httpProviders"),$_(this,"events"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())},[{key:"request",value:(i=g(d().m(function e(t){var n,r;return d().w(function(e){for(;;)switch(e.n){case 0:n=t.request.method,e.n="eth_requestAccounts"===n?1:"eth_accounts"===n?2:"wallet_switchEthereumChain"===n?3:"eth_chainId"===n?5:"wallet_getCapabilities"===n?6:"wallet_getCallsStatus"===n?8:10;break;case 1:case 2:return e.a(2,this.getAccounts());case 3:return e.n=4,this.handleSwitchChain(t);case 4:return e.a(2,e.v);case 5:return e.a(2,parseInt(this.getDefaultChain()));case 6:return e.n=7,this.getCapabilities(t);case 7:return e.a(2,e.v);case 8:return e.n=9,this.getCallStatus(t);case 9:return e.a(2,e.v);case 10:if(!this.namespace.methods.includes(t.request.method)){e.n=12;break}return e.n=11,this.client.request(t);case 11:r=e.v,e.n=13;break;case 12:r=this.getHttpProvider().request(t.request);case 13:return e.a(2,r)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(jx,"".concat(this.name,":").concat(e))}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"createHttpProvider",value:function(e,t){var n=t||T_("".concat(this.name,":").concat(e),this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r,i=parseInt(N_(n));t[i]=e.createHttpProvider(i,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"getHttpProvider",value:function(){var e=this.chainId,t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"handleSwitchChain",value:(r=g(d().m(function e(t){var n,r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:if(i=(i=t.request.params?null==(n=t.request.params[0])?void 0:n.chainId:"0x0").startsWith("0x")?i:"0x".concat(i),o=parseInt(i,16),!this.isChainApproved(o)){e.n=1;break}this.setDefaultChain("".concat(o)),e.n=4;break;case 1:if(!this.namespace.methods.includes("wallet_switchEthereumChain")){e.n=3;break}return e.n=2,this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:i}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]});case 2:this.setDefaultChain("".concat(o)),e.n=4;break;case 3:throw new Error("Failed to switch to chain 'eip155:".concat(o,"'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method."));case 4:return e.a(2,null)}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"isChainApproved",value:function(e){return this.namespace.chains.includes("".concat(this.name,":").concat(e))}},{key:"getCapabilities",value:(n=g(d().m(function e(t){var n,r,i,o,a,c,u,l,f,h,p,v;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(c=null==(r=null==(n=t.request)?void 0:n.params)?void 0:r[0],u=(null==(o=null==(i=t.request)?void 0:i.params)?void 0:o[1])||[],l="".concat(c).concat(u.join(",")),c){e.n=1;break}throw new Error("Missing address parameter in `wallet_getCapabilities` request");case 1:if(f=this.client.session.get(t.topic),null==(h=(null==(a=null==f?void 0:f.sessionProperties)?void 0:a.capabilities)||{})||!h[l]){e.n=2;break}return e.a(2,null==h?void 0:h[l]);case 2:return e.n=3,this.client.request(t);case 3:return p=e.v,e.p=4,e.n=5,this.client.session.update(t.topic,{sessionProperties:X_(Q_({},f.sessionProperties||{}),{capabilities:X_(Q_({},h||{}),s({},l,p))})});case 5:e.n=7;break;case 6:e.p=6,v=e.v,console.warn("Failed to update session with capabilities",v);case 7:return e.a(2,p)}},e,this,[[4,6]])})),function(e){return n.apply(this,arguments)})},{key:"getCallStatus",value:(t=g(d().m(function e(t){var n,r,i,o,a,s,c,u;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=this.client.session.get(t.topic),!(o=null==(n=i.sessionProperties)?void 0:n.bundler_name)){e.n=4;break}return a=this.getBundlerUrl(t.chainId,o),e.p=1,e.n=2,this.getUserOperationReceipt(a,t);case 2:return e.a(2,e.v);case 3:e.p=3,c=e.v,console.warn("Failed to fetch call status from bundler",c,a);case 4:if(!(s=null==(r=i.sessionProperties)?void 0:r.bundler_url)){e.n=8;break}return e.p=5,e.n=6,this.getUserOperationReceipt(s,t);case 6:return e.a(2,e.v);case 7:e.p=7,u=e.v,console.warn("Failed to fetch call status from custom bundler",u,s);case 8:if(!this.namespace.methods.includes(t.request.method)){e.n=10;break}return e.n=9,this.client.request(t);case 9:return e.a(2,e.v);case 10:throw new Error("Fetching call status not approved by the wallet.");case 11:return e.a(2)}},e,this,[[5,7],[1,3]])})),function(e){return t.apply(this,arguments)})},{key:"getUserOperationReceipt",value:(e=g(d().m(function e(t,n){var r,i,o;return d().w(function(e){for(;;)switch(e.n){case 0:return i=new URL(t),e.n=1,fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Lf("eth_getUserOperationReceipt",[null==(r=n.request.params)?void 0:r[0]]))});case 1:if((o=e.v).ok){e.n=2;break}throw new Error("Failed to fetch user operation receipt - ".concat(o.status));case 2:return e.n=3,o.json();case 3:return e.a(2,e.v)}},e)})),function(t,n){return e.apply(this,arguments)})},{key:"getBundlerUrl",value:function(e,t){return"".concat(Ux,"?projectId=").concat(this.client.core.projectId,"&chainId=").concat(e,"&bundler=").concat(t)}}]);var e,t,n,r,i}(),tA=Object.defineProperty,nA=function(e,t,n){return function(e,t,n){return t in e?tA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},rA=function(){return P(function e(t){S(this,e),nA(this,"name","solana"),nA(this,"client"),nA(this,"httpProviders"),nA(this,"events"),nA(this,"namespace"),nA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(e))}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r,i=N_(n);t[i]=e.createHttpProvider(i,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}}])}(),iA=Object.defineProperty,oA=function(e,t,n){return function(e,t,n){return t in e?iA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},aA=function(){return P(function e(t){S(this,e),oA(this,"name","cosmos"),oA(this,"client"),oA(this,"httpProviders"),oA(this,"events"),oA(this,"namespace"),oA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(this.chainId))}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r,i=N_(n);t[i]=e.createHttpProvider(i,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}}])}(),sA=Object.defineProperty,cA=function(e,t,n){return function(e,t,n){return t in e?sA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},uA=function(){return P(function e(t){S(this,e),cA(this,"name","algorand"),cA(this,"client"),cA(this,"httpProviders"),cA(this,"events"),cA(this,"namespace"),cA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){if(!this.httpProviders[e]){var n=t||T_("".concat(this.name,":").concat(e),this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(this.chainId))}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r;t[n]=e.createHttpProvider(n,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace,this.client.core.projectId);return _(n)>"u"?void 0:new Yf(new PS(n,q_("disableProviderPing")))}}])}(),lA=Object.defineProperty,fA=function(e,t,n){return function(e,t,n){return t in e?lA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},hA=function(){return P(function e(t){S(this,e),fA(this,"name","cip34"),fA(this,"client"),fA(this,"httpProviders"),fA(this,"events"),fA(this,"namespace"),fA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(this.chainId))}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r=e.getCardanoRPCUrl(n),i=N_(n);t[i]=e.createHttpProvider(i,r)}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"getCardanoRPCUrl",value:function(e){var t=this.namespace.rpcMap;if(t)return t[e]}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}}])}(),dA=Object.defineProperty,pA=function(e,t,n){return function(e,t,n){return t in e?dA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},vA=function(){return P(function e(t){S(this,e),pA(this,"name","elrond"),pA(this,"client"),pA(this,"httpProviders"),pA(this,"events"),pA(this,"namespace"),pA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(e))}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r,i=N_(n);t[i]=e.createHttpProvider(i,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}}])}(),gA=Object.defineProperty,yA=function(e,t,n){return function(e,t,n){return t in e?gA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},mA=function(){return P(function e(t){S(this,e),yA(this,"name","multiversx"),yA(this,"client"),yA(this,"httpProviders"),yA(this,"events"),yA(this,"namespace"),yA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(e))}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r,i=N_(n);t[i]=e.createHttpProvider(i,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}}])}(),wA=Object.defineProperty,bA=function(e,t,n){return function(e,t,n){return t in e?wA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},EA=function(){return P(function e(t){S(this,e),bA(this,"name","near"),bA(this,"client"),bA(this,"httpProviders"),bA(this,"events"),bA(this,"namespace"),bA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){if(this.chainId=e,!this.httpProviders[e]){var n=t||T_("".concat(this.name,":").concat(e),this.namespace);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));this.setHttpProvider(e,n)}this.events.emit(jx,"".concat(this.name,":").concat(this.chainId))}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t&&t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]})||[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){var r;t[n]=e.createHttpProvider(n,null==(r=e.namespace.rpcMap)?void 0:r[n])}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace);return _(n)>"u"?void 0:new Yf(new PS(n,q_("disableProviderPing")))}}])}(),kA=Object.defineProperty,IA=function(e,t,n){return function(e,t,n){return t in e?kA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},SA=function(){return P(function e(t){S(this,e),IA(this,"name","tezos"),IA(this,"client"),IA(this,"httpProviders"),IA(this,"events"),IA(this,"namespace"),IA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace=Object.assign(this.namespace,e)}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}},{key:"setDefaultChain",value:function(e,t){if(this.chainId=e,!this.httpProviders[e]){var n=t||T_("".concat(this.name,":").concat(e),this.namespace);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));this.setHttpProvider(e,n)}this.events.emit(jx,"".concat(this.name,":").concat(this.chainId))}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t&&t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]})||[]}},{key:"createHttpProviders",value:function(){var e=this,t={};return this.namespace.chains.forEach(function(n){t[n]=e.createHttpProvider(n)}),t}},{key:"getHttpProvider",value:function(){var e="".concat(this.name,":").concat(this.chainId),t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace);return _(n)>"u"?void 0:new Yf(new PS(n))}}])}(),OA=Object.defineProperty,PA=function(e,t,n){return function(e,t,n){return t in e?OA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=_(t)?t+"":t,n)},xA=function(){return P(function e(t){S(this,e),PA(this,"name",Cx),PA(this,"client"),PA(this,"httpProviders"),PA(this,"events"),PA(this,"namespace"),PA(this,"chainId"),this.namespace=t.namespace,this.events=q_("events"),this.client=q_("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()},[{key:"updateNamespace",value:function(e){this.namespace.chains=l(new Set((this.namespace.chains||[]).concat(e.chains||[]))),this.namespace.accounts=l(new Set((this.namespace.accounts||[]).concat(e.accounts||[]))),this.namespace.methods=l(new Set((this.namespace.methods||[]).concat(e.methods||[]))),this.namespace.events=l(new Set((this.namespace.events||[]).concat(e.events||[]))),this.httpProviders=this.createHttpProviders()}},{key:"requestAccounts",value:function(){return this.getAccounts()}},{key:"request",value:function(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}},{key:"setDefaultChain",value:function(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,"".concat(this.name,":").concat(e))}},{key:"getDefaultChain",value:function(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;var e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}},{key:"getAccounts",value:function(){var e=this,t=this.namespace.accounts;return t?l(new Set(t.filter(function(t){return t.split(":")[1]===e.chainId.toString()}).map(function(e){return e.split(":")[2]}))):[]}},{key:"createHttpProviders",value:function(){var e,t,n=this,r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(function(e){var t=xS(e);r["".concat(t.namespace,":").concat(t.reference)]=n.createHttpProvider(e)}),r}},{key:"getHttpProvider",value:function(e){var t=this.httpProviders[e];if(_(t)>"u")throw new Error("JSON-RPC provider for ".concat(e," not found"));return t}},{key:"setHttpProvider",value:function(e,t){var n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}},{key:"createHttpProvider",value:function(e,t){var n=t||T_(e,this.namespace,this.client.core.projectId);if(!n)throw new Error("No RPC url provided for chainId: ".concat(e));return new Yf(new PS(n,q_("disableProviderPing")))}}])}(),_A=Object.defineProperty,AA=Object.defineProperties,TA=Object.getOwnPropertyDescriptors,NA=Object.getOwnPropertySymbols,RA=Object.prototype.hasOwnProperty,BA=Object.prototype.propertyIsEnumerable,CA=function(e,t,n){return t in e?_A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},UA=function(e,t){for(var n in t||(t={}))RA.call(t,n)&&CA(e,n,t[n]);if(NA){var r,i=u(NA(t));try{for(i.s();!(r=i.n()).done;){n=r.value;BA.call(t,n)&&CA(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},jA=function(e,t){return AA(e,TA(t))},LA=function(e,t,n){return CA(e,"symbol"!=_(t)?t+"":t,n)},DA=function(){function e(t){S(this,e),LA(this,"client"),LA(this,"namespaces"),LA(this,"optionalNamespaces"),LA(this,"sessionProperties"),LA(this,"scopedProperties"),LA(this,"events",new R),LA(this,"rpcProviders",{}),LA(this,"session"),LA(this,"providerOpts"),LA(this,"logger"),LA(this,"uri"),LA(this,"disableProviderPing",!1),this.providerOpts=t,this.logger=_(null==t?void 0:t.logger)<"u"&&"string"!=typeof(null==t?void 0:t.logger)?t.logger:Xe(gt({level:(null==t?void 0:t.logger)||Nx})),this.disableProviderPing=(null==t?void 0:t.disableProviderPing)||!1}return P(e,[{key:"request",value:(I=g(d().m(function e(t,n,i){var o,a,s,c;return d().w(function(e){for(;;)switch(e.n){case 0:if(o=this.validateChain(n),a=r(o,2),s=a[0],c=a[1],this.session){e.n=1;break}throw new Error("Please call connect() before request()");case 1:return e.n=2,this.getProvider(s).request({request:UA({},t),chainId:"".concat(s,":").concat(c),topic:this.session.topic,expiry:i});case 2:return e.a(2,e.v)}},e,this)})),function(e,t,n){return I.apply(this,arguments)})},{key:"sendAsync",value:function(e,t,n,r){var i=(new Date).getTime();this.request(e,n,r).then(function(e){return t(null,Df(i,e))}).catch(function(e){return t(e,void 0)})}},{key:"enable",value:(k=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.client){e.n=1;break}throw new Error("Sign Client not initialized");case 1:if(this.session){e.n=2;break}return e.n=2,this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});case 2:return e.n=3,this.requestAccounts();case 3:return e.a(2,e.v)}},e,this)})),function(){return k.apply(this,arguments)})},{key:"disconnect",value:(E=g(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:if(this.session){e.n=1;break}throw new Error("Please call connect() before enable()");case 1:return e.n=2,this.client.disconnect({topic:null==(t=this.session)?void 0:t.topic,reason:_x("USER_DISCONNECTED")});case 2:return e.n=3,this.cleanup();case 3:return e.a(2)}},e,this)})),function(){return E.apply(this,arguments)})},{key:"connect",value:(b=g(d().m(function e(t){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.client){e.n=1;break}throw new Error("Sign Client not initialized");case 1:return this.setNamespaces(t),e.n=2,this.cleanupPendingPairings();case 2:if(t.skipPairing){e.n=4;break}return e.n=3,this.pair(t.pairingTopic);case 3:return e.a(2,e.v);case 4:return e.a(2)}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"authenticate",value:(w=g(d().m(function e(t,n){var r,i,o,a,s;return d().w(function(e){for(;;)switch(e.n){case 0:if(this.client){e.n=1;break}throw new Error("Sign Client not initialized");case 1:return this.setNamespaces(t),e.n=2,this.cleanupPendingPairings();case 2:return e.n=3,this.client.authenticate(t,n);case 3:return r=e.v,i=r.uri,o=r.response,i&&(this.uri=i,this.events.emit("display_uri",i)),e.n=4,o();case 4:if(a=e.v,this.session=a.session,!this.session){e.n=6;break}return s=j_(this.session.namespaces),this.namespaces=B_(this.namespaces,s),e.n=5,this.persist("namespaces",this.namespaces);case 5:this.onConnect();case 6:return e.a(2,a)}},e,this)})),function(e,t){return w.apply(this,arguments)})},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"isWalletConnect",get:function(){return!0}},{key:"pair",value:(m=g(d().m(function e(t){var n,r,i,o,a;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});case 1:return n=e.v,r=n.uri,i=n.approval,r&&(this.uri=r,this.events.emit("display_uri",r)),e.n=2,i();case 2:return o=e.v,this.session=o,a=j_(o.namespaces),this.namespaces=B_(this.namespaces,a),e.n=3,this.persist("namespaces",this.namespaces);case 3:return e.n=4,this.persist("optionalNamespaces",this.optionalNamespaces);case 4:return this.onConnect(),e.a(2,this.session)}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"setDefaultChain",value:function(e,t){try{if(!this.session)return;var n=r(this.validateChain(e),2),i=n[0],o=n[1],a=this.getProvider(i);a.name===Cx?a.setDefaultChain("".concat(i,":").concat(o),t):a.setDefaultChain(o,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}},{key:"cleanupPendingPairings",value:(y=g(d().m(function e(){var t,n,r,i,o,a,s=arguments;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},this.logger.info("Cleaning up inactive pairings..."),!Ax(n=this.client.pairing.getAll())){e.n=9;break}r=u(n),e.p=1,r.s();case 2:if((i=r.n()).done){e.n=5;break}if(o=i.value,!t.deletePairings){e.n=3;break}this.client.core.expirer.set(o.topic,0),e.n=4;break;case 3:return e.n=4,this.client.core.relayer.subscriber.unsubscribe(o.topic);case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,a=e.v,r.e(a);case 7:return e.p=7,r.f(),e.f(7);case 8:this.logger.info("Inactive pairings cleared: ".concat(n.length));case 9:return e.a(2)}},e,this,[[1,6,7,8]])})),function(){return y.apply(this,arguments)})},{key:"abortPairingAttempt",value:function(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}},{key:"checkStorage",value:(v=g(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.getFromStore("namespaces");case 1:if(t=e.v){e.n=2;break}t={};case 2:return this.namespaces=t,e.n=3,this.getFromStore("optionalNamespaces");case 3:if(n=e.v){e.n=4;break}n={};case 4:this.optionalNamespaces=n,this.session&&this.createProviders();case 5:return e.a(2)}},e,this)})),function(){return v.apply(this,arguments)})},{key:"initialize",value:(p=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return this.logger.trace("Initialized"),e.n=1,this.createClient();case 1:return e.n=2,this.checkStorage();case 2:this.registerEventListeners();case 3:return e.a(2)}},e,this)})),function(){return p.apply(this,arguments)})},{key:"createClient",value:(h=g(d().m(function e(){var t,n,r,i,o;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=this.providerOpts.client){e.n=2;break}return e.n=1,hS.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Nx,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled});case 1:i=e.v;case 2:if(this.client=i,!this.providerOpts.session){e.n=6;break}e.p=3,this.session=this.client.session.get(this.providerOpts.session.topic),e.n=5;break;case 4:throw e.p=4,o=e.v,this.logger.error("Failed to get session",o),new Error("The provided session: ".concat(null==(n=null==(t=this.providerOpts)?void 0:t.session)?void 0:n.topic," doesn't exist in the Sign client"));case 5:e.n=7;break;case 6:r=this.client.session.getAll(),this.session=r[0];case 7:this.logger.trace("SignClient Initialized");case 8:return e.a(2)}},e,this,[[3,4]])})),function(){return h.apply(this,arguments)})},{key:"createProviders",value:function(){var e=this;if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");var t=l(new Set(Object.keys(this.session.namespaces).map(function(e){return Px(e)})));M_("client",this.client),M_("events",this.events),M_("disableProviderPing",this.disableProviderPing),t.forEach(function(t){if(e.session){var n=function(e,t){var n=Object.keys(t.namespaces).filter(function(t){return t.includes(e)});if(!n.length)return[];var r=[];return n.forEach(function(e){var n=t.namespaces[e].accounts;r.push.apply(r,l(n))}),r}(t,e.session),r=R_(n),i=B_(e.namespaces,e.optionalNamespaces),o=jA(UA({},i[t]),{accounts:n,chains:r});switch(t){case"eip155":e.rpcProviders[t]=new eA({namespace:o});break;case"algorand":e.rpcProviders[t]=new uA({namespace:o});break;case"solana":e.rpcProviders[t]=new rA({namespace:o});break;case"cosmos":e.rpcProviders[t]=new aA({namespace:o});break;case"polkadot":e.rpcProviders[t]=new V_({namespace:o});break;case"cip34":e.rpcProviders[t]=new hA({namespace:o});break;case"elrond":e.rpcProviders[t]=new vA({namespace:o});break;case"multiversx":e.rpcProviders[t]=new mA({namespace:o});break;case"near":e.rpcProviders[t]=new EA({namespace:o});break;case"tezos":e.rpcProviders[t]=new SA({namespace:o});break;default:e.rpcProviders[Cx]?e.rpcProviders[Cx].updateNamespace(o):e.rpcProviders[Cx]=new xA({namespace:o})}}})}},{key:"registerEventListeners",value:function(){var e=this;if(_(this.client)>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",function(t){var n;t.topic===(null==(n=e.session)?void 0:n.topic)&&e.events.emit("session_ping",t)}),this.client.on("session_event",function(t){var n,r=t.params;if(t.topic===(null==(n=e.session)?void 0:n.topic)){var i=r.event;if("accountsChanged"===i.name){var o=i.data;o&&Ax(o)&&e.events.emit("accountsChanged",o.map(U_))}else if("chainChanged"===i.name){var a=r.chainId,s=r.event.data,c=Px(a),u=L_(a)!==L_(s)?"".concat(c,":").concat(L_(s)):a;e.onChainChanged(u)}else e.events.emit(i.name,i.data);e.events.emit("session_event",t)}}),this.client.on("session_update",function(t){var n,r,i=t.topic,o=t.params;if(i===(null==(n=e.session)?void 0:n.topic)){var a=o.namespaces,s=null==(r=e.client)?void 0:r.session.get(i);e.session=jA(UA({},s),{namespaces:a}),e.onSessionUpdate(),e.events.emit("session_update",{topic:i,params:o})}}),this.client.on("session_delete",function(){var t=g(d().m(function t(n){var r;return d().w(function(t){for(;;)switch(t.n){case 0:if(!(n.topic===(null==(r=e.session)?void 0:r.topic))){t.n=2;break}return t.n=1,e.cleanup();case 1:e.events.emit("session_delete",n),e.events.emit("disconnect",jA(UA({},_x("USER_DISCONNECTED")),{data:n.topic}));case 2:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),this.on(jx,function(t){e.onChainChanged(t,!0)})}},{key:"getProvider",value:function(e){return this.rpcProviders[e]||this.rpcProviders[Cx]}},{key:"onSessionUpdate",value:function(){var e=this;Object.keys(this.rpcProviders).forEach(function(t){var n;e.getProvider(t).updateNamespace(null==(n=e.session)?void 0:n.namespaces[t])})}},{key:"setNamespaces",value:function(e){var t=e.namespaces,n=void 0===t?{}:t,r=e.optionalNamespaces,i=void 0===r?{}:r,o=e.sessionProperties,a=e.scopedProperties;this.optionalNamespaces=B_(n,i),this.sessionProperties=o,this.scopedProperties=a}},{key:"validateChain",value:function(e){var t=r((null==e?void 0:e.split(":"))||["",""],2),n=t[0],i=t[1];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,i];if(n&&!Object.keys(this.namespaces||{}).map(function(e){return Px(e)}).includes(n))throw new Error("Namespace '".concat(n,"' is not configured. Please call connect() first with namespace config."));if(n&&i)return[n,i];var o=Px(Object.keys(this.namespaces)[0]);return[o,this.rpcProviders[o].getDefaultChain()]}},{key:"requestAccounts",value:(f=g(d().m(function e(){var t,n,i;return d().w(function(e){for(;;)switch(e.n){case 0:return t=this.validateChain(),n=r(t,1),i=n[0],e.n=1,this.getProvider(i).requestAccounts();case 1:return e.a(2,e.v)}},e,this)})),function(){return f.apply(this,arguments)})},{key:"onChainChanged",value:(c=g(d().m(function e(t){var n,i,o,a,s,c,u=arguments;return d().w(function(e){for(;;)switch(e.n){case 0:if(n=u.length>1&&void 0!==u[1]&&u[1],this.namespaces){e.n=1;break}return e.a(2);case 1:if(i=this.validateChain(t),o=r(i,2),a=o[0],s=o[1]){e.n=2;break}return e.a(2);case 2:return this.updateNamespaceChain(a,s),this.events.emit("chainChanged",s),c=this.getProvider(a).getDefaultChain(),n||this.getProvider(a).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:a,previousChainId:c,newChainId:t}),e.n=3,this.persist("namespaces",this.namespaces);case 3:return e.a(2)}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"emitAccountsChangedOnChainChange",value:function(e){var t,n,r=e.namespace,i=e.previousChainId,o=e.newChainId;try{if(i===o)return;var a=null==(n=null==(t=this.session)?void 0:t.namespaces[r])?void 0:n.accounts;if(!a)return;var s=a.filter(function(e){return e.includes("".concat(o,":"))}).map(U_);if(!Ax(s))return;this.events.emit("accountsChanged",s)}catch(a){this.logger.warn("Failed to emit accountsChanged on chain change",a)}}},{key:"updateNamespaceChain",value:function(e,t){if(this.namespaces){var n=this.namespaces[e]?e:"".concat(e,":").concat(t),r={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=r}}},{key:"onConnect",value:function(){this.createProviders(),this.events.emit("connect",{session:this.session})}},{key:"cleanup",value:(s=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:return this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,e.n=1,this.deleteFromStore("namespaces");case 1:return e.n=2,this.deleteFromStore("optionalNamespaces");case 2:return e.n=3,this.deleteFromStore("sessionProperties");case 3:return this.session=void 0,e.n=4,this.cleanupPendingPairings({deletePairings:!0});case 4:return e.n=5,this.cleanupStorage();case 5:return e.a(2)}},e,this)})),function(){return s.apply(this,arguments)})},{key:"persist",value:(a=g(d().m(function e(t,n){var r,i;return d().w(function(e){for(;;)switch(e.n){case 0:return i=(null==(r=this.session)?void 0:r.topic)||"",e.n=1,this.client.core.storage.setItem("".concat(Rx,"/").concat(t).concat(i),n);case 1:return e.a(2)}},e,this)})),function(e,t){return a.apply(this,arguments)})},{key:"getFromStore",value:(o=g(d().m(function e(t){var n,r;return d().w(function(e){for(;;)switch(e.n){case 0:return r=(null==(n=this.session)?void 0:n.topic)||"",e.n=1,this.client.core.storage.getItem("".concat(Rx,"/").concat(t).concat(r));case 1:return e.a(2,e.v)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"deleteFromStore",value:(i=g(d().m(function e(t){var n,r;return d().w(function(e){for(;;)switch(e.n){case 0:return r=(null==(n=this.session)?void 0:n.topic)||"",e.n=1,this.client.core.storage.removeItem("".concat(Rx,"/").concat(t).concat(r));case 1:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"cleanupStorage",value:(n=g(d().m(function e(){var t,n,r,i,o,a,s;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!((null==(t=this.client)?void 0:t.session.length)>0)){e.n=1;break}return e.a(2);case 1:return e.n=2,this.client.core.storage.getKeys();case 2:n=e.v,r=u(n),e.p=3,r.s();case 4:if((i=r.n()).done){e.n=6;break}if(!(o=i.value).startsWith(Rx)){e.n=5;break}return e.n=5,this.client.core.storage.removeItem(o);case 5:e.n=4;break;case 6:e.n=8;break;case 7:e.p=7,a=e.v,r.e(a);case 8:return e.p=8,r.f(),e.f(8);case 9:e.n=11;break;case 10:e.p=10,s=e.v,this.logger.warn("Failed to cleanup storage",s);case 11:return e.a(2)}},e,this,[[3,7,8,9],[0,10]])})),function(){return n.apply(this,arguments)})}],[{key:"init",value:(t=g(d().m(function t(n){var r;return d().w(function(t){for(;;)switch(t.n){case 0:return r=new e(n),t.n=1,r.initialize();case 1:return t.a(2,r)}},t)})),function(e){return t.apply(this,arguments)})}]);var t,n,i,o,a,s,c,f,h,p,v,y,m,w,b,E,k,I}(),qA=DA,MA="".concat("wc","@2:").concat("ethereum_provider",":"),zA=["eth_sendTransaction","personal_sign"],HA=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],VA=["chainChanged","accountsChanged"],FA=["chainChanged","accountsChanged","message","disconnect","connect"],KA=function(){var e=g(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,v(function(){return o.import("./core-legacy-CumfE71t.js").then(function(e){return e.X})},void 0);case 1:return t=e.v,n=t.createAppKit,e.a(2,n)}},e)}));return function(){return e.apply(this,arguments)}}(),WA=Object.defineProperty,GA=Object.defineProperties,ZA=Object.getOwnPropertyDescriptors,YA=Object.getOwnPropertySymbols,JA=Object.prototype.hasOwnProperty,QA=Object.prototype.propertyIsEnumerable,XA=function(e,t,n){return t in e?WA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},$A=function(e,t){for(var n in t||(t={}))JA.call(t,n)&&XA(e,n,t[n]);if(YA){var r,i=u(YA(t));try{for(i.s();!(r=i.n()).done;){n=r.value;QA.call(t,n)&&XA(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},eT=function(e,t){return GA(e,ZA(t))},tT=function(e,t,n){return XA(e,"symbol"!=_(t)?t+"":t,n)};function nT(e){return Number(e[0].split(":")[1])}function rT(e){return"0x".concat(e.toString(16))}function iT(e){var t=e.chains,n=e.optionalChains,r=e.methods,i=e.optionalMethods,o=e.events,a=e.optionalEvents,c=e.rpcMap;if(!Ax(t))throw new Error("Invalid chains");var u={chains:t,methods:r||zA,events:o||VA,rpcMap:$A({},t.length?s({},nT(t),c[nT(t)]):{})},f=null==o?void 0:o.filter(function(e){return!VA.includes(e)}),h=null==r?void 0:r.filter(function(e){return!zA.includes(e)});if(!(n||a||i||null!=f&&f.length||null!=h&&h.length))return{required:t.length?u:void 0};var d=(null==f?void 0:f.length)&&(null==h?void 0:h.length)||!n,p={chains:l(new Set(d?u.chains.concat(n||[]):n)),methods:l(new Set(u.methods.concat(null!=i&&i.length?i:HA))),events:l(new Set(u.events.concat(null!=a&&a.length?a:FA))),rpcMap:c};return{required:t.length?u:void 0,optional:n.length?p:void 0}}var oT=function(){function e(){var t=this;S(this,e),tT(this,"events",new N.EventEmitter),tT(this,"namespace","eip155"),tT(this,"accounts",[]),tT(this,"signer"),tT(this,"chainId",1),tT(this,"modal"),tT(this,"rpc"),tT(this,"STORAGE_KEY",MA),tT(this,"on",function(e,n){return t.events.on(e,n),t}),tT(this,"once",function(e,n){return t.events.once(e,n),t}),tT(this,"removeListener",function(e,n){return t.events.removeListener(e,n),t}),tT(this,"off",function(e,n){return t.events.off(e,n),t}),tT(this,"parseAccount",function(e){return t.isCompatibleChainId(e)?t.parseAccountId(e).address:e}),this.signer={},this.rpc={}}return P(e,[{key:"request",value:(f=g(d().m(function e(t,n){return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.signer.request(t,this.formatChainId(this.chainId),n);case 1:return e.a(2,e.v)}},e,this)})),function(e,t){return f.apply(this,arguments)})},{key:"sendAsync",value:function(e,t,n){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),n)}},{key:"connected",get:function(){return!!this.signer.client&&this.signer.client.core.relayer.connected}},{key:"connecting",get:function(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}},{key:"enable",value:(u=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(this.session){e.n=1;break}return e.n=1,this.connect();case 1:return e.n=2,this.request({method:"eth_requestAccounts"});case 2:return e.a(2,e.v)}},e,this)})),function(){return u.apply(this,arguments)})},{key:"connect",value:(c=g(d().m(function e(t){var n,r,i,o,a,c,u,l=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.signer.client){e.n=1;break}throw new Error("Provider not initialized. Call init() first");case 1:return this.loadConnectOpts(t),r=iT(this.rpc),i=r.required,o=r.optional,e.p=2,e.n=3,new Promise(function(){var e=g(d().m(function e(n,r){var a,c,u;return d().w(function(e){for(;;)switch(e.n){case 0:return l.rpc.showQrModal&&(null==(a=l.modal)||a.open(),null==(c=l.modal)||c.subscribeState(function(e){!e.open&&!l.signer.session&&(l.signer.abortPairingAttempt(),r(new Error("Connection request reset. Please try again.")))})),u=null!=t&&t.scopedProperties?s({},l.namespace,t.scopedProperties):void 0,e.n=1,l.signer.connect(eT($A({namespaces:$A({},i&&s({},l.namespace,i))},o&&{optionalNamespaces:s({},l.namespace,o)}),{pairingTopic:null==t?void 0:t.pairingTopic,scopedProperties:u})).then(function(e){n(e)}).catch(function(e){var t;null==(t=l.modal)||t.showErrorMessage("Unable to connect"),r(new Error(e.message))});case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 3:if(a=e.v){e.n=4;break}return e.a(2);case 4:c=_S(a.namespaces,[this.namespace]),this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:rT(this.chainId)}),e.n=6;break;case 5:throw e.p=5,u=e.v,this.signer.logger.error(u),u;case 6:return e.p=6,null==(n=this.modal)||n.close(),e.f(6);case 7:return e.a(2)}},e,this,[[2,5,6,7]])})),function(e){return c.apply(this,arguments)})},{key:"authenticate",value:(a=g(d().m(function e(t,n){var r,i,o,a,s,c=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.signer.client){e.n=1;break}throw new Error("Provider not initialized. Call init() first");case 1:return this.loadConnectOpts({chains:null==t?void 0:t.chains}),e.p=2,e.n=3,new Promise(function(){var e=g(d().m(function e(r,i){var o,a;return d().w(function(e){for(;;)switch(e.n){case 0:return c.rpc.showQrModal&&(null==(o=c.modal)||o.open(),null==(a=c.modal)||a.subscribeState(function(e){!e.open&&!c.signer.session&&(c.signer.abortPairingAttempt(),i(new Error("Connection request reset. Please try again.")))})),e.n=1,c.signer.authenticate(eT($A({},t),{chains:c.rpc.chains}),n).then(function(e){r(e)}).catch(function(e){var t;null==(t=c.modal)||t.showErrorMessage("Unable to connect"),i(new Error(e.message))});case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 3:return i=e.v,(o=i.session)&&(a=_S(o.namespaces,[this.namespace]),this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:rT(this.chainId)})),e.a(2,i);case 4:throw e.p=4,s=e.v,this.signer.logger.error(s),s;case 5:return e.p=5,null==(r=this.modal)||r.close(),e.f(5);case 6:return e.a(2)}},e,this,[[2,4,5,6]])})),function(e,t){return a.apply(this,arguments)})},{key:"disconnect",value:(o=g(d().m(function e(){return d().w(function(e){for(;;)switch(e.n){case 0:if(!this.session){e.n=1;break}return e.n=1,this.signer.disconnect();case 1:this.reset();case 2:return e.a(2)}},e,this)})),function(){return o.apply(this,arguments)})},{key:"isWalletConnect",get:function(){return!0}},{key:"session",get:function(){return this.signer.session}},{key:"registerEventListeners",value:function(){var e=this;this.signer.on("session_event",function(t){var n=t.params.event;"accountsChanged"===n.name?(e.accounts=e.parseAccounts(n.data),e.events.emit("accountsChanged",e.accounts)):"chainChanged"===n.name?e.setChainId(e.formatChainId(n.data)):e.events.emit(n.name,n.data),e.events.emit("session_event",t)}),this.signer.on("accountsChanged",function(t){e.accounts=e.parseAccounts(t),e.events.emit("accountsChanged",e.accounts)}),this.signer.on("chainChanged",function(t){var n=parseInt(t);e.chainId=n,e.events.emit("chainChanged",rT(e.chainId)),e.persist()}),this.signer.on("session_update",function(t){e.events.emit("session_update",t)}),this.signer.on("session_delete",function(t){e.reset(),e.events.emit("session_delete",t),e.events.emit("disconnect",eT($A({},_x("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",function(t){e.events.emit("display_uri",t)})}},{key:"switchEthereumChain",value:function(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}},{key:"isCompatibleChainId",value:function(e){return"string"==typeof e&&e.startsWith("".concat(this.namespace,":"))}},{key:"formatChainId",value:function(e){return"".concat(this.namespace,":").concat(e)}},{key:"parseChainId",value:function(e){return Number(e.split(":")[1])}},{key:"setChainIds",value:function(e){var t=this,n=e.filter(function(e){return t.isCompatibleChainId(e)}).map(function(e){return t.parseChainId(e)});n.length&&(this.chainId=n[0],this.events.emit("chainChanged",rT(this.chainId)),this.persist())}},{key:"setChainId",value:function(e){if(this.isCompatibleChainId(e)){var t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}},{key:"parseAccountId",value:function(e){var t=r(e.split(":"),3),n=t[0],i=t[1],o=t[2];return{chainId:"".concat(n,":").concat(i),address:o}}},{key:"setAccounts",value:function(e){var t=this;this.accounts=e.filter(function(e){return t.parseChainId(t.parseAccountId(e).chainId)===t.chainId}).map(function(e){return t.parseAccountId(e).address}),this.events.emit("accountsChanged",this.accounts)}},{key:"getRpcConfig",value:function(e){var t,n,r=this,i=null!=(t=null==e?void 0:e.chains)?t:[],o=null!=(n=null==e?void 0:e.optionalChains)?n:[],a=i.concat(o);if(!a.length)throw new Error("No chains specified in either `chains` or `optionalChains`");var s=i.length?(null==e?void 0:e.methods)||zA:[],c=i.length?(null==e?void 0:e.events)||VA:[],u=(null==e?void 0:e.optionalMethods)||[],l=(null==e?void 0:e.optionalEvents)||[],f=(null==e?void 0:e.rpcMap)||this.buildRpcMap(a,e.projectId),h=(null==e?void 0:e.qrModalOptions)||void 0;return{chains:null==i?void 0:i.map(function(e){return r.formatChainId(e)}),optionalChains:o.map(function(e){return r.formatChainId(e)}),methods:s,events:c,optionalMethods:u,optionalEvents:l,rpcMap:f,showQrModal:!(null==e||!e.showQrModal),qrModalOptions:h,projectId:e.projectId,metadata:e.metadata}}},{key:"buildRpcMap",value:function(e,t){var n=this,r={};return e.forEach(function(e){r[e]=n.getRpcUrl(e,t)}),r}},{key:"initialize",value:(i=g(d().m(function e(t){var n,r,i,o,a,s,c;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?nT(this.rpc.chains):nT(this.rpc.optionalChains),e.n=1,qA.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storage:t.storage,storageOptions:t.storageOptions,customStoragePrefix:t.customStoragePrefix,telemetryEnabled:t.telemetryEnabled,logger:t.logger});case 1:return this.signer=e.v,this.registerEventListeners(),e.n=2,this.loadPersistedSession();case 2:if(!this.rpc.showQrModal){e.n=11;break}return e.p=3,e.n=4,KA();case 4:return r=e.v,e.n=5,Promise.resolve().then(function(){return wT});case 5:if(i=e.v,o=i.convertWCMToAppKitOptions,(a=o(eT($A({},this.rpc.qrModalOptions),{chains:l(new Set([].concat(l(this.rpc.chains),l(this.rpc.optionalChains)))),metadata:this.rpc.metadata,projectId:this.rpc.projectId}))).networks.length){e.n=6;break}throw new Error("No networks found for WalletConnect·");case 6:n=r(eT($A({},a),{universalProvider:this.signer,manualWCControl:!0})),e.n=8;break;case 7:throw e.p=7,s=e.v,console.warn(s),new Error("To use QR modal, please install @reown/appkit package");case 8:if(!n){e.n=11;break}e.p=9,this.modal=n,e.n=11;break;case 10:throw e.p=10,c=e.v,this.signer.logger.error(c),new Error("Could not generate WalletConnectModal Instance");case 11:return e.a(2)}},e,this,[[9,10],[3,7]])})),function(e){return i.apply(this,arguments)})},{key:"loadConnectOpts",value:function(e){var t=this;if(e){var n=e.chains,r=e.optionalChains,i=e.rpcMap;n&&Ax(n)&&(this.rpc.chains=n.map(function(e){return t.formatChainId(e)}),n.forEach(function(e){t.rpc.rpcMap[e]=(null==i?void 0:i[e])||t.getRpcUrl(e)})),r&&Ax(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=null==r?void 0:r.map(function(e){return t.formatChainId(e)}),r.forEach(function(e){t.rpc.rpcMap[e]=(null==i?void 0:i[e])||t.getRpcUrl(e)}))}}},{key:"getRpcUrl",value:function(e,t){var n;return(null==(n=this.rpc.rpcMap)?void 0:n[e])||"".concat("https://rpc.walletconnect.org/v1/","?chainId=eip155:").concat(e,"&projectId=").concat(t||this.rpc.projectId)}},{key:"loadPersistedSession",value:(n=g(d().m(function e(){var t,n,r,i=this;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.session){e.n=4;break}return e.p=1,e.n=2,this.signer.client.core.storage.getItem("".concat(this.STORAGE_KEY,"/chainId"));case 2:t=e.v,n=this.session.namespaces["".concat(this.namespace,":").concat(t)]?this.session.namespaces["".concat(this.namespace,":").concat(t)]:this.session.namespaces[this.namespace],this.setChainIds(t?[this.formatChainId(t)]:null==n?void 0:n.accounts),this.setAccounts(null==n?void 0:n.accounts),e.n=4;break;case 3:return e.p=3,r=e.v,this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(r),e.n=4,this.disconnect().catch(function(e){return i.signer.logger.warn(e)});case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return n.apply(this,arguments)})},{key:"reset",value:function(){this.chainId=1,this.accounts=[]}},{key:"persist",value:function(){this.session&&this.signer.client.core.storage.setItem("".concat(this.STORAGE_KEY,"/chainId"),this.chainId)}},{key:"parseAccounts",value:function(e){var t=this;return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map(function(e){return t.parseAccount(e)})}}],[{key:"init",value:(t=g(d().m(function t(n){var r;return d().w(function(t){for(;;)switch(t.n){case 0:return r=new e,t.n=1,r.initialize(n);case 1:return t.a(2,r)}},t)})),function(e){return t.apply(this,arguments)})}]);var t,n,i,o,a,c,u,f}(),aT=oT,sT=Object.defineProperty,cT=Object.defineProperties,uT=Object.getOwnPropertyDescriptors,lT=Object.getOwnPropertySymbols,fT=Object.prototype.hasOwnProperty,hT=Object.prototype.propertyIsEnumerable,dT=function(e,t,n){return t in e?sT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},pT=function(e,t){for(var n in t||(t={}))fT.call(t,n)&&dT(e,n,t[n]);if(lT){var r,i=u(lT(t));try{for(i.s();!(r=i.n()).done;){n=r.value;hT.call(t,n)&&dT(e,n,t[n])}}catch(o){i.e(o)}finally{i.f()}}return e},vT=function(e,t){return cT(e,uT(t))};function gT(e){if(e)return{"--w3m-font-family":e["--wcm-font-family"],"--w3m-accent":e["--wcm-accent-color"],"--w3m-color-mix":e["--wcm-background-color"],"--w3m-z-index":e["--wcm-z-index"]?Number(e["--wcm-z-index"]):void 0,"--w3m-qr-color":e["--wcm-accent-color"],"--w3m-font-size-master":e["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":e["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}var yT=function(e){var t=r(e.split(":"),2),n=t[0];return mT({id:t[1],caipNetworkId:e,chainNamespace:n,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function mT(e){return pT({formatters:void 0,fees:void 0,serializers:void 0},e)}var wT=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(e){var t,n,r,i,o,a,s,c=null==(t=e.chains)?void 0:t.map(yT).filter(Boolean);if(0===c.length)throw new Error("At least one chain must be specified");var u=c.find(function(t){var n;return t.id===(null==(n=e.defaultChain)?void 0:n.id)}),f={projectId:e.projectId,networks:c,themeMode:e.themeMode,themeVariables:gT(e.themeVariables),chainImages:e.chainImages,connectorImages:e.walletImages,defaultNetwork:u,metadata:vT(pT({},e.metadata),{name:(null==(n=e.metadata)?void 0:n.name)||"WalletConnect",description:(null==(r=e.metadata)?void 0:r.description)||"Connect to WalletConnect-compatible wallets",url:(null==(i=e.metadata)?void 0:i.url)||"https://walletconnect.org",icons:(null==(o=e.metadata)?void 0:o.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:"NONE"===e.explorerRecommendedWalletIds?[]:Array.isArray(e.explorerRecommendedWalletIds)?e.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===e.explorerExcludedWalletIds?[]:Array.isArray(e.explorerExcludedWalletIds)?e.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(a=e.mobileWallets)&&a.length||null!=(s=e.desktopWallets)&&s.length){var h=[].concat(l((e.mobileWallets||[]).map(function(e){return{id:e.id,name:e.name,links:e.links}})),l((e.desktopWallets||[]).map(function(e){return{id:e.id,name:e.name,links:{native:e.links.native,universal:e.links.universal}}}))),d=[].concat(l(f.featuredWalletIds||[]),l(f.excludeWalletIds||[])),p=h.filter(function(e){return!d.includes(e.id)});p.length&&(f.customWallets=p)}return f},defineChain:mT}),bT=Object.freeze(Object.defineProperty({__proto__:null,EthereumProvider:aT,OPTIONAL_EVENTS:FA,OPTIONAL_METHODS:HA,REQUIRED_EVENTS:VA,REQUIRED_METHODS:zA,default:oT},Symbol.toStringTag,{value:"Module"}));t("W",bT)}}})}();
